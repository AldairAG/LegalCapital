/*! For license information please see main.6b1a81fc.js.LICENSE.txt */
(()=>{var e={321:(e,t,n)=>{"use strict";n.r(t),n.d(t,{createBrowserHistory:()=>N,createHashHistory:()=>I,createLocation:()=>g,createMemoryHistory:()=>P,createPath:()=>m,locationsAreEqual:()=>v,parsePath:()=>f});var i=n(168);function r(e){return"/"===e.charAt(0)}function s(e,t){for(var n=t,i=n+1,r=e.length;i<r;n+=1,i+=1)e[n]=e[i];e.pop()}const a=function(e,t){void 0===t&&(t="");var n,i=e&&e.split("/")||[],a=t&&t.split("/")||[],o=e&&r(e),l=t&&r(t),c=o||l;if(e&&r(e)?a=i:i.length&&(a.pop(),a=a.concat(i)),!a.length)return"/";if(a.length){var u=a[a.length-1];n="."===u||".."===u||""===u}else n=!1;for(var h=0,d=a.length;d>=0;d--){var p=a[d];"."===p?s(a,d):".."===p?(s(a,d),h++):h&&(s(a,d),h--)}if(!c)for(;h--;h)a.unshift("..");!c||""===a[0]||a[0]&&r(a[0])||a.unshift("");var f=a.join("/");return n&&"/"!==f.substr(-1)&&(f+="/"),f};function o(e){return e.valueOf?e.valueOf():Object.prototype.valueOf.call(e)}const l=function e(t,n){if(t===n)return!0;if(null==t||null==n)return!1;if(Array.isArray(t))return Array.isArray(n)&&t.length===n.length&&t.every((function(t,i){return e(t,n[i])}));if("object"===typeof t||"object"===typeof n){var i=o(t),r=o(n);return i!==t||r!==n?e(i,r):Object.keys(Object.assign({},t,n)).every((function(i){return e(t[i],n[i])}))}return!1};var c=n(404);function u(e){return"/"===e.charAt(0)?e:"/"+e}function h(e){return"/"===e.charAt(0)?e.substr(1):e}function d(e,t){return function(e,t){return 0===e.toLowerCase().indexOf(t.toLowerCase())&&-1!=="/?#".indexOf(e.charAt(t.length))}(e,t)?e.substr(t.length):e}function p(e){return"/"===e.charAt(e.length-1)?e.slice(0,-1):e}function f(e){var t=e||"/",n="",i="",r=t.indexOf("#");-1!==r&&(i=t.substr(r),t=t.substr(0,r));var s=t.indexOf("?");return-1!==s&&(n=t.substr(s),t=t.substr(0,s)),{pathname:t,search:"?"===n?"":n,hash:"#"===i?"":i}}function m(e){var t=e.pathname,n=e.search,i=e.hash,r=t||"/";return n&&"?"!==n&&(r+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(r+="#"===i.charAt(0)?i:"#"+i),r}function g(e,t,n,r){var s;"string"===typeof e?(s=f(e)).state=t:(void 0===(s=(0,i.A)({},e)).pathname&&(s.pathname=""),s.search?"?"!==s.search.charAt(0)&&(s.search="?"+s.search):s.search="",s.hash?"#"!==s.hash.charAt(0)&&(s.hash="#"+s.hash):s.hash="",void 0!==t&&void 0===s.state&&(s.state=t));try{s.pathname=decodeURI(s.pathname)}catch(o){throw o instanceof URIError?new URIError('Pathname "'+s.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):o}return n&&(s.key=n),r?s.pathname?"/"!==s.pathname.charAt(0)&&(s.pathname=a(s.pathname,r.pathname)):s.pathname=r.pathname:s.pathname||(s.pathname="/"),s}function v(e,t){return e.pathname===t.pathname&&e.search===t.search&&e.hash===t.hash&&e.key===t.key&&l(e.state,t.state)}function y(){var e=null;var t=[];return{setPrompt:function(t){return e=t,function(){e===t&&(e=null)}},confirmTransitionTo:function(t,n,i,r){if(null!=e){var s="function"===typeof e?e(t,n):e;"string"===typeof s?"function"===typeof i?i(s,r):r(!0):r(!1!==s)}else r(!0)},appendListener:function(e){var n=!0;function i(){n&&e.apply(void 0,arguments)}return t.push(i),function(){n=!1,t=t.filter((function(e){return e!==i}))}},notifyListeners:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];t.forEach((function(e){return e.apply(void 0,n)}))}}}var _=!("undefined"===typeof window||!window.document||!window.document.createElement);function w(e,t){t(window.confirm(e))}var x="popstate",b="hashchange";function S(){try{return window.history.state||{}}catch(e){return{}}}function N(e){void 0===e&&(e={}),_||(0,c.A)(!1);var t=window.history,n=function(){var e=window.navigator.userAgent;return(-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone"))&&window.history&&"pushState"in window.history}(),r=!(-1===window.navigator.userAgent.indexOf("Trident")),s=e,a=s.forceRefresh,o=void 0!==a&&a,l=s.getUserConfirmation,h=void 0===l?w:l,f=s.keyLength,v=void 0===f?6:f,N=e.basename?p(u(e.basename)):"";function M(e){var t=e||{},n=t.key,i=t.state,r=window.location,s=r.pathname+r.search+r.hash;return N&&(s=d(s,N)),g(s,i,n)}function T(){return Math.random().toString(36).substr(2,v)}var A=y();function E(e){(0,i.A)(V,e),V.length=t.length,A.notifyListeners(V.location,V.action)}function C(e){(function(e){return void 0===e.state&&-1===navigator.userAgent.indexOf("CriOS")})(e)||P(M(e.state))}function I(){P(M(S()))}var R=!1;function P(e){if(R)R=!1,E();else{A.confirmTransitionTo(e,"POP",h,(function(t){t?E({action:"POP",location:e}):function(e){var t=V.location,n=k.indexOf(t.key);-1===n&&(n=0);var i=k.indexOf(e.key);-1===i&&(i=0);var r=n-i;r&&(R=!0,O(r))}(e)}))}}var D=M(S()),k=[D.key];function L(e){return N+m(e)}function O(e){t.go(e)}var B=0;function U(e){1===(B+=e)&&1===e?(window.addEventListener(x,C),r&&window.addEventListener(b,I)):0===B&&(window.removeEventListener(x,C),r&&window.removeEventListener(b,I))}var z=!1;var V={length:t.length,action:"POP",location:D,createHref:L,push:function(e,i){var r="PUSH",s=g(e,i,T(),V.location);A.confirmTransitionTo(s,r,h,(function(e){if(e){var i=L(s),a=s.key,l=s.state;if(n)if(t.pushState({key:a,state:l},null,i),o)window.location.href=i;else{var c=k.indexOf(V.location.key),u=k.slice(0,c+1);u.push(s.key),k=u,E({action:r,location:s})}else window.location.href=i}}))},replace:function(e,i){var r="REPLACE",s=g(e,i,T(),V.location);A.confirmTransitionTo(s,r,h,(function(e){if(e){var i=L(s),a=s.key,l=s.state;if(n)if(t.replaceState({key:a,state:l},null,i),o)window.location.replace(i);else{var c=k.indexOf(V.location.key);-1!==c&&(k[c]=s.key),E({action:r,location:s})}else window.location.replace(i)}}))},go:O,goBack:function(){O(-1)},goForward:function(){O(1)},block:function(e){void 0===e&&(e=!1);var t=A.setPrompt(e);return z||(U(1),z=!0),function(){return z&&(z=!1,U(-1)),t()}},listen:function(e){var t=A.appendListener(e);return U(1),function(){U(-1),t()}}};return V}var M="hashchange",T={hashbang:{encodePath:function(e){return"!"===e.charAt(0)?e:"!/"+h(e)},decodePath:function(e){return"!"===e.charAt(0)?e.substr(1):e}},noslash:{encodePath:h,decodePath:u},slash:{encodePath:u,decodePath:u}};function A(e){var t=e.indexOf("#");return-1===t?e:e.slice(0,t)}function E(){var e=window.location.href,t=e.indexOf("#");return-1===t?"":e.substring(t+1)}function C(e){window.location.replace(A(window.location.href)+"#"+e)}function I(e){void 0===e&&(e={}),_||(0,c.A)(!1);var t=window.history,n=(window.navigator.userAgent.indexOf("Firefox"),e),r=n.getUserConfirmation,s=void 0===r?w:r,a=n.hashType,o=void 0===a?"slash":a,l=e.basename?p(u(e.basename)):"",h=T[o],f=h.encodePath,v=h.decodePath;function x(){var e=v(E());return l&&(e=d(e,l)),g(e)}var b=y();function S(e){(0,i.A)(V,e),V.length=t.length,b.notifyListeners(V.location,V.action)}var N=!1,I=null;function R(){var e,t,n=E(),i=f(n);if(n!==i)C(i);else{var r=x(),a=V.location;if(!N&&(t=r,(e=a).pathname===t.pathname&&e.search===t.search&&e.hash===t.hash))return;if(I===m(r))return;I=null,function(e){if(N)N=!1,S();else{var t="POP";b.confirmTransitionTo(e,t,s,(function(n){n?S({action:t,location:e}):function(e){var t=V.location,n=L.lastIndexOf(m(t));-1===n&&(n=0);var i=L.lastIndexOf(m(e));-1===i&&(i=0);var r=n-i;r&&(N=!0,O(r))}(e)}))}}(r)}}var P=E(),D=f(P);P!==D&&C(D);var k=x(),L=[m(k)];function O(e){t.go(e)}var B=0;function U(e){1===(B+=e)&&1===e?window.addEventListener(M,R):0===B&&window.removeEventListener(M,R)}var z=!1;var V={length:t.length,action:"POP",location:k,createHref:function(e){var t=document.querySelector("base"),n="";return t&&t.getAttribute("href")&&(n=A(window.location.href)),n+"#"+f(l+m(e))},push:function(e,t){var n="PUSH",i=g(e,void 0,void 0,V.location);b.confirmTransitionTo(i,n,s,(function(e){if(e){var t=m(i),r=f(l+t);if(E()!==r){I=t,function(e){window.location.hash=e}(r);var s=L.lastIndexOf(m(V.location)),a=L.slice(0,s+1);a.push(t),L=a,S({action:n,location:i})}else S()}}))},replace:function(e,t){var n="REPLACE",i=g(e,void 0,void 0,V.location);b.confirmTransitionTo(i,n,s,(function(e){if(e){var t=m(i),r=f(l+t);E()!==r&&(I=t,C(r));var s=L.indexOf(m(V.location));-1!==s&&(L[s]=t),S({action:n,location:i})}}))},go:O,goBack:function(){O(-1)},goForward:function(){O(1)},block:function(e){void 0===e&&(e=!1);var t=b.setPrompt(e);return z||(U(1),z=!0),function(){return z&&(z=!1,U(-1)),t()}},listen:function(e){var t=b.appendListener(e);return U(1),function(){U(-1),t()}}};return V}function R(e,t,n){return Math.min(Math.max(e,t),n)}function P(e){void 0===e&&(e={});var t=e,n=t.getUserConfirmation,r=t.initialEntries,s=void 0===r?["/"]:r,a=t.initialIndex,o=void 0===a?0:a,l=t.keyLength,c=void 0===l?6:l,u=y();function h(e){(0,i.A)(w,e),w.length=w.entries.length,u.notifyListeners(w.location,w.action)}function d(){return Math.random().toString(36).substr(2,c)}var p=R(o,0,s.length-1),f=s.map((function(e){return g(e,void 0,"string"===typeof e?d():e.key||d())})),v=m;function _(e){var t=R(w.index+e,0,w.entries.length-1),i=w.entries[t];u.confirmTransitionTo(i,"POP",n,(function(e){e?h({action:"POP",location:i,index:t}):h()}))}var w={length:f.length,action:"POP",location:f[p],index:p,entries:f,createHref:v,push:function(e,t){var i="PUSH",r=g(e,t,d(),w.location);u.confirmTransitionTo(r,i,n,(function(e){if(e){var t=w.index+1,n=w.entries.slice(0);n.length>t?n.splice(t,n.length-t,r):n.push(r),h({action:i,location:r,index:t,entries:n})}}))},replace:function(e,t){var i="REPLACE",r=g(e,t,d(),w.location);u.confirmTransitionTo(r,i,n,(function(e){e&&(w.entries[w.index]=r,h({action:i,location:r}))}))},go:_,goBack:function(){_(-1)},goForward:function(){_(1)},canGo:function(e){var t=w.index+e;return t>=0&&t<w.entries.length},block:function(e){return void 0===e&&(e=!1),u.setPrompt(e)},listen:function(e){return u.appendListener(e)}};return w}},219:(e,t,n)=>{"use strict";var i=n(763),r={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},s={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};function l(e){return i.isMemo(e)?a:o[e.$$typeof]||r}o[i.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},o[i.Memo]=a;var c=Object.defineProperty,u=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,n,i){if("string"!==typeof n){if(f){var r=p(n);r&&r!==f&&e(t,r,i)}var a=u(n);h&&(a=a.concat(h(n)));for(var o=l(t),m=l(n),g=0;g<a.length;++g){var v=a[g];if(!s[v]&&(!i||!i[v])&&(!m||!m[v])&&(!o||!o[v])){var y=d(n,v);try{c(t,v,y)}catch(_){}}}}return t}},983:(e,t)=>{"use strict";var n="function"===typeof Symbol&&Symbol.for,i=n?Symbol.for("react.element"):60103,r=n?Symbol.for("react.portal"):60106,s=n?Symbol.for("react.fragment"):60107,a=n?Symbol.for("react.strict_mode"):60108,o=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,u=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,d=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,f=n?Symbol.for("react.suspense_list"):60120,m=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,v=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,_=n?Symbol.for("react.responder"):60118,w=n?Symbol.for("react.scope"):60119;function x(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case i:switch(e=e.type){case u:case h:case s:case o:case a:case p:return e;default:switch(e=e&&e.$$typeof){case c:case d:case g:case m:case l:return e;default:return t}}case r:return t}}}function b(e){return x(e)===h}t.AsyncMode=u,t.ConcurrentMode=h,t.ContextConsumer=c,t.ContextProvider=l,t.Element=i,t.ForwardRef=d,t.Fragment=s,t.Lazy=g,t.Memo=m,t.Portal=r,t.Profiler=o,t.StrictMode=a,t.Suspense=p,t.isAsyncMode=function(e){return b(e)||x(e)===u},t.isConcurrentMode=b,t.isContextConsumer=function(e){return x(e)===c},t.isContextProvider=function(e){return x(e)===l},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===i},t.isForwardRef=function(e){return x(e)===d},t.isFragment=function(e){return x(e)===s},t.isLazy=function(e){return x(e)===g},t.isMemo=function(e){return x(e)===m},t.isPortal=function(e){return x(e)===r},t.isProfiler=function(e){return x(e)===o},t.isStrictMode=function(e){return x(e)===a},t.isSuspense=function(e){return x(e)===p},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===s||e===h||e===o||e===a||e===p||e===f||"object"===typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===m||e.$$typeof===l||e.$$typeof===c||e.$$typeof===d||e.$$typeof===y||e.$$typeof===_||e.$$typeof===w||e.$$typeof===v)},t.typeOf=x},763:(e,t,n)=>{"use strict";e.exports=n(983)},141:e=>{e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},123:(e,t,n)=>{var i=n(141);e.exports=p,e.exports.parse=s,e.exports.compile=function(e,t){return o(s(e,t),t)},e.exports.tokensToFunction=o,e.exports.tokensToRegExp=d;var r=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function s(e,t){for(var n,i=[],s=0,a=0,o="",u=t&&t.delimiter||"/";null!=(n=r.exec(e));){var h=n[0],d=n[1],p=n.index;if(o+=e.slice(a,p),a=p+h.length,d)o+=d[1];else{var f=e[a],m=n[2],g=n[3],v=n[4],y=n[5],_=n[6],w=n[7];o&&(i.push(o),o="");var x=null!=m&&null!=f&&f!==m,b="+"===_||"*"===_,S="?"===_||"*"===_,N=n[2]||u,M=v||y;i.push({name:g||s++,prefix:m||"",delimiter:N,optional:S,repeat:b,partial:x,asterisk:!!w,pattern:M?c(M):w?".*":"[^"+l(N)+"]+?"})}}return a<e.length&&(o+=e.substr(a)),o&&i.push(o),i}function a(e){return encodeURI(e).replace(/[\/?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}function o(e,t){for(var n=new Array(e.length),r=0;r<e.length;r++)"object"===typeof e[r]&&(n[r]=new RegExp("^(?:"+e[r].pattern+")$",h(t)));return function(t,r){for(var s="",o=t||{},l=(r||{}).pretty?a:encodeURIComponent,c=0;c<e.length;c++){var u=e[c];if("string"!==typeof u){var h,d=o[u.name];if(null==d){if(u.optional){u.partial&&(s+=u.prefix);continue}throw new TypeError('Expected "'+u.name+'" to be defined')}if(i(d)){if(!u.repeat)throw new TypeError('Expected "'+u.name+'" to not repeat, but received `'+JSON.stringify(d)+"`");if(0===d.length){if(u.optional)continue;throw new TypeError('Expected "'+u.name+'" to not be empty')}for(var p=0;p<d.length;p++){if(h=l(d[p]),!n[c].test(h))throw new TypeError('Expected all "'+u.name+'" to match "'+u.pattern+'", but received `'+JSON.stringify(h)+"`");s+=(0===p?u.prefix:u.delimiter)+h}}else{if(h=u.asterisk?encodeURI(d).replace(/[?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})):l(d),!n[c].test(h))throw new TypeError('Expected "'+u.name+'" to match "'+u.pattern+'", but received "'+h+'"');s+=u.prefix+h}}else s+=u}return s}}function l(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function c(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function u(e,t){return e.keys=t,e}function h(e){return e&&e.sensitive?"":"i"}function d(e,t,n){i(t)||(n=t||n,t=[]);for(var r=(n=n||{}).strict,s=!1!==n.end,a="",o=0;o<e.length;o++){var c=e[o];if("string"===typeof c)a+=l(c);else{var d=l(c.prefix),p="(?:"+c.pattern+")";t.push(c),c.repeat&&(p+="(?:"+d+p+")*"),a+=p=c.optional?c.partial?d+"("+p+")?":"(?:"+d+"("+p+"))?":d+"("+p+")"}}var f=l(n.delimiter||"/"),m=a.slice(-f.length)===f;return r||(a=(m?a.slice(0,-f.length):a)+"(?:"+f+"(?=$))?"),a+=s?"$":r&&m?"":"(?="+f+"|$)",u(new RegExp("^"+a,h(n)),t)}function p(e,t,n){return i(t)||(n=t||n,t=[]),n=n||{},e instanceof RegExp?function(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var i=0;i<n.length;i++)t.push({name:i,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return u(e,t)}(e,t):i(e)?function(e,t,n){for(var i=[],r=0;r<e.length;r++)i.push(p(e[r],t,n).source);return u(new RegExp("(?:"+i.join("|")+")",h(n)),t)}(e,t,n):function(e,t,n){return d(s(e,n),t,n)}(e,t,n)}},497:(e,t,n)=>{"use strict";var i=n(218);function r(){}function s(){}s.resetWarningCache=r,e.exports=function(){function e(e,t,n,r,s,a){if(a!==i){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:r};return n.PropTypes=n,n}},173:(e,t,n)=>{e.exports=n(497)()},218:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},730:(e,t,n)=>{"use strict";var i=n(43),r=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)a.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,i,r,s,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function _(e,t,n,i){var r=g.hasOwnProperty(t)?g[t]:null;(null!==r?0!==r.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null===t||"undefined"===typeof t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,i)&&(n=null),i||null===r?function(e){return!!h.call(f,e)||!h.call(p,e)&&(d.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,i=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),b=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),A=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var k=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=k&&e[k]||e["@@iterator"])?e:null}var O,B=Object.assign;function U(e){if(void 0===O)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);O=t&&t[1]||""}return"\n"+O+e}var z=!1;function V(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),s=i.stack.split("\n"),a=r.length-1,o=s.length-1;1<=a&&0<=o&&r[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(r[a]!==s[o]){if(1!==a||1!==o)do{if(a--,0>--o||r[a]!==s[o]){var l="\n"+r[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=o);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?U(e):""}function F(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}function j(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case b:return"Portal";case M:return"Profiler";case N:return"StrictMode";case C:return"Suspense";case I:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case A:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case R:return null!==(t=e.displayName||null)?t:j(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return j(e(t))}catch(n){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return j(t);case 8:return t===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function G(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Y(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=W(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function K(e,t){var n=t.checked;return B({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function J(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=G(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function $(e,t){null!=(t=t.checked)&&_(e,"checked",t,!1)}function Q(e,t){$(e,t);var n=G(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,G(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&X(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+G(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return B({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:G(n)}}function se(e,t){var n=G(t.value),i=G(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=me(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ve=B({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function _e(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var be=null,Se=null,Ne=null;function Me(e){if(e=_r(e)){if("function"!==typeof be)throw Error(s(280));var t=e.stateNode;t&&(t=xr(t),be(e.stateNode,e.type,t))}}function Te(e){Se?Ne?Ne.push(e):Ne=[e]:Se=e}function Ae(){if(Se){var e=Se,t=Ne;if(Ne=Se=null,Me(e),t)for(e=0;e<t.length;e++)Me(t[e])}}function Ee(e,t){return e(t)}function Ce(){}var Ie=!1;function Re(e,t,n){if(Ie)return e(t,n);Ie=!0;try{return Ee(e,t,n)}finally{Ie=!1,(null!==Se||null!==Ne)&&(Ce(),Ae())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var i=xr(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var De=!1;if(u)try{var ke={};Object.defineProperty(ke,"passive",{get:function(){De=!0}}),window.addEventListener("test",ke,ke),window.removeEventListener("test",ke,ke)}catch(ue){De=!1}function Le(e,t,n,i,r,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Oe=!1,Be=null,Ue=!1,ze=null,Ve={onError:function(e){Oe=!0,Be=e}};function Fe(e,t,n,i,r,s,a,o,l){Oe=!1,Be=null,Le.apply(Ve,arguments)}function je(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ge(e){if(je(e)!==e)throw Error(s(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=je(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var a=r.alternate;if(null===a){if(null!==(i=r.return)){n=i;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===n)return Ge(r),e;if(a===i)return Ge(r),t;a=a.sibling}throw Error(s(188))}if(n.return!==i.return)n=r,i=a;else{for(var o=!1,l=r.child;l;){if(l===n){o=!0,n=r,i=a;break}if(l===i){o=!0,i=r,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,i=r;break}if(l===i){o=!0,i=a,n=r;break}l=l.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==i)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?Ye(e):null}function Ye(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ye(e);if(null!==t)return t;e=e.sibling}return null}var qe=r.unstable_scheduleCallback,Xe=r.unstable_cancelCallback,Ke=r.unstable_shouldYield,Je=r.unstable_requestPaint,$e=r.unstable_now,Qe=r.unstable_getCurrentPriorityLevel,Ze=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,it=r.unstable_IdlePriority,rt=null,st=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,a=268435455&n;if(0!==a){var o=a&~r;0!==o?i=ht(o):0!==(s&=a)&&(i=ht(s))}else 0!==(a=n&~r)?i=ht(a):0!==s&&(i=ht(s));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-at(t)),i|=e[n],t&=~r;return i}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-at(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var _t=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var xt,bt,St,Nt,Mt,Tt=!1,At=[],Et=null,Ct=null,It=null,Rt=new Map,Pt=new Map,Dt=[],kt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":Ct=null;break;case"mouseover":case"mouseout":It=null;break;case"pointerover":case"pointerout":Rt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function Ot(e,t,n,i,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=_r(t))&&bt(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Bt(e){var t=yr(e.target);if(null!==t){var n=je(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=He(n)))return e.blockedOn=t,void Mt(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Kt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=_r(n))&&bt(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);we=i,n.target.dispatchEvent(i),we=null,t.shift()}return!0}function zt(e,t,n){Ut(e)&&n.delete(t)}function Vt(){Tt=!1,null!==Et&&Ut(Et)&&(Et=null),null!==Ct&&Ut(Ct)&&(Ct=null),null!==It&&Ut(It)&&(It=null),Rt.forEach(zt),Pt.forEach(zt)}function Ft(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Vt)))}function jt(e){function t(t){return Ft(t,e)}if(0<At.length){Ft(At[0],e);for(var n=1;n<At.length;n++){var i=At[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==Et&&Ft(Et,e),null!==Ct&&Ft(Ct,e),null!==It&&Ft(It,e),Rt.forEach(t),Pt.forEach(t),n=0;n<Dt.length;n++)(i=Dt[n]).blockedOn===e&&(i.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Bt(n),null===n.blockedOn&&Dt.shift()}var Ht=w.ReactCurrentBatchConfig,Gt=!0;function Wt(e,t,n,i){var r=_t,s=Ht.transition;Ht.transition=null;try{_t=1,qt(e,t,n,i)}finally{_t=r,Ht.transition=s}}function Yt(e,t,n,i){var r=_t,s=Ht.transition;Ht.transition=null;try{_t=4,qt(e,t,n,i)}finally{_t=r,Ht.transition=s}}function qt(e,t,n,i){if(Gt){var r=Kt(e,t,n,i);if(null===r)Gi(e,t,i,Xt,n),Lt(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return Et=Ot(Et,e,t,n,i,r),!0;case"dragenter":return Ct=Ot(Ct,e,t,n,i,r),!0;case"mouseover":return It=Ot(It,e,t,n,i,r),!0;case"pointerover":var s=r.pointerId;return Rt.set(s,Ot(Rt.get(s)||null,e,t,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Pt.set(s,Ot(Pt.get(s)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(Lt(e,i),4&t&&-1<kt.indexOf(e)){for(;null!==r;){var s=_r(r);if(null!==s&&xt(s),null===(s=Kt(e,t,n,i))&&Gi(e,t,i,Xt,n),s===r)break;r=s}null!==r&&i.stopPropagation()}else Gi(e,t,i,null,n)}}var Xt=null;function Kt(e,t,n,i){if(Xt=null,null!==(e=yr(e=xe(i))))if(null===(t=je(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Jt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case it:return 536870912;default:return 16}default:return 16}}var $t=null,Qt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Qt,i=n.length,r="value"in $t?$t.value:$t.textContent,s=r.length;for(e=0;e<i&&n[e]===r[e];e++);var a=i-e;for(t=1;t<=a&&n[i-t]===r[s-t];t++);return Zt=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,i,r,s){for(var a in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(r):r[a]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return B(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),hn=B({},cn,{view:0,detail:0}),dn=sn(hn),pn=B({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:on}}),fn=sn(pn),mn=sn(B({},pn,{dataTransfer:0})),gn=sn(B({},hn,{relatedTarget:0})),vn=sn(B({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=B({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),_n=sn(yn),wn=sn(B({},cn,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function Mn(){return Nn}var Tn=B({},hn,{key:function(e){if(e.key){var t=xn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?bn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),An=sn(Tn),En=sn(B({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Cn=sn(B({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mn})),In=sn(B({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Rn=B({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=sn(Rn),Dn=[9,13,27,32],kn=u&&"CompositionEvent"in window,Ln=null;u&&"documentMode"in document&&(Ln=document.documentMode);var On=u&&"TextEvent"in window&&!Ln,Bn=u&&(!kn||Ln&&8<Ln&&11>=Ln),Un=String.fromCharCode(32),zn=!1;function Vn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var jn=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function Wn(e,t,n,i){Te(i),0<(t=Yi(t,"onChange")).length&&(n=new un("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Yn=null,qn=null;function Xn(e){Ui(e,0)}function Kn(e){if(q(wr(e)))return e}function Jn(e,t){if("change"===e)return t}var $n=!1;if(u){var Qn;if(u){var Zn="oninput"in document;if(!Zn){var ei=document.createElement("div");ei.setAttribute("oninput","return;"),Zn="function"===typeof ei.oninput}Qn=Zn}else Qn=!1;$n=Qn&&(!document.documentMode||9<document.documentMode)}function ti(){Yn&&(Yn.detachEvent("onpropertychange",ni),qn=Yn=null)}function ni(e){if("value"===e.propertyName&&Kn(qn)){var t=[];Wn(t,qn,e,xe(e)),Re(Xn,t)}}function ii(e,t,n){"focusin"===e?(ti(),qn=n,(Yn=t).attachEvent("onpropertychange",ni)):"focusout"===e&&ti()}function ri(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Kn(qn)}function si(e,t){if("click"===e)return Kn(t)}function ai(e,t){if("input"===e||"change"===e)return Kn(t)}var oi="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function li(e,t){if(oi(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!h.call(t,r)||!oi(e[r],t[r]))return!1}return!0}function ci(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ui(e,t){var n,i=ci(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ci(i)}}function hi(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hi(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function di(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=X((e=t.contentWindow).document)}return t}function pi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fi(e){var t=di(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hi(n.ownerDocument.documentElement,n)){if(null!==i&&pi(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=void 0===i.end?s:Math.min(i.end,r),!e.extend&&s>i&&(r=i,i=s,s=r),r=ui(n,s);var a=ui(n,i);r&&a&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mi=u&&"documentMode"in document&&11>=document.documentMode,gi=null,vi=null,yi=null,_i=!1;function wi(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;_i||null==gi||gi!==X(i)||("selectionStart"in(i=gi)&&pi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},yi&&li(yi,i)||(yi=i,0<(i=Yi(vi,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=gi)))}function xi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var bi={animationend:xi("Animation","AnimationEnd"),animationiteration:xi("Animation","AnimationIteration"),animationstart:xi("Animation","AnimationStart"),transitionend:xi("Transition","TransitionEnd")},Si={},Ni={};function Mi(e){if(Si[e])return Si[e];if(!bi[e])return e;var t,n=bi[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ni)return Si[e]=n[t];return e}u&&(Ni=document.createElement("div").style,"AnimationEvent"in window||(delete bi.animationend.animation,delete bi.animationiteration.animation,delete bi.animationstart.animation),"TransitionEvent"in window||delete bi.transitionend.transition);var Ti=Mi("animationend"),Ai=Mi("animationiteration"),Ei=Mi("animationstart"),Ci=Mi("transitionend"),Ii=new Map,Ri="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pi(e,t){Ii.set(e,t),l(t,[e])}for(var Di=0;Di<Ri.length;Di++){var ki=Ri[Di];Pi(ki.toLowerCase(),"on"+(ki[0].toUpperCase()+ki.slice(1)))}Pi(Ti,"onAnimationEnd"),Pi(Ai,"onAnimationIteration"),Pi(Ei,"onAnimationStart"),Pi("dblclick","onDoubleClick"),Pi("focusin","onFocus"),Pi("focusout","onBlur"),Pi(Ci,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Li="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Oi=new Set("cancel close invalid load scroll toggle".split(" ").concat(Li));function Bi(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,r,a,o,l,c){if(Fe.apply(this,arguments),Oe){if(!Oe)throw Error(s(198));var u=Be;Oe=!1,Be=null,Ue||(Ue=!0,ze=u)}}(i,t,void 0,e),e.currentTarget=null}function Ui(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var a=i.length-1;0<=a;a--){var o=i[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&r.isPropagationStopped())break e;Bi(r,o,c),s=l}else for(a=0;a<i.length;a++){if(l=(o=i[a]).instance,c=o.currentTarget,o=o.listener,l!==s&&r.isPropagationStopped())break e;Bi(r,o,c),s=l}}}if(Ue)throw e=ze,Ue=!1,ze=null,e}function zi(e,t){var n=t[mr];void 0===n&&(n=t[mr]=new Set);var i=e+"__bubble";n.has(i)||(Hi(t,e,2,!1),n.add(i))}function Vi(e,t,n){var i=0;t&&(i|=4),Hi(n,e,i,t)}var Fi="_reactListening"+Math.random().toString(36).slice(2);function ji(e){if(!e[Fi]){e[Fi]=!0,a.forEach((function(t){"selectionchange"!==t&&(Oi.has(t)||Vi(t,!1,e),Vi(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Fi]||(t[Fi]=!0,Vi("selectionchange",!1,t))}}function Hi(e,t,n,i){switch(Jt(t)){case 1:var r=Wt;break;case 4:r=Yt;break;default:r=qt}n=r.bind(null,t,n,e),r=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Gi(e,t,n,i,r){var s=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var a=i.tag;if(3===a||4===a){var o=i.stateNode.containerInfo;if(o===r||8===o.nodeType&&o.parentNode===r)break;if(4===a)for(a=i.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;a=a.return}for(;null!==o;){if(null===(a=yr(o)))return;if(5===(l=a.tag)||6===l){i=s=a;continue e}o=o.parentNode}}i=i.return}Re((function(){var i=s,r=xe(n),a=[];e:{var o=Ii.get(e);if(void 0!==o){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=An;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Cn;break;case Ti:case Ai:case Ei:l=vn;break;case Ci:l=In;break;case"scroll":l=dn;break;case"wheel":l=Pn;break;case"copy":case"cut":case"paste":l=_n;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=En}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==o?o+"Capture":null:o;u=[];for(var p,f=i;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==d&&(null!=(m=Pe(f,d))&&u.push(Wi(f,m,p)))),h)break;f=f.return}0<u.length&&(o=new l(o,c,null,n,r),a.push({event:o,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!yr(c)&&!c[fr])&&(l||o)&&(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?yr(c):null)&&(c!==(h=je(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=fn,m="onMouseLeave",d="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=En,m="onPointerLeave",d="onPointerEnter",f="pointer"),h=null==l?o:wr(l),p=null==c?o:wr(c),(o=new u(m,f+"leave",l,n,r)).target=h,o.relatedTarget=p,m=null,yr(r)===i&&((u=new u(d,f+"enter",c,n,r)).target=p,u.relatedTarget=h,m=u),h=m,l&&c)e:{for(d=c,f=0,p=u=l;p;p=qi(p))f++;for(p=0,m=d;m;m=qi(m))p++;for(;0<f-p;)u=qi(u),f--;for(;0<p-f;)d=qi(d),p--;for(;f--;){if(u===d||null!==d&&u===d.alternate)break e;u=qi(u),d=qi(d)}u=null}else u=null;null!==l&&Xi(a,o,l,u,!1),null!==c&&null!==h&&Xi(a,h,c,u,!0)}if("select"===(l=(o=i?wr(i):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Jn;else if(Gn(o))if($n)g=ai;else{g=ri;var v=ii}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=si);switch(g&&(g=g(e,i))?Wn(a,g,n,r):(v&&v(e,o,i),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ee(o,"number",o.value)),v=i?wr(i):window,e){case"focusin":(Gn(v)||"true"===v.contentEditable)&&(gi=v,vi=i,yi=null);break;case"focusout":yi=vi=gi=null;break;case"mousedown":_i=!0;break;case"contextmenu":case"mouseup":case"dragend":_i=!1,wi(a,n,r);break;case"selectionchange":if(mi)break;case"keydown":case"keyup":wi(a,n,r)}var y;if(kn)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else jn?Vn(e,n)&&(_="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(_="onCompositionStart");_&&(Bn&&"ko"!==n.locale&&(jn||"onCompositionStart"!==_?"onCompositionEnd"===_&&jn&&(y=en()):(Qt="value"in($t=r)?$t.value:$t.textContent,jn=!0)),0<(v=Yi(i,_)).length&&(_=new wn(_,e,null,n,r),a.push({event:_,listeners:v}),y?_.data=y:null!==(y=Fn(n))&&(_.data=y))),(y=On?function(e,t){switch(e){case"compositionend":return Fn(t);case"keypress":return 32!==t.which?null:(zn=!0,Un);case"textInput":return(e=t.data)===Un&&zn?null:e;default:return null}}(e,n):function(e,t){if(jn)return"compositionend"===e||!kn&&Vn(e,t)?(e=en(),Zt=Qt=$t=null,jn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Bn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(i=Yi(i,"onBeforeInput")).length&&(r=new wn("onBeforeInput","beforeinput",null,n,r),a.push({event:r,listeners:i}),r.data=y))}Ui(a,t)}))}function Wi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Yi(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=Pe(e,n))&&i.unshift(Wi(e,s,r)),null!=(s=Pe(e,t))&&i.push(Wi(e,s,r))),e=e.return}return i}function qi(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xi(e,t,n,i,r){for(var s=t._reactName,a=[];null!==n&&n!==i;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===i)break;5===o.tag&&null!==c&&(o=c,r?null!=(l=Pe(n,s))&&a.unshift(Wi(n,l,o)):r||null!=(l=Pe(n,s))&&a.push(Wi(n,l,o))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Ki=/\r\n?/g,Ji=/\u0000|\uFFFD/g;function $i(e){return("string"===typeof e?e:""+e).replace(Ki,"\n").replace(Ji,"")}function Qi(e,t,n){if(t=$i(t),$i(e)!==t&&n)throw Error(s(425))}function Zi(){}var er=null,tr=null;function nr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,sr="function"===typeof Promise?Promise:void 0,ar="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sr?function(e){return sr.resolve(null).then(e).catch(or)}:ir;function or(e){setTimeout((function(){throw e}))}function lr(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return e.removeChild(r),void jt(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);jt(t)}function cr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ur(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hr=Math.random().toString(36).slice(2),dr="__reactFiber$"+hr,pr="__reactProps$"+hr,fr="__reactContainer$"+hr,mr="__reactEvents$"+hr,gr="__reactListeners$"+hr,vr="__reactHandles$"+hr;function yr(e){var t=e[dr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fr]||n[dr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ur(e);null!==e;){if(n=e[dr])return n;e=ur(e)}return t}n=(e=n).parentNode}return null}function _r(e){return!(e=e[dr]||e[fr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function xr(e){return e[pr]||null}var br=[],Sr=-1;function Nr(e){return{current:e}}function Mr(e){0>Sr||(e.current=br[Sr],br[Sr]=null,Sr--)}function Tr(e,t){Sr++,br[Sr]=e.current,e.current=t}var Ar={},Er=Nr(Ar),Cr=Nr(!1),Ir=Ar;function Rr(e,t){var n=e.type.contextTypes;if(!n)return Ar;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Pr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Dr(){Mr(Cr),Mr(Er)}function kr(e,t,n){if(Er.current!==Ar)throw Error(s(168));Tr(Er,t),Tr(Cr,n)}function Lr(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(s(108,H(e)||"Unknown",r));return B({},n,i)}function Or(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ar,Ir=Er.current,Tr(Er,e),Tr(Cr,Cr.current),!0}function Br(e,t,n){var i=e.stateNode;if(!i)throw Error(s(169));n?(e=Lr(e,t,Ir),i.__reactInternalMemoizedMergedChildContext=e,Mr(Cr),Mr(Er),Tr(Er,e)):Mr(Cr),Tr(Cr,n)}var Ur=null,zr=!1,Vr=!1;function Fr(e){null===Ur?Ur=[e]:Ur.push(e)}function jr(){if(!Vr&&null!==Ur){Vr=!0;var e=0,t=_t;try{var n=Ur;for(_t=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}Ur=null,zr=!1}catch(r){throw null!==Ur&&(Ur=Ur.slice(e+1)),qe(Ze,jr),r}finally{_t=t,Vr=!1}}return null}var Hr=[],Gr=0,Wr=null,Yr=0,qr=[],Xr=0,Kr=null,Jr=1,$r="";function Qr(e,t){Hr[Gr++]=Yr,Hr[Gr++]=Wr,Wr=e,Yr=t}function Zr(e,t,n){qr[Xr++]=Jr,qr[Xr++]=$r,qr[Xr++]=Kr,Kr=e;var i=Jr;e=$r;var r=32-at(i)-1;i&=~(1<<r),n+=1;var s=32-at(t)+r;if(30<s){var a=r-r%5;s=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Jr=1<<32-at(t)+r|n<<r|i,$r=s+e}else Jr=1<<s|n<<r|i,$r=e}function es(e){null!==e.return&&(Qr(e,1),Zr(e,1,0))}function ts(e){for(;e===Wr;)Wr=Hr[--Gr],Hr[Gr]=null,Yr=Hr[--Gr],Hr[Gr]=null;for(;e===Kr;)Kr=qr[--Xr],qr[Xr]=null,$r=qr[--Xr],qr[Xr]=null,Jr=qr[--Xr],qr[Xr]=null}var ns=null,is=null,rs=!1,ss=null;function as(e,t){var n=Pc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function os(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,is=cr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,is=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Kr?{id:Jr,overflow:$r}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Pc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,is=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(rs){var t=is;if(t){var n=t;if(!os(e,t)){if(ls(e))throw Error(s(418));t=cr(n.nextSibling);var i=ns;t&&os(e,t)?as(i,n):(e.flags=-4097&e.flags|2,rs=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,rs=!1,ns=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function hs(e){if(e!==ns)return!1;if(!rs)return us(e),rs=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!nr(e.type,e.memoizedProps)),t&&(t=is)){if(ls(e))throw ds(),Error(s(418));for(;t;)as(e,t),t=cr(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){is=cr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}is=null}}else is=ns?cr(e.stateNode.nextSibling):null;return!0}function ds(){for(var e=is;e;)e=cr(e.nextSibling)}function ps(){is=ns=null,rs=!1}function fs(e){null===ss?ss=[e]:ss.push(e)}var ms=w.ReactCurrentBatchConfig;function gs(e,t){if(e&&e.defaultProps){for(var n in t=B({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var vs=Nr(null),ys=null,_s=null,ws=null;function xs(){ws=_s=ys=null}function bs(e){var t=vs.current;Mr(vs),e._currentValue=t}function Ss(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Ns(e,t){ys=e,ws=_s=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(wo=!0),e.firstContext=null)}function Ms(e){var t=e._currentValue;if(ws!==e)if(e={context:e,memoizedValue:t,next:null},null===_s){if(null===ys)throw Error(s(308));_s=e,ys.dependencies={lanes:0,firstContext:e}}else _s=_s.next=e;return t}var Ts=null;function As(e){null===Ts?Ts=[e]:Ts.push(e)}function Es(e,t,n,i){var r=t.interleaved;return null===r?(n.next=n,As(t)):(n.next=r.next,r.next=n),t.interleaved=n,Cs(e,i)}function Cs(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Is=!1;function Rs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ps(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ds(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ks(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&Cl)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,Cs(e,n)}return null===(r=i.interleaved)?(t.next=t,As(i)):(t.next=r.next,r.next=t),i.interleaved=t,Cs(e,n)}function Ls(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Os(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=a:s=s.next=a,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Bs(e,t,n,i){var r=e.updateQueue;Is=!1;var s=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(null!==o){r.shared.pending=null;var l=o,c=l.next;l.next=null,null===a?s=c:a.next=c,a=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==s){var h=r.baseState;for(a=0,u=c=l=null,o=s;;){var d=o.lane,p=o.eventTime;if((i&d)===d){null!==u&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,m=o;switch(d=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){h=f.call(p,h,d);break e}h=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(d="function"===typeof(f=m.payload)?f.call(p,h,d):f)||void 0===d)break e;h=B({},h,d);break e;case 2:Is=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(d=r.effects)?r.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,a|=d;if(null===(o=o.next)){if(null===(o=r.shared.pending))break;o=(d=o).next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}if(null===u&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{a|=r.lane,r=r.next}while(r!==t)}else null===s&&(r.shared.lanes=0);Bl|=a,e.lanes=a,e.memoizedState=h}}function Us(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(s(191,r));r.call(i)}}}var zs=(new i.Component).refs;function Vs(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:B({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Fs={isMounted:function(e){return!!(e=e._reactInternals)&&je(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=tc(),r=nc(e),s=Ds(i,r);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=ks(e,s,r))&&(ic(t,e,r,i),Ls(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=tc(),r=nc(e),s=Ds(i,r);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=ks(e,s,r))&&(ic(t,e,r,i),Ls(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),i=nc(e),r=Ds(n,i);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=ks(e,r,i))&&(ic(t,e,i,n),Ls(t,e,i))}};function js(e,t,n,i,r,s,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,s,a):!t.prototype||!t.prototype.isPureReactComponent||(!li(n,i)||!li(r,s))}function Hs(e,t,n){var i=!1,r=Ar,s=t.contextType;return"object"===typeof s&&null!==s?s=Ms(s):(r=Pr(t)?Ir:Er.current,s=(i=null!==(i=t.contextTypes)&&void 0!==i)?Rr(e,r):Ar),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Fs,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function Gs(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&Fs.enqueueReplaceState(t,t.state,null)}function Ws(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs=zs,Rs(e);var s=t.contextType;"object"===typeof s&&null!==s?r.context=Ms(s):(s=Pr(t)?Ir:Er.current,r.context=Rr(e,s)),r.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(Vs(e,t,s,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&Fs.enqueueReplaceState(r,r.state,null),Bs(e,n,r,i),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function Ys(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var i=n.stateNode}if(!i)throw Error(s(147,e));var r=i,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=r.refs;t===zs&&(t=r.refs={}),null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function qs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Xs(e){return(0,e._init)(e._payload)}function Ks(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=kc(e,t)).index=0,e.sibling=null,e}function a(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=Uc(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,i){var s=n.type;return s===S?h(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===P&&Xs(s)===t.type)?((i=r(t,n.props)).ref=Ys(e,t,n),i.return=e,i):((i=Lc(n.type,n.key,n.props,null,e.mode,i)).ref=Ys(e,t,n),i.return=e,i)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=zc(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function h(e,t,n,i,s){return null===t||7!==t.tag?((t=Oc(n,e.mode,i,s)).return=e,t):((t=r(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Uc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(n=Lc(t.type,t.key,t.props,null,e.mode,n)).ref=Ys(e,null,t),n.return=e,n;case b:return(t=zc(t,e.mode,n)).return=e,t;case P:return d(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=Oc(t,e.mode,n,null)).return=e,t;qs(e,t)}return null}function p(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===r?c(e,t,n,i):null;case b:return n.key===r?u(e,t,n,i):null;case P:return p(e,t,(r=n._init)(n._payload),i)}if(te(n)||L(n))return null!==r?null:h(e,t,n,i,null);qs(e,n)}return null}function f(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return l(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case x:return c(t,e=e.get(null===i.key?n:i.key)||null,i,r);case b:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r);case P:return f(e,t,n,(0,i._init)(i._payload),r)}if(te(i)||L(i))return h(t,e=e.get(n)||null,i,r,null);qs(t,i)}return null}function m(r,s,o,l){for(var c=null,u=null,h=s,m=s=0,g=null;null!==h&&m<o.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=p(r,h,o[m],l);if(null===v){null===h&&(h=g);break}e&&h&&null===v.alternate&&t(r,h),s=a(v,s,m),null===u?c=v:u.sibling=v,u=v,h=g}if(m===o.length)return n(r,h),rs&&Qr(r,m),c;if(null===h){for(;m<o.length;m++)null!==(h=d(r,o[m],l))&&(s=a(h,s,m),null===u?c=h:u.sibling=h,u=h);return rs&&Qr(r,m),c}for(h=i(r,h);m<o.length;m++)null!==(g=f(h,r,m,o[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),s=a(g,s,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach((function(e){return t(r,e)})),rs&&Qr(r,m),c}function g(r,o,l,c){var u=L(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var h=u=null,m=o,g=o=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var _=p(r,m,y.value,c);if(null===_){null===m&&(m=v);break}e&&m&&null===_.alternate&&t(r,m),o=a(_,o,g),null===h?u=_:h.sibling=_,h=_,m=v}if(y.done)return n(r,m),rs&&Qr(r,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=d(r,y.value,c))&&(o=a(y,o,g),null===h?u=y:h.sibling=y,h=y);return rs&&Qr(r,g),u}for(m=i(r,m);!y.done;g++,y=l.next())null!==(y=f(m,r,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),o=a(y,o,g),null===h?u=y:h.sibling=y,h=y);return e&&m.forEach((function(e){return t(r,e)})),rs&&Qr(r,g),u}return function e(i,s,a,l){if("object"===typeof a&&null!==a&&a.type===S&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case x:e:{for(var c=a.key,u=s;null!==u;){if(u.key===c){if((c=a.type)===S){if(7===u.tag){n(i,u.sibling),(s=r(u,a.props.children)).return=i,i=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===P&&Xs(c)===u.type){n(i,u.sibling),(s=r(u,a.props)).ref=Ys(i,u,a),s.return=i,i=s;break e}n(i,u);break}t(i,u),u=u.sibling}a.type===S?((s=Oc(a.props.children,i.mode,l,a.key)).return=i,i=s):((l=Lc(a.type,a.key,a.props,null,i.mode,l)).ref=Ys(i,s,a),l.return=i,i=l)}return o(i);case b:e:{for(u=a.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===a.containerInfo&&s.stateNode.implementation===a.implementation){n(i,s.sibling),(s=r(s,a.children||[])).return=i,i=s;break e}n(i,s);break}t(i,s),s=s.sibling}(s=zc(a,i.mode,l)).return=i,i=s}return o(i);case P:return e(i,s,(u=a._init)(a._payload),l)}if(te(a))return m(i,s,a,l);if(L(a))return g(i,s,a,l);qs(i,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==s&&6===s.tag?(n(i,s.sibling),(s=r(s,a)).return=i,i=s):(n(i,s),(s=Uc(a,i.mode,l)).return=i,i=s),o(i)):n(i,s)}}var Js=Ks(!0),$s=Ks(!1),Qs={},Zs=Nr(Qs),ea=Nr(Qs),ta=Nr(Qs);function na(e){if(e===Qs)throw Error(s(174));return e}function ia(e,t){switch(Tr(ta,t),Tr(ea,e),Tr(Zs,Qs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Mr(Zs),Tr(Zs,t)}function ra(){Mr(Zs),Mr(ea),Mr(ta)}function sa(e){na(ta.current);var t=na(Zs.current),n=le(t,e.type);t!==n&&(Tr(ea,e),Tr(Zs,n))}function aa(e){ea.current===e&&(Mr(Zs),Mr(ea))}var oa=Nr(0);function la(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ca=[];function ua(){for(var e=0;e<ca.length;e++)ca[e]._workInProgressVersionPrimary=null;ca.length=0}var ha=w.ReactCurrentDispatcher,da=w.ReactCurrentBatchConfig,pa=0,fa=null,ma=null,ga=null,va=!1,ya=!1,_a=0,wa=0;function xa(){throw Error(s(321))}function ba(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!oi(e[n],t[n]))return!1;return!0}function Sa(e,t,n,i,r,a){if(pa=a,fa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ha.current=null===e||null===e.memoizedState?ao:oo,e=n(i,r),ya){a=0;do{if(ya=!1,_a=0,25<=a)throw Error(s(301));a+=1,ga=ma=null,t.updateQueue=null,ha.current=lo,e=n(i,r)}while(ya)}if(ha.current=so,t=null!==ma&&null!==ma.next,pa=0,ga=ma=fa=null,va=!1,t)throw Error(s(300));return e}function Na(){var e=0!==_a;return _a=0,e}function Ma(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ga?fa.memoizedState=ga=e:ga=ga.next=e,ga}function Ta(){if(null===ma){var e=fa.alternate;e=null!==e?e.memoizedState:null}else e=ma.next;var t=null===ga?fa.memoizedState:ga.next;if(null!==t)ga=t,ma=e;else{if(null===e)throw Error(s(310));e={memoizedState:(ma=e).memoizedState,baseState:ma.baseState,baseQueue:ma.baseQueue,queue:ma.queue,next:null},null===ga?fa.memoizedState=ga=e:ga=ga.next=e}return ga}function Aa(e,t){return"function"===typeof t?t(e):t}function Ea(e){var t=Ta(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=ma,r=i.baseQueue,a=n.pending;if(null!==a){if(null!==r){var o=r.next;r.next=a.next,a.next=o}i.baseQueue=r=a,n.pending=null}if(null!==r){a=r.next,i=i.baseState;var l=o=null,c=null,u=a;do{var h=u.lane;if((pa&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,o=i):c=c.next=d,fa.lanes|=h,Bl|=h}u=u.next}while(null!==u&&u!==a);null===c?o=i:c.next=l,oi(i,t.memoizedState)||(wo=!0),t.memoizedState=i,t.baseState=o,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{a=r.lane,fa.lanes|=a,Bl|=a,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ca(e){var t=Ta(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,a=t.memoizedState;if(null!==r){n.pending=null;var o=r=r.next;do{a=e(a,o.action),o=o.next}while(o!==r);oi(a,t.memoizedState)||(wo=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,i]}function Ia(){}function Ra(e,t){var n=fa,i=Ta(),r=t(),a=!oi(i.memoizedState,r);if(a&&(i.memoizedState=r,wo=!0),i=i.queue,Ha(ka.bind(null,n,i,e),[e]),i.getSnapshot!==t||a||null!==ga&&1&ga.memoizedState.tag){if(n.flags|=2048,Ua(9,Da.bind(null,n,i,r,t),void 0,null),null===Il)throw Error(s(349));0!==(30&pa)||Pa(n,t,r)}return r}function Pa(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=fa.updateQueue)?(t={lastEffect:null,stores:null},fa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Da(e,t,n,i){t.value=n,t.getSnapshot=i,La(t)&&Oa(e)}function ka(e,t,n){return n((function(){La(t)&&Oa(e)}))}function La(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!oi(e,n)}catch(i){return!0}}function Oa(e){var t=Cs(e,1);null!==t&&ic(t,e,1,-1)}function Ba(e){var t=Ma();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:e},t.queue=e,e=e.dispatch=to.bind(null,fa,e),[t.memoizedState,e]}function Ua(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=fa.updateQueue)?(t={lastEffect:null,stores:null},fa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function za(){return Ta().memoizedState}function Va(e,t,n,i){var r=Ma();fa.flags|=e,r.memoizedState=Ua(1|t,n,void 0,void 0===i?null:i)}function Fa(e,t,n,i){var r=Ta();i=void 0===i?null:i;var s=void 0;if(null!==ma){var a=ma.memoizedState;if(s=a.destroy,null!==i&&ba(i,a.deps))return void(r.memoizedState=Ua(t,n,s,i))}fa.flags|=e,r.memoizedState=Ua(1|t,n,s,i)}function ja(e,t){return Va(8390656,8,e,t)}function Ha(e,t){return Fa(2048,8,e,t)}function Ga(e,t){return Fa(4,2,e,t)}function Wa(e,t){return Fa(4,4,e,t)}function Ya(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function qa(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Fa(4,4,Ya.bind(null,t,e),n)}function Xa(){}function Ka(e,t){var n=Ta();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&ba(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Ja(e,t){var n=Ta();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&ba(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function $a(e,t,n){return 0===(21&pa)?(e.baseState&&(e.baseState=!1,wo=!0),e.memoizedState=n):(oi(n,t)||(n=mt(),fa.lanes|=n,Bl|=n,e.baseState=!0),t)}function Qa(e,t){var n=_t;_t=0!==n&&4>n?n:4,e(!0);var i=da.transition;da.transition={};try{e(!1),t()}finally{_t=n,da.transition=i}}function Za(){return Ta().memoizedState}function eo(e,t,n){var i=nc(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},no(e))io(t,n);else if(null!==(n=Es(e,t,n,i))){ic(n,e,i,tc()),ro(n,t,i)}}function to(e,t,n){var i=nc(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(no(e))io(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var a=t.lastRenderedState,o=s(a,n);if(r.hasEagerState=!0,r.eagerState=o,oi(o,a)){var l=t.interleaved;return null===l?(r.next=r,As(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(c){}null!==(n=Es(e,t,r,i))&&(ic(n,e,i,r=tc()),ro(n,t,i))}}function no(e){var t=e.alternate;return e===fa||null!==t&&t===fa}function io(e,t){ya=va=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ro(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}var so={readContext:Ms,useCallback:xa,useContext:xa,useEffect:xa,useImperativeHandle:xa,useInsertionEffect:xa,useLayoutEffect:xa,useMemo:xa,useReducer:xa,useRef:xa,useState:xa,useDebugValue:xa,useDeferredValue:xa,useTransition:xa,useMutableSource:xa,useSyncExternalStore:xa,useId:xa,unstable_isNewReconciler:!1},ao={readContext:Ms,useCallback:function(e,t){return Ma().memoizedState=[e,void 0===t?null:t],e},useContext:Ms,useEffect:ja,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Va(4194308,4,Ya.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Va(4194308,4,e,t)},useInsertionEffect:function(e,t){return Va(4,2,e,t)},useMemo:function(e,t){var n=Ma();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=Ma();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=eo.bind(null,fa,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},Ma().memoizedState=e},useState:Ba,useDebugValue:Xa,useDeferredValue:function(e){return Ma().memoizedState=e},useTransition:function(){var e=Ba(!1),t=e[0];return e=Qa.bind(null,e[1]),Ma().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=fa,r=Ma();if(rs){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Il)throw Error(s(349));0!==(30&pa)||Pa(i,t,n)}r.memoizedState=n;var a={value:n,getSnapshot:t};return r.queue=a,ja(ka.bind(null,i,a,e),[e]),i.flags|=2048,Ua(9,Da.bind(null,i,a,n,t),void 0,null),n},useId:function(){var e=Ma(),t=Il.identifierPrefix;if(rs){var n=$r;t=":"+t+"R"+(n=(Jr&~(1<<32-at(Jr)-1)).toString(32)+n),0<(n=_a++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=wa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},oo={readContext:Ms,useCallback:Ka,useContext:Ms,useEffect:Ha,useImperativeHandle:qa,useInsertionEffect:Ga,useLayoutEffect:Wa,useMemo:Ja,useReducer:Ea,useRef:za,useState:function(){return Ea(Aa)},useDebugValue:Xa,useDeferredValue:function(e){return $a(Ta(),ma.memoizedState,e)},useTransition:function(){return[Ea(Aa)[0],Ta().memoizedState]},useMutableSource:Ia,useSyncExternalStore:Ra,useId:Za,unstable_isNewReconciler:!1},lo={readContext:Ms,useCallback:Ka,useContext:Ms,useEffect:Ha,useImperativeHandle:qa,useInsertionEffect:Ga,useLayoutEffect:Wa,useMemo:Ja,useReducer:Ca,useRef:za,useState:function(){return Ca(Aa)},useDebugValue:Xa,useDeferredValue:function(e){var t=Ta();return null===ma?t.memoizedState=e:$a(t,ma.memoizedState,e)},useTransition:function(){return[Ca(Aa)[0],Ta().memoizedState]},useMutableSource:Ia,useSyncExternalStore:Ra,useId:Za,unstable_isNewReconciler:!1};function co(e,t){try{var n="",i=t;do{n+=F(i),i=i.return}while(i);var r=n}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:r,digest:null}}function uo(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ho(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var po="function"===typeof WeakMap?WeakMap:Map;function fo(e,t,n){(n=Ds(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){Wl||(Wl=!0,Yl=i),ho(0,t)},n}function mo(e,t,n){(n=Ds(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){ho(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){ho(0,t),"function"!==typeof i&&(null===ql?ql=new Set([this]):ql.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function go(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new po;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=Tc.bind(null,e,t,n),t.then(e,e))}function vo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function yo(e,t,n,i,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ds(-1,1)).tag=2,ks(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var _o=w.ReactCurrentOwner,wo=!1;function xo(e,t,n,i){t.child=null===e?$s(t,null,n,i):Js(t,e.child,n,i)}function bo(e,t,n,i,r){n=n.render;var s=t.ref;return Ns(t,r),i=Sa(e,t,n,i,s,r),n=Na(),null===e||wo?(rs&&n&&es(t),t.flags|=1,xo(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Wo(e,t,r))}function So(e,t,n,i,r){if(null===e){var s=n.type;return"function"!==typeof s||Dc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Lc(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,No(e,t,s,i,r))}if(s=e.child,0===(e.lanes&r)){var a=s.memoizedProps;if((n=null!==(n=n.compare)?n:li)(a,i)&&e.ref===t.ref)return Wo(e,t,r)}return t.flags|=1,(e=kc(s,i)).ref=t.ref,e.return=t,t.child=e}function No(e,t,n,i,r){if(null!==e){var s=e.memoizedProps;if(li(s,i)&&e.ref===t.ref){if(wo=!1,t.pendingProps=i=s,0===(e.lanes&r))return t.lanes=e.lanes,Wo(e,t,r);0!==(131072&e.flags)&&(wo=!0)}}return Ao(e,t,n,i,r)}function Mo(e,t,n){var i=t.pendingProps,r=i.children,s=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Tr(kl,Dl),Dl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Tr(kl,Dl),Dl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==s?s.baseLanes:n,Tr(kl,Dl),Dl|=i}else null!==s?(i=s.baseLanes|n,t.memoizedState=null):i=n,Tr(kl,Dl),Dl|=i;return xo(e,t,r,n),t.child}function To(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ao(e,t,n,i,r){var s=Pr(n)?Ir:Er.current;return s=Rr(t,s),Ns(t,r),n=Sa(e,t,n,i,s,r),i=Na(),null===e||wo?(rs&&i&&es(t),t.flags|=1,xo(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Wo(e,t,r))}function Eo(e,t,n,i,r){if(Pr(n)){var s=!0;Or(t)}else s=!1;if(Ns(t,r),null===t.stateNode)Go(e,t),Hs(t,n,i),Ws(t,n,i,r),i=!0;else if(null===e){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ms(c):c=Rr(t,c=Pr(n)?Ir:Er.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;h||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==i||l!==c)&&Gs(t,a,i,c),Is=!1;var d=t.memoizedState;a.state=d,Bs(t,i,a,r),l=t.memoizedState,o!==i||d!==l||Cr.current||Is?("function"===typeof u&&(Vs(t,n,u,i),l=t.memoizedState),(o=Is||js(t,n,o,i,d,l,c))?(h||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),a.props=i,a.state=l,a.context=c,i=o):("function"===typeof a.componentDidMount&&(t.flags|=4194308),i=!1)}else{a=t.stateNode,Ps(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:gs(t.type,o),a.props=c,h=t.pendingProps,d=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ms(l):l=Rr(t,l=Pr(n)?Ir:Er.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==h||d!==l)&&Gs(t,a,i,l),Is=!1,d=t.memoizedState,a.state=d,Bs(t,i,a,r);var f=t.memoizedState;o!==h||d!==f||Cr.current||Is?("function"===typeof p&&(Vs(t,n,p,i),f=t.memoizedState),(c=Is||js(t,n,c,i,d,f,l)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(i,f,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(i,f,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=f),a.props=i,a.state=f,a.context=l,i=c):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),i=!1)}return Co(e,t,n,i,s,r)}function Co(e,t,n,i,r,s){To(e,t);var a=0!==(128&t.flags);if(!i&&!a)return r&&Br(t,n,!1),Wo(e,t,s);i=t.stateNode,_o.current=t;var o=a&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&a?(t.child=Js(t,e.child,null,s),t.child=Js(t,null,o,s)):xo(e,t,o,s),t.memoizedState=i.state,r&&Br(t,n,!0),t.child}function Io(e){var t=e.stateNode;t.pendingContext?kr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&kr(0,t.context,!1),ia(e,t.containerInfo)}function Ro(e,t,n,i,r){return ps(),fs(r),t.flags|=256,xo(e,t,n,i),t.child}var Po,Do,ko,Lo,Oo={dehydrated:null,treeContext:null,retryLane:0};function Bo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Uo(e,t,n){var i,r=t.pendingProps,a=oa.current,o=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&a)),i?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Tr(oa,1&a),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,o?(r=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Bc(l,r,0,null),e=Oc(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Bo(n),t.memoizedState=Oo,e):zo(t,l));if(null!==(a=e.memoizedState)&&null!==(i=a.dehydrated))return function(e,t,n,i,r,a,o){if(n)return 256&t.flags?(t.flags&=-257,Vo(e,t,o,i=uo(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=i.fallback,r=t.mode,i=Bc({mode:"visible",children:i.children},r,0,null),(a=Oc(a,r,o,null)).flags|=2,i.return=t,a.return=t,i.sibling=a,t.child=i,0!==(1&t.mode)&&Js(t,e.child,null,o),t.child.memoizedState=Bo(o),t.memoizedState=Oo,a);if(0===(1&t.mode))return Vo(e,t,o,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var l=i.dgst;return i=l,Vo(e,t,o,i=uo(a=Error(s(419)),i,void 0))}if(l=0!==(o&e.childLanes),wo||l){if(null!==(i=Il)){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(i.suspendedLanes|o))?0:r)&&r!==a.retryLane&&(a.retryLane=r,Cs(e,r),ic(i,e,r,-1))}return gc(),Vo(e,t,o,i=uo(Error(s(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Ec.bind(null,e),r._reactRetry=t,null):(e=a.treeContext,is=cr(r.nextSibling),ns=t,rs=!0,ss=null,null!==e&&(qr[Xr++]=Jr,qr[Xr++]=$r,qr[Xr++]=Kr,Jr=e.id,$r=e.overflow,Kr=t),t=zo(t,i.children),t.flags|=4096,t)}(e,t,l,r,i,a,n);if(o){o=r.fallback,l=t.mode,i=(a=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==a?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=kc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==i?o=kc(i,o):(o=Oc(o,l,n,null)).flags|=2,o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,l=null===(l=e.child.memoizedState)?Bo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Oo,r}return e=(o=e.child).sibling,r=kc(o,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function zo(e,t){return(t=Bc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Vo(e,t,n,i){return null!==i&&fs(i),Js(t,e.child,null,n),(e=zo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Fo(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Ss(e.return,t,n)}function jo(e,t,n,i,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function Ho(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(xo(e,t,i.children,n),0!==(2&(i=oa.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Fo(e,n,t);else if(19===e.tag)Fo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Tr(oa,i),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===la(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),jo(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===la(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}jo(t,!0,n,null,s);break;case"together":jo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Go(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Bl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=kc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=kc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Yo(e,t){if(!rs)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function qo(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Xo(e,t,n){var i=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qo(t),null;case 1:case 17:return Pr(t.type)&&Dr(),qo(t),null;case 3:return i=t.stateNode,ra(),Mr(Cr),Mr(Er),ua(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(hs(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(oc(ss),ss=null))),Do(e,t),qo(t),null;case 5:aa(t);var r=na(ta.current);if(n=t.type,null!==e&&null!=t.stateNode)ko(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(s(166));return qo(t),null}if(e=na(Zs.current),hs(t)){i=t.stateNode,n=t.type;var a=t.memoizedProps;switch(i[dr]=t,i[pr]=a,e=0!==(1&t.mode),n){case"dialog":zi("cancel",i),zi("close",i);break;case"iframe":case"object":case"embed":zi("load",i);break;case"video":case"audio":for(r=0;r<Li.length;r++)zi(Li[r],i);break;case"source":zi("error",i);break;case"img":case"image":case"link":zi("error",i),zi("load",i);break;case"details":zi("toggle",i);break;case"input":J(i,a),zi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!a.multiple},zi("invalid",i);break;case"textarea":re(i,a),zi("invalid",i)}for(var l in ye(n,a),r=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?i.textContent!==c&&(!0!==a.suppressHydrationWarning&&Qi(i.textContent,c,e),r=["children",c]):"number"===typeof c&&i.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&Qi(i.textContent,c,e),r=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&zi("scroll",i)}switch(n){case"input":Y(i),Z(i,a,!0);break;case"textarea":Y(i),ae(i);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(i.onclick=Zi)}i=r,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[dr]=t,e[pr]=i,Po(e,t,!1,!1),t.stateNode=e;e:{switch(l=_e(n,i),n){case"dialog":zi("cancel",e),zi("close",e),r=i;break;case"iframe":case"object":case"embed":zi("load",e),r=i;break;case"video":case"audio":for(r=0;r<Li.length;r++)zi(Li[r],e);r=i;break;case"source":zi("error",e),r=i;break;case"img":case"image":case"link":zi("error",e),zi("load",e),r=i;break;case"details":zi("toggle",e),r=i;break;case"input":J(e,i),r=K(e,i),zi("invalid",e);break;case"option":default:r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=B({},i,{value:void 0}),zi("invalid",e);break;case"textarea":re(e,i),r=ie(e,i),zi("invalid",e)}for(a in ye(n,r),c=r)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?ge(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===a?"string"===typeof u?("textarea"!==n||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=u&&"onScroll"===a&&zi("scroll",e):null!=u&&_(e,a,u,l))}switch(n){case"input":Y(e),Z(e,i,!1);break;case"textarea":Y(e),ae(e);break;case"option":null!=i.value&&e.setAttribute("value",""+G(i.value));break;case"select":e.multiple=!!i.multiple,null!=(a=i.value)?ne(e,!!i.multiple,a,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Zi)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qo(t),null;case 6:if(e&&null!=t.stateNode)Lo(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(s(166));if(n=na(ta.current),na(Zs.current),hs(t)){if(i=t.stateNode,n=t.memoizedProps,i[dr]=t,(a=i.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Qi(i.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qi(i.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[dr]=t,t.stateNode=i}return qo(t),null;case 13:if(Mr(oa),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(rs&&null!==is&&0!==(1&t.mode)&&0===(128&t.flags))ds(),ps(),t.flags|=98560,a=!1;else if(a=hs(t),null!==i&&null!==i.dehydrated){if(null===e){if(!a)throw Error(s(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(s(317));a[dr]=t}else ps(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qo(t),a=!1}else null!==ss&&(oc(ss),ss=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&oa.current)?0===Ll&&(Ll=3):gc())),null!==t.updateQueue&&(t.flags|=4),qo(t),null);case 4:return ra(),Do(e,t),null===e&&ji(t.stateNode.containerInfo),qo(t),null;case 10:return bs(t.type._context),qo(t),null;case 19:if(Mr(oa),null===(a=t.memoizedState))return qo(t),null;if(i=0!==(128&t.flags),null===(l=a.rendering))if(i)Yo(a,!1);else{if(0!==Ll||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=la(e))){for(t.flags|=128,Yo(a,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Tr(oa,1&oa.current|2),t.child}e=e.sibling}null!==a.tail&&$e()>Hl&&(t.flags|=128,i=!0,Yo(a,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=la(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Yo(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!rs)return qo(t),null}else 2*$e()-a.renderingStartTime>Hl&&1073741824!==n&&(t.flags|=128,i=!0,Yo(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=$e(),t.sibling=null,n=oa.current,Tr(oa,i?1&n|2:1&n),t):(qo(t),null);case 22:case 23:return dc(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Dl)&&(qo(t),6&t.subtreeFlags&&(t.flags|=8192)):qo(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Ko(e,t){switch(ts(t),t.tag){case 1:return Pr(t.type)&&Dr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ra(),Mr(Cr),Mr(Er),ua(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return aa(t),null;case 13:if(Mr(oa),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ps()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Mr(oa),null;case 4:return ra(),null;case 10:return bs(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Po=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Do=function(){},ko=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,na(Zs.current);var s,a=null;switch(n){case"input":r=K(e,r),i=K(e,i),a=[];break;case"select":r=B({},r,{value:void 0}),i=B({},i,{value:void 0}),a=[];break;case"textarea":r=ie(e,r),i=ie(e,i),a=[];break;default:"function"!==typeof r.onClick&&"function"===typeof i.onClick&&(e.onclick=Zi)}for(u in ye(n,i),n=null,r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var l=r[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in i){var c=i[u];if(l=null!=r?r[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(a||(a=[]),a.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&zi("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},Lo=function(e,t,n,i){n!==i&&(t.flags|=4)};var Jo=!1,$o=!1,Qo="function"===typeof WeakSet?WeakSet:Set,Zo=null;function el(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){Mc(e,t,i)}else n.current=null}function tl(e,t,n){try{n()}catch(i){Mc(e,t,i)}}var nl=!1;function il(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&tl(t,n,s)}r=r.next}while(r!==i)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function sl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[dr],delete t[pr],delete t[mr],delete t[gr],delete t[vr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zi));else if(4!==i&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}function ul(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}var hl=null,dl=!1;function pl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(rt,n)}catch(o){}switch(n.tag){case 5:$o||el(n,t);case 6:var i=hl,r=dl;hl=null,pl(e,t,n),dl=r,null!==(hl=i)&&(dl?(e=hl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):hl.removeChild(n.stateNode));break;case 18:null!==hl&&(dl?(e=hl,n=n.stateNode,8===e.nodeType?lr(e.parentNode,n):1===e.nodeType&&lr(e,n),jt(e)):lr(hl,n.stateNode));break;case 4:i=hl,r=dl,hl=n.stateNode.containerInfo,dl=!0,pl(e,t,n),hl=i,dl=r;break;case 0:case 11:case 14:case 15:if(!$o&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var s=r,a=s.destroy;s=s.tag,void 0!==a&&(0!==(2&s)||0!==(4&s))&&tl(n,t,a),r=r.next}while(r!==i)}pl(e,t,n);break;case 1:if(!$o&&(el(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(o){Mc(n,t,o)}pl(e,t,n);break;case 21:pl(e,t,n);break;case 22:1&n.mode?($o=(i=$o)||null!==n.memoizedState,pl(e,t,n),$o=i):pl(e,t,n);break;default:pl(e,t,n)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Qo),t.forEach((function(t){var i=Cc.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}function gl(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var a=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:hl=l.stateNode,dl=!1;break e;case 3:case 4:hl=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===hl)throw Error(s(160));fl(a,o,r),hl=null,dl=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(u){Mc(r,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vl(t,e),t=t.sibling}function vl(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gl(t,e),yl(e),4&i){try{il(3,e,e.return),rl(3,e)}catch(g){Mc(e,e.return,g)}try{il(5,e,e.return)}catch(g){Mc(e,e.return,g)}}break;case 1:gl(t,e),yl(e),512&i&&null!==n&&el(n,n.return);break;case 5:if(gl(t,e),yl(e),512&i&&null!==n&&el(n,n.return),32&e.flags){var r=e.stateNode;try{de(r,"")}catch(g){Mc(e,e.return,g)}}if(4&i&&null!=(r=e.stateNode)){var a=e.memoizedProps,o=null!==n?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&$(r,a),_e(l,o);var u=_e(l,a);for(o=0;o<c.length;o+=2){var h=c[o],d=c[o+1];"style"===h?ge(r,d):"dangerouslySetInnerHTML"===h?he(r,d):"children"===h?de(r,d):_(r,h,d,u)}switch(l){case"input":Q(r,a);break;case"textarea":se(r,a);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!a.multiple;var f=a.value;null!=f?ne(r,!!a.multiple,f,!1):p!==!!a.multiple&&(null!=a.defaultValue?ne(r,!!a.multiple,a.defaultValue,!0):ne(r,!!a.multiple,a.multiple?[]:"",!1))}r[pr]=a}catch(g){Mc(e,e.return,g)}}break;case 6:if(gl(t,e),yl(e),4&i){if(null===e.stateNode)throw Error(s(162));r=e.stateNode,a=e.memoizedProps;try{r.nodeValue=a}catch(g){Mc(e,e.return,g)}}break;case 3:if(gl(t,e),yl(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{jt(t.containerInfo)}catch(g){Mc(e,e.return,g)}break;case 4:default:gl(t,e),yl(e);break;case 13:gl(t,e),yl(e),8192&(r=e.child).flags&&(a=null!==r.memoizedState,r.stateNode.isHidden=a,!a||null!==r.alternate&&null!==r.alternate.memoizedState||(jl=$e())),4&i&&ml(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?($o=(u=$o)||h,gl(t,e),$o=u):gl(t,e),yl(e),8192&i){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Zo=e,h=e.child;null!==h;){for(d=Zo=h;null!==Zo;){switch(f=(p=Zo).child,p.tag){case 0:case 11:case 14:case 15:il(4,p,p.return);break;case 1:el(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){i=p,n=p.return;try{t=i,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Mc(i,n,g)}}break;case 5:el(p,p.return);break;case 22:if(null!==p.memoizedState){bl(d);continue}}null!==f?(f.return=p,Zo=f):bl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{r=d.stateNode,u?"function"===typeof(a=r.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=d.stateNode,o=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",o))}catch(g){Mc(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Mc(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:gl(t,e),yl(e),4&i&&ml(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var i=n;break e}n=n.return}throw Error(s(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(de(r,""),i.flags&=-33),ul(e,ll(e),r);break;case 3:case 4:var a=i.stateNode.containerInfo;cl(e,ll(e),a);break;default:throw Error(s(161))}}catch(o){Mc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function _l(e,t,n){Zo=e,wl(e,t,n)}function wl(e,t,n){for(var i=0!==(1&e.mode);null!==Zo;){var r=Zo,s=r.child;if(22===r.tag&&i){var a=null!==r.memoizedState||Jo;if(!a){var o=r.alternate,l=null!==o&&null!==o.memoizedState||$o;o=Jo;var c=$o;if(Jo=a,($o=l)&&!c)for(Zo=r;null!==Zo;)l=(a=Zo).child,22===a.tag&&null!==a.memoizedState?Sl(r):null!==l?(l.return=a,Zo=l):Sl(r);for(;null!==s;)Zo=s,wl(s,t,n),s=s.sibling;Zo=r,Jo=o,$o=c}xl(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,Zo=s):xl(e)}}function xl(e){for(;null!==Zo;){var t=Zo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:$o||rl(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!$o)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:gs(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Us(t,a,i);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Us(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&jt(d)}}}break;default:throw Error(s(163))}$o||512&t.flags&&sl(t)}catch(p){Mc(t,t.return,p)}}if(t===e){Zo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Zo=n;break}Zo=t.return}}function bl(e){for(;null!==Zo;){var t=Zo;if(t===e){Zo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Zo=n;break}Zo=t.return}}function Sl(e){for(;null!==Zo;){var t=Zo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Mc(t,n,l)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(l){Mc(t,r,l)}}var s=t.return;try{sl(t)}catch(l){Mc(t,s,l)}break;case 5:var a=t.return;try{sl(t)}catch(l){Mc(t,a,l)}}}catch(l){Mc(t,t.return,l)}if(t===e){Zo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Zo=o;break}Zo=t.return}}var Nl,Ml=Math.ceil,Tl=w.ReactCurrentDispatcher,Al=w.ReactCurrentOwner,El=w.ReactCurrentBatchConfig,Cl=0,Il=null,Rl=null,Pl=0,Dl=0,kl=Nr(0),Ll=0,Ol=null,Bl=0,Ul=0,zl=0,Vl=null,Fl=null,jl=0,Hl=1/0,Gl=null,Wl=!1,Yl=null,ql=null,Xl=!1,Kl=null,Jl=0,$l=0,Ql=null,Zl=-1,ec=0;function tc(){return 0!==(6&Cl)?$e():-1!==Zl?Zl:Zl=$e()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Cl)&&0!==Pl?Pl&-Pl:null!==ms.transition?(0===ec&&(ec=mt()),ec):0!==(e=_t)?e:e=void 0===(e=window.event)?16:Jt(e.type)}function ic(e,t,n,i){if(50<$l)throw $l=0,Ql=null,Error(s(185));vt(e,n,i),0!==(2&Cl)&&e===Il||(e===Il&&(0===(2&Cl)&&(Ul|=n),4===Ll&&lc(e,Pl)),rc(e,i),1===n&&0===Cl&&0===(1&t.mode)&&(Hl=$e()+500,zr&&jr()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-at(s),o=1<<a,l=r[a];-1===l?0!==(o&n)&&0===(o&i)||(r[a]=pt(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}(e,t);var i=dt(e,e===Il?Pl:0);if(0===i)null!==n&&Xe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Xe(n),1===t)0===e.tag?function(e){zr=!0,Fr(e)}(cc.bind(null,e)):Fr(cc.bind(null,e)),ar((function(){0===(6&Cl)&&jr()})),n=null;else{switch(wt(i)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=it}n=Ic(n,sc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function sc(e,t){if(Zl=-1,ec=0,0!==(6&Cl))throw Error(s(327));var n=e.callbackNode;if(Sc()&&e.callbackNode!==n)return null;var i=dt(e,e===Il?Pl:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=vc(e,i);else{t=i;var r=Cl;Cl|=2;var a=mc();for(Il===e&&Pl===t||(Gl=null,Hl=$e()+500,pc(e,t));;)try{_c();break}catch(l){fc(e,l)}xs(),Tl.current=a,Cl=r,null!==Rl?t=0:(Il=null,Pl=0,t=Ll)}if(0!==t){if(2===t&&(0!==(r=ft(e))&&(i=r,t=ac(e,r))),1===t)throw n=Ol,pc(e,0),lc(e,i),rc(e,$e()),n;if(6===t)lc(e,i);else{if(r=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!oi(s(),r))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=vc(e,i))&&(0!==(a=ft(e))&&(i=a,t=ac(e,a))),1===t))throw n=Ol,pc(e,0),lc(e,i),rc(e,$e()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(s(345));case 2:case 5:bc(e,Fl,Gl);break;case 3:if(lc(e,i),(130023424&i)===i&&10<(t=jl+500-$e())){if(0!==dt(e,0))break;if(((r=e.suspendedLanes)&i)!==i){tc(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=ir(bc.bind(null,e,Fl,Gl),t);break}bc(e,Fl,Gl);break;case 4:if(lc(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var o=31-at(i);a=1<<o,(o=t[o])>r&&(r=o),i&=~a}if(i=r,10<(i=(120>(i=$e()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Ml(i/1960))-i)){e.timeoutHandle=ir(bc.bind(null,e,Fl,Gl),i);break}bc(e,Fl,Gl);break;default:throw Error(s(329))}}}return rc(e,$e()),e.callbackNode===n?sc.bind(null,e):null}function ac(e,t){var n=Vl;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=vc(e,t))&&(t=Fl,Fl=n,null!==t&&oc(t)),e}function oc(e){null===Fl?Fl=e:Fl.push.apply(Fl,e)}function lc(e,t){for(t&=~zl,t&=~Ul,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),i=1<<n;e[n]=-1,t&=~i}}function cc(e){if(0!==(6&Cl))throw Error(s(327));Sc();var t=dt(e,0);if(0===(1&t))return rc(e,$e()),null;var n=vc(e,t);if(0!==e.tag&&2===n){var i=ft(e);0!==i&&(t=i,n=ac(e,i))}if(1===n)throw n=Ol,pc(e,0),lc(e,t),rc(e,$e()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bc(e,Fl,Gl),rc(e,$e()),null}function uc(e,t){var n=Cl;Cl|=1;try{return e(t)}finally{0===(Cl=n)&&(Hl=$e()+500,zr&&jr())}}function hc(e){null!==Kl&&0===Kl.tag&&0===(6&Cl)&&Sc();var t=Cl;Cl|=1;var n=El.transition,i=_t;try{if(El.transition=null,_t=1,e)return e()}finally{_t=i,El.transition=n,0===(6&(Cl=t))&&jr()}}function dc(){Dl=kl.current,Mr(kl)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,rr(n)),null!==Rl)for(n=Rl.return;null!==n;){var i=n;switch(ts(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Dr();break;case 3:ra(),Mr(Cr),Mr(Er),ua();break;case 5:aa(i);break;case 4:ra();break;case 13:case 19:Mr(oa);break;case 10:bs(i.type._context);break;case 22:case 23:dc()}n=n.return}if(Il=e,Rl=e=kc(e.current,null),Pl=Dl=t,Ll=0,Ol=null,zl=Ul=Bl=0,Fl=Vl=null,null!==Ts){for(t=0;t<Ts.length;t++)if(null!==(i=(n=Ts[t]).interleaved)){n.interleaved=null;var r=i.next,s=n.pending;if(null!==s){var a=s.next;s.next=r,i.next=a}n.pending=i}Ts=null}return e}function fc(e,t){for(;;){var n=Rl;try{if(xs(),ha.current=so,va){for(var i=fa.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}va=!1}if(pa=0,ga=ma=fa=null,ya=!1,_a=0,Al.current=null,null===n||null===n.return){Ll=1,Ol=t,Rl=null;break}e:{var a=e,o=n.return,l=n,c=t;if(t=Pl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=vo(o);if(null!==f){f.flags&=-257,yo(f,o,l,0,t),1&f.mode&&go(a,u,t),c=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){go(a,u,t),gc();break e}c=Error(s(426))}else if(rs&&1&l.mode){var v=vo(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),yo(v,o,l,0,t),fs(co(c,l));break e}}a=c=co(c,l),4!==Ll&&(Ll=2),null===Vl?Vl=[a]:Vl.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Os(a,fo(0,c,t));break e;case 1:l=c;var y=a.type,_=a.stateNode;if(0===(128&a.flags)&&("function"===typeof y.getDerivedStateFromError||null!==_&&"function"===typeof _.componentDidCatch&&(null===ql||!ql.has(_)))){a.flags|=65536,t&=-t,a.lanes|=t,Os(a,mo(a,l,t));break e}}a=a.return}while(null!==a)}xc(n)}catch(w){t=w,Rl===n&&null!==n&&(Rl=n=n.return);continue}break}}function mc(){var e=Tl.current;return Tl.current=so,null===e?so:e}function gc(){0!==Ll&&3!==Ll&&2!==Ll||(Ll=4),null===Il||0===(268435455&Bl)&&0===(268435455&Ul)||lc(Il,Pl)}function vc(e,t){var n=Cl;Cl|=2;var i=mc();for(Il===e&&Pl===t||(Gl=null,pc(e,t));;)try{yc();break}catch(r){fc(e,r)}if(xs(),Cl=n,Tl.current=i,null!==Rl)throw Error(s(261));return Il=null,Pl=0,Ll}function yc(){for(;null!==Rl;)wc(Rl)}function _c(){for(;null!==Rl&&!Ke();)wc(Rl)}function wc(e){var t=Nl(e.alternate,e,Dl);e.memoizedProps=e.pendingProps,null===t?xc(e):Rl=t,Al.current=null}function xc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Xo(n,t,Dl)))return void(Rl=n)}else{if(null!==(n=Ko(n,t)))return n.flags&=32767,void(Rl=n);if(null===e)return Ll=6,void(Rl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Rl=t);Rl=t=e}while(null!==t);0===Ll&&(Ll=5)}function bc(e,t,n){var i=_t,r=El.transition;try{El.transition=null,_t=1,function(e,t,n,i){do{Sc()}while(null!==Kl);if(0!==(6&Cl))throw Error(s(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-at(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}(e,a),e===Il&&(Rl=Il=null,Pl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Xl||(Xl=!0,Ic(tt,(function(){return Sc(),null}))),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=El.transition,El.transition=null;var o=_t;_t=1;var l=Cl;Cl|=4,Al.current=null,function(e,t){if(er=Gt,pi(e=di())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,a=i.focusNode;i=i.focusOffset;try{n.nodeType,a.nodeType}catch(x){n=null;break e}var o=0,l=-1,c=-1,u=0,h=0,d=e,p=null;t:for(;;){for(var f;d!==n||0!==r&&3!==d.nodeType||(l=o+r),d!==a||0!==i&&3!==d.nodeType||(c=o+i),3===d.nodeType&&(o+=d.nodeValue.length),null!==(f=d.firstChild);)p=d,d=f;for(;;){if(d===e)break t;if(p===n&&++u===r&&(l=o),p===a&&++h===i&&(c=o),null!==(f=d.nextSibling))break;p=(d=p).parentNode}d=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(tr={focusedElem:e,selectionRange:n},Gt=!1,Zo=t;null!==Zo;)if(e=(t=Zo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Zo=e;else for(;null!==Zo;){t=Zo;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,_=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:gs(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(s(163))}}catch(x){Mc(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,Zo=e;break}Zo=t.return}m=nl,nl=!1}(e,n),vl(n,e),fi(tr),Gt=!!er,tr=er=null,e.current=n,_l(n,e,r),Je(),Cl=l,_t=o,El.transition=a}else e.current=n;if(Xl&&(Xl=!1,Kl=e,Jl=r),a=e.pendingLanes,0===a&&(ql=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,$e()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Wl)throw Wl=!1,e=Yl,Yl=null,e;0!==(1&Jl)&&0!==e.tag&&Sc(),a=e.pendingLanes,0!==(1&a)?e===Ql?$l++:($l=0,Ql=e):$l=0,jr()}(e,t,n,i)}finally{El.transition=r,_t=i}return null}function Sc(){if(null!==Kl){var e=wt(Jl),t=El.transition,n=_t;try{if(El.transition=null,_t=16>e?16:e,null===Kl)var i=!1;else{if(e=Kl,Kl=null,Jl=0,0!==(6&Cl))throw Error(s(331));var r=Cl;for(Cl|=4,Zo=e.current;null!==Zo;){var a=Zo,o=a.child;if(0!==(16&Zo.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Zo=u;null!==Zo;){var h=Zo;switch(h.tag){case 0:case 11:case 15:il(8,h,a)}var d=h.child;if(null!==d)d.return=h,Zo=d;else for(;null!==Zo;){var p=(h=Zo).sibling,f=h.return;if(al(h),h===u){Zo=null;break}if(null!==p){p.return=f,Zo=p;break}Zo=f}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Zo=a}}if(0!==(2064&a.subtreeFlags)&&null!==o)o.return=a,Zo=o;else e:for(;null!==Zo;){if(0!==(2048&(a=Zo).flags))switch(a.tag){case 0:case 11:case 15:il(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,Zo=y;break e}Zo=a.return}}var _=e.current;for(Zo=_;null!==Zo;){var w=(o=Zo).child;if(0!==(2064&o.subtreeFlags)&&null!==w)w.return=o,Zo=w;else e:for(o=_;null!==Zo;){if(0!==(2048&(l=Zo).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(b){Mc(l,l.return,b)}if(l===o){Zo=null;break e}var x=l.sibling;if(null!==x){x.return=l.return,Zo=x;break e}Zo=l.return}}if(Cl=r,jr(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(rt,e)}catch(b){}i=!0}return i}finally{_t=n,El.transition=t}}return!1}function Nc(e,t,n){e=ks(e,t=fo(0,t=co(n,t),1),1),t=tc(),null!==e&&(vt(e,1,t),rc(e,t))}function Mc(e,t,n){if(3===e.tag)Nc(e,e,n);else for(;null!==t;){if(3===t.tag){Nc(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===ql||!ql.has(i))){t=ks(t,e=mo(t,e=co(n,e),1),1),e=tc(),null!==t&&(vt(t,1,e),rc(t,e));break}}t=t.return}}function Tc(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Il===e&&(Pl&n)===n&&(4===Ll||3===Ll&&(130023424&Pl)===Pl&&500>$e()-jl?pc(e,0):zl|=n),rc(e,t)}function Ac(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=tc();null!==(e=Cs(e,t))&&(vt(e,t,n),rc(e,n))}function Ec(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ac(e,n)}function Cc(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(s(314))}null!==i&&i.delete(t),Ac(e,n)}function Ic(e,t){return qe(e,t)}function Rc(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pc(e,t,n,i){return new Rc(e,t,n,i)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function kc(e,t){var n=e.alternate;return null===n?((n=Pc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Lc(e,t,n,i,r,a){var o=2;if(i=e,"function"===typeof e)Dc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case S:return Oc(n.children,r,a,t);case N:o=8,r|=8;break;case M:return(e=Pc(12,n,t,2|r)).elementType=M,e.lanes=a,e;case C:return(e=Pc(13,n,t,r)).elementType=C,e.lanes=a,e;case I:return(e=Pc(19,n,t,r)).elementType=I,e.lanes=a,e;case D:return Bc(n,r,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:o=10;break e;case A:o=9;break e;case E:o=11;break e;case R:o=14;break e;case P:o=16,i=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Pc(o,n,t,r)).elementType=e,t.type=i,t.lanes=a,t}function Oc(e,t,n,i){return(e=Pc(7,e,i,t)).lanes=n,e}function Bc(e,t,n,i){return(e=Pc(22,e,i,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Uc(e,t,n){return(e=Pc(6,e,null,t)).lanes=n,e}function zc(e,t,n){return(t=Pc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Vc(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Fc(e,t,n,i,r,s,a,o,l){return e=new Vc(e,t,n,o,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Pc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Rs(s),e}function jc(e){if(!e)return Ar;e:{if(je(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Pr(n))return Lr(e,n,t)}return t}function Hc(e,t,n,i,r,s,a,o,l){return(e=Fc(n,i,!0,e,0,s,0,o,l)).context=jc(null),n=e.current,(s=Ds(i=tc(),r=nc(n))).callback=void 0!==t&&null!==t?t:null,ks(n,s,r),e.current.lanes=r,vt(e,r,i),rc(e,i),e}function Gc(e,t,n,i){var r=t.current,s=tc(),a=nc(r);return n=jc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ds(s,a)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=ks(r,t,a))&&(ic(e,r,a,s),Ls(e,r,a)),a}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Yc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function qc(e,t){Yc(e,t),(e=e.alternate)&&Yc(e,t)}Nl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Cr.current)wo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return wo=!1,function(e,t,n){switch(t.tag){case 3:Io(t),ps();break;case 5:sa(t);break;case 1:Pr(t.type)&&Or(t);break;case 4:ia(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;Tr(vs,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(Tr(oa,1&oa.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Uo(e,t,n):(Tr(oa,1&oa.current),null!==(e=Wo(e,t,n))?e.sibling:null);Tr(oa,1&oa.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return Ho(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Tr(oa,oa.current),i)break;return null;case 22:case 23:return t.lanes=0,Mo(e,t,n)}return Wo(e,t,n)}(e,t,n);wo=0!==(131072&e.flags)}else wo=!1,rs&&0!==(1048576&t.flags)&&Zr(t,Yr,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Go(e,t),e=t.pendingProps;var r=Rr(t,Er.current);Ns(t,n),r=Sa(null,t,i,e,r,n);var a=Na();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pr(i)?(a=!0,Or(t)):a=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Rs(t),r.updater=Fs,t.stateNode=r,r._reactInternals=t,Ws(t,i,e,n),t=Co(null,t,i,!0,a,n)):(t.tag=0,rs&&a&&es(t),xo(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(Go(e,t),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===R)return 14}return 2}(i),e=gs(i,e),r){case 0:t=Ao(null,t,i,e,n);break e;case 1:t=Eo(null,t,i,e,n);break e;case 11:t=bo(null,t,i,e,n);break e;case 14:t=So(null,t,i,gs(i.type,e),n);break e}throw Error(s(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,Ao(e,t,i,r=t.elementType===i?r:gs(i,r),n);case 1:return i=t.type,r=t.pendingProps,Eo(e,t,i,r=t.elementType===i?r:gs(i,r),n);case 3:e:{if(Io(t),null===e)throw Error(s(387));i=t.pendingProps,r=(a=t.memoizedState).element,Ps(e,t),Bs(t,i,null,n);var o=t.memoizedState;if(i=o.element,a.isDehydrated){if(a={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Ro(e,t,i,n,r=co(Error(s(423)),t));break e}if(i!==r){t=Ro(e,t,i,n,r=co(Error(s(424)),t));break e}for(is=cr(t.stateNode.containerInfo.firstChild),ns=t,rs=!0,ss=null,n=$s(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ps(),i===r){t=Wo(e,t,n);break e}xo(e,t,i,n)}t=t.child}return t;case 5:return sa(t),null===e&&cs(t),i=t.type,r=t.pendingProps,a=null!==e?e.memoizedProps:null,o=r.children,nr(i,r)?o=null:null!==a&&nr(i,a)&&(t.flags|=32),To(e,t),xo(e,t,o,n),t.child;case 6:return null===e&&cs(t),null;case 13:return Uo(e,t,n);case 4:return ia(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=Js(t,null,i,n):xo(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,bo(e,t,i,r=t.elementType===i?r:gs(i,r),n);case 7:return xo(e,t,t.pendingProps,n),t.child;case 8:case 12:return xo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,a=t.memoizedProps,o=r.value,Tr(vs,i._currentValue),i._currentValue=o,null!==a)if(oi(a.value,o)){if(a.children===r.children&&!Cr.current){t=Wo(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===a.tag){(c=Ds(-1,n&-n)).tag=2;var u=a.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),Ss(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===a.tag)o=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(s(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Ss(o,n,t),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===t){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}xo(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Ns(t,n),i=i(r=Ms(r)),t.flags|=1,xo(e,t,i,n),t.child;case 14:return r=gs(i=t.type,t.pendingProps),So(e,t,i,r=gs(i.type,r),n);case 15:return No(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:gs(i,r),Go(e,t),t.tag=1,Pr(i)?(e=!0,Or(t)):e=!1,Ns(t,n),Hs(t,i,r),Ws(t,i,r,n),Co(null,t,i,!0,e,n);case 19:return Ho(e,t,n);case 22:return Mo(e,t,n)}throw Error(s(156,t.tag))};var Xc="function"===typeof reportError?reportError:function(e){console.error(e)};function Kc(e){this._internalRoot=e}function Jc(e){this._internalRoot=e}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function eu(e,t,n,i,r){var s=n._reactRootContainer;if(s){var a=s;if("function"===typeof r){var o=r;r=function(){var e=Wc(a);o.call(e)}}Gc(t,a,e,r)}else a=function(e,t,n,i,r){if(r){if("function"===typeof i){var s=i;i=function(){var e=Wc(a);s.call(e)}}var a=Hc(t,i,e,0,null,!1,0,"",Zc);return e._reactRootContainer=a,e[fr]=a.current,ji(8===e.nodeType?e.parentNode:e),hc(),a}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof i){var o=i;i=function(){var e=Wc(l);o.call(e)}}var l=Fc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[fr]=l.current,ji(8===e.nodeType?e.parentNode:e),hc((function(){Gc(t,l,n,i)})),l}(n,t,e,r,i);return Wc(a)}Jc.prototype.render=Kc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Gc(e,t,null,null)},Jc.prototype.unmount=Kc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;hc((function(){Gc(null,e,null,null)})),t[fr]=null}},Jc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Nt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Bt(e)}},xt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(yt(t,1|n),rc(t,$e()),0===(6&Cl)&&(Hl=$e()+500,jr()))}break;case 13:hc((function(){var t=Cs(e,1);if(null!==t){var n=tc();ic(t,e,1,n)}})),qc(e,1)}},bt=function(e){if(13===e.tag){var t=Cs(e,134217728);if(null!==t)ic(t,e,134217728,tc());qc(e,134217728)}},St=function(e){if(13===e.tag){var t=nc(e),n=Cs(e,t);if(null!==n)ic(n,e,t,tc());qc(e,t)}},Nt=function(){return _t},Mt=function(e,t){var n=_t;try{return _t=e,t()}finally{_t=n}},be=function(e,t,n){switch(t){case"input":if(Q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=xr(i);if(!r)throw Error(s(90));q(i),Q(i,r)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ee=uc,Ce=hc;var tu={usingClientEntryPoint:!1,Events:[_r,wr,xr,Te,Ae,uc]},nu={findFiberByHostInstance:yr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},iu={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{rt=ru.inject(iu),st=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!$c(t))throw Error(s(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:b,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!$c(e))throw Error(s(299));var n=!1,i="",r=Xc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Fc(e,1,!1,null,0,n,0,i,r),e[fr]=t.current,ji(8===e.nodeType?e.parentNode:e),new Kc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return hc(e)},t.hydrate=function(e,t,n){if(!Qc(t))throw Error(s(200));return eu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!$c(e))throw Error(s(405));var i=null!=n&&n.hydratedSources||null,r=!1,a="",o=Xc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Hc(t,null,e,1,null!=n?n:null,r,0,a,o),e[fr]=t.current,ji(e),i)for(e=0;e<i.length;e++)r=(r=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Jc(t)},t.render=function(e,t,n){if(!Qc(t))throw Error(s(200));return eu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Qc(e))throw Error(s(40));return!!e._reactRootContainer&&(hc((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[fr]=null}))})),!0)},t.unstable_batchedUpdates=uc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Qc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return eu(e,t,n,!1,i)},t.version="18.2.0-next-9e3b772b8-20220608"},391:(e,t,n)=>{"use strict";var i=n(950);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},323:(e,t,n)=>{"use strict";function i(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var r=n(688),s=i(n(43)),a=n(321);n(173),n(620);var o=i(n(213));function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function c(e,t){e.prototype=Object.create(t.prototype),u(e.prototype.constructor=e,t)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t){if(null==e)return{};var n,i,r={},s=Object.keys(e);for(i=0;i<s.length;i++)n=s[i],0<=t.indexOf(n)||(r[n]=e[n]);return r}var d=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).history=a.createBrowserHistory(t.props),t}return c(t,e),t.prototype.render=function(){return s.createElement(r.Router,{history:this.history,children:this.props.children})},t}(s.Component),p=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).history=a.createHashHistory(t.props),t}return c(t,e),t.prototype.render=function(){return s.createElement(r.Router,{history:this.history,children:this.props.children})},t}(s.Component),f=function(e,t){return"function"==typeof e?e(t):e},m=function(e,t){return"string"==typeof e?a.createLocation(e,null,null,t):e},g=function(e){return e},v=s.forwardRef;void 0===v&&(v=g);var y=v((function(e,t){var n=e.innerRef,i=e.navigate,r=e.onClick,a=h(e,["innerRef","navigate","onClick"]),o=a.target,c=l({},a,{onClick:function(t){try{r&&r(t)}catch(e){throw t.preventDefault(),e}t.defaultPrevented||0!==t.button||o&&"_self"!==o||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(t)||(t.preventDefault(),i())}});return c.ref=g!==v&&t||n,s.createElement("a",c)})),_=v((function(e,t){var n=e.component,i=void 0===n?y:n,c=e.replace,u=e.to,d=e.innerRef,p=h(e,["component","replace","to","innerRef"]);return s.createElement(r.__RouterContext.Consumer,null,(function(e){e||o(!1);var n=e.history,r=m(f(u,e.location),e.location),h=r?n.createHref(r):"",y=l({},p,{href:h,navigate:function(){var t=f(u,e.location),i=a.createPath(e.location)===a.createPath(m(t));(c||i?n.replace:n.push)(t)}});return g!==v?y.ref=t||d:y.innerRef=d,s.createElement(i,y)}))})),w=function(e){return e},x=s.forwardRef;void 0===x&&(x=w);var b=x((function(e,t){var n=e["aria-current"],i=void 0===n?"page":n,a=e.activeClassName,c=void 0===a?"active":a,u=e.activeStyle,d=e.className,p=e.exact,g=e.isActive,v=e.location,y=e.sensitive,b=e.strict,S=e.style,N=e.to,M=e.innerRef,T=h(e,["aria-current","activeClassName","activeStyle","className","exact","isActive","location","sensitive","strict","style","to","innerRef"]);return s.createElement(r.__RouterContext.Consumer,null,(function(e){e||o(!1);var n=v||e.location,a=m(f(N,n),n),h=a.pathname,A=h&&h.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),E=A?r.matchPath(n.pathname,{path:A,exact:p,sensitive:y,strict:b}):null,C=!!(g?g(E,n):E),I="function"==typeof d?d(C):d,R="function"==typeof S?S(C):S;C&&(I=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return e})).join(" ")}(I,c),R=l({},R,u));var P=l({"aria-current":C&&i||null,className:I,style:R,to:a},T);return w!==x?P.ref=t||M:P.innerRef=M,s.createElement(_,P)}))}));t.N_=_},688:(e,t,n)=>{"use strict";n.r(t),n.d(t,{MemoryRouter:()=>b,Prompt:()=>N,Redirect:()=>C,Route:()=>k,Router:()=>x,StaticRouter:()=>V,Switch:()=>F,__HistoryContext:()=>_,__RouterContext:()=>w,generatePath:()=>E,matchPath:()=>D,useHistory:()=>G,useLocation:()=>W,useParams:()=>Y,useRouteMatch:()=>q,withRouter:()=>j});var i=n(540),r=n(43),s=n(173),a=n.n(s),o=n(321),l=n(404),c=n(168),u=n(123),h=n.n(u),d=(n(681),n(587)),p=n(219),f=n.n(p),m=1073741823,g="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:{};var v=r.createContext||function(e,t){var n,s,o="__create-react-context-"+function(){var e="__global_unique_id__";return g[e]=(g[e]||0)+1}()+"__",l=function(e){function n(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).emitter=function(e){var t=[];return{on:function(e){t.push(e)},off:function(e){t=t.filter((function(t){return t!==e}))},get:function(){return e},set:function(n,i){e=n,t.forEach((function(t){return t(e,i)}))}}}(t.props.value),t}(0,i.A)(n,e);var r=n.prototype;return r.getChildContext=function(){var e;return(e={})[o]=this.emitter,e},r.componentWillReceiveProps=function(e){if(this.props.value!==e.value){var n,i=this.props.value,r=e.value;((s=i)===(a=r)?0!==s||1/s===1/a:s!==s&&a!==a)?n=0:(n="function"===typeof t?t(i,r):m,0!==(n|=0)&&this.emitter.set(e.value,n))}var s,a},r.render=function(){return this.props.children},n}(r.Component);l.childContextTypes=((n={})[o]=a().object.isRequired,n);var c=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))||this).observedBits=void 0,e.state={value:e.getValue()},e.onUpdate=function(t,n){0!==((0|e.observedBits)&n)&&e.setState({value:e.getValue()})},e}(0,i.A)(n,t);var r=n.prototype;return r.componentWillReceiveProps=function(e){var t=e.observedBits;this.observedBits=void 0===t||null===t?m:t},r.componentDidMount=function(){this.context[o]&&this.context[o].on(this.onUpdate);var e=this.props.observedBits;this.observedBits=void 0===e||null===e?m:e},r.componentWillUnmount=function(){this.context[o]&&this.context[o].off(this.onUpdate)},r.getValue=function(){return this.context[o]?this.context[o].get():e},r.render=function(){return(e=this.props.children,Array.isArray(e)?e[0]:e)(this.state.value);var e},n}(r.Component);return c.contextTypes=((s={})[o]=a().object,s),{Provider:l,Consumer:c}},y=function(e){var t=v();return t.displayName=e,t},_=y("Router-History"),w=y("Router"),x=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={location:t.history.location},n._isMounted=!1,n._pendingLocation=null,t.staticContext||(n.unlisten=t.history.listen((function(e){n._pendingLocation=e}))),n}(0,i.A)(t,e),t.computeRootMatch=function(e){return{path:"/",url:"/",params:{},isExact:"/"===e}};var n=t.prototype;return n.componentDidMount=function(){var e=this;this._isMounted=!0,this.unlisten&&this.unlisten(),this.props.staticContext||(this.unlisten=this.props.history.listen((function(t){e._isMounted&&e.setState({location:t})}))),this._pendingLocation&&this.setState({location:this._pendingLocation})},n.componentWillUnmount=function(){this.unlisten&&(this.unlisten(),this._isMounted=!1,this._pendingLocation=null)},n.render=function(){return r.createElement(w.Provider,{value:{history:this.props.history,location:this.state.location,match:t.computeRootMatch(this.state.location.pathname),staticContext:this.props.staticContext}},r.createElement(_.Provider,{children:this.props.children||null,value:this.props.history}))},t}(r.Component);var b=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).history=(0,o.createMemoryHistory)(t.props),t}return(0,i.A)(t,e),t.prototype.render=function(){return r.createElement(x,{history:this.history,children:this.props.children})},t}(r.Component);var S=function(e){function t(){return e.apply(this,arguments)||this}(0,i.A)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.onMount&&this.props.onMount.call(this,this)},n.componentDidUpdate=function(e){this.props.onUpdate&&this.props.onUpdate.call(this,this,e)},n.componentWillUnmount=function(){this.props.onUnmount&&this.props.onUnmount.call(this,this)},n.render=function(){return null},t}(r.Component);function N(e){var t=e.message,n=e.when,i=void 0===n||n;return r.createElement(w.Consumer,null,(function(e){if(e||(0,l.A)(!1),!i||e.staticContext)return null;var n=e.history.block;return r.createElement(S,{onMount:function(e){e.release=n(t)},onUpdate:function(e,i){i.message!==t&&(e.release(),e.release=n(t))},onUnmount:function(e){e.release()},message:t})}))}var M={},T=1e4,A=0;function E(e,t){return void 0===e&&(e="/"),void 0===t&&(t={}),"/"===e?e:function(e){if(M[e])return M[e];var t=h().compile(e);return A<T&&(M[e]=t,A++),t}(e)(t,{pretty:!0})}function C(e){var t=e.computedMatch,n=e.to,i=e.push,s=void 0!==i&&i;return r.createElement(w.Consumer,null,(function(e){e||(0,l.A)(!1);var i=e.history,a=e.staticContext,u=s?i.push:i.replace,h=(0,o.createLocation)(t?"string"===typeof n?E(n,t.params):(0,c.A)({},n,{pathname:E(n.pathname,t.params)}):n);return a?(u(h),null):r.createElement(S,{onMount:function(){u(h)},onUpdate:function(e,t){var n=(0,o.createLocation)(t.to);(0,o.locationsAreEqual)(n,(0,c.A)({},h,{key:n.key}))||u(h)},to:n})}))}var I={},R=1e4,P=0;function D(e,t){void 0===t&&(t={}),("string"===typeof t||Array.isArray(t))&&(t={path:t});var n=t,i=n.path,r=n.exact,s=void 0!==r&&r,a=n.strict,o=void 0!==a&&a,l=n.sensitive,c=void 0!==l&&l;return[].concat(i).reduce((function(t,n){if(!n&&""!==n)return null;if(t)return t;var i=function(e,t){var n=""+t.end+t.strict+t.sensitive,i=I[n]||(I[n]={});if(i[e])return i[e];var r=[],s={regexp:h()(e,r,t),keys:r};return P<R&&(i[e]=s,P++),s}(n,{end:s,strict:o,sensitive:c}),r=i.regexp,a=i.keys,l=r.exec(e);if(!l)return null;var u=l[0],d=l.slice(1),p=e===u;return s&&!p?null:{path:n,url:"/"===n&&""===u?"/":u,isExact:p,params:a.reduce((function(e,t,n){return e[t.name]=d[n],e}),{})}}),null)}var k=function(e){function t(){return e.apply(this,arguments)||this}return(0,i.A)(t,e),t.prototype.render=function(){var e=this;return r.createElement(w.Consumer,null,(function(t){t||(0,l.A)(!1);var n=e.props.location||t.location,i=e.props.computedMatch?e.props.computedMatch:e.props.path?D(n.pathname,e.props):t.match,s=(0,c.A)({},t,{location:n,match:i}),a=e.props,o=a.children,u=a.component,h=a.render;return Array.isArray(o)&&function(e){return 0===r.Children.count(e)}(o)&&(o=null),r.createElement(w.Provider,{value:s},s.match?o?"function"===typeof o?o(s):o:u?r.createElement(u,s):h?h(s):null:"function"===typeof o?o(s):null)}))},t}(r.Component);function L(e){return"/"===e.charAt(0)?e:"/"+e}function O(e,t){if(!e)return t;var n=L(e);return 0!==t.pathname.indexOf(n)?t:(0,c.A)({},t,{pathname:t.pathname.substr(n.length)})}function B(e){return"string"===typeof e?e:(0,o.createPath)(e)}function U(e){return function(){(0,l.A)(!1)}}function z(){}var V=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).handlePush=function(e){return t.navigateTo(e,"PUSH")},t.handleReplace=function(e){return t.navigateTo(e,"REPLACE")},t.handleListen=function(){return z},t.handleBlock=function(){return z},t}(0,i.A)(t,e);var n=t.prototype;return n.navigateTo=function(e,t){var n=this.props,i=n.basename,r=void 0===i?"":i,s=n.context,a=void 0===s?{}:s;a.action=t,a.location=function(e,t){return e?(0,c.A)({},t,{pathname:L(e)+t.pathname}):t}(r,(0,o.createLocation)(e)),a.url=B(a.location)},n.render=function(){var e=this.props,t=e.basename,n=void 0===t?"":t,i=e.context,s=void 0===i?{}:i,a=e.location,l=void 0===a?"/":a,u=(0,d.A)(e,["basename","context","location"]),h={createHref:function(e){return L(n+B(e))},action:"POP",location:O(n,(0,o.createLocation)(l)),push:this.handlePush,replace:this.handleReplace,go:U(),goBack:U(),goForward:U(),listen:this.handleListen,block:this.handleBlock};return r.createElement(x,(0,c.A)({},u,{history:h,staticContext:s}))},t}(r.Component);var F=function(e){function t(){return e.apply(this,arguments)||this}return(0,i.A)(t,e),t.prototype.render=function(){var e=this;return r.createElement(w.Consumer,null,(function(t){t||(0,l.A)(!1);var n,i,s=e.props.location||t.location;return r.Children.forEach(e.props.children,(function(e){if(null==i&&r.isValidElement(e)){n=e;var a=e.props.path||e.props.from;i=a?D(s.pathname,(0,c.A)({},e.props,{path:a})):t.match}})),i?r.cloneElement(n,{location:s,computedMatch:i}):null}))},t}(r.Component);function j(e){var t="withRouter("+(e.displayName||e.name)+")",n=function(t){var n=t.wrappedComponentRef,i=(0,d.A)(t,["wrappedComponentRef"]);return r.createElement(w.Consumer,null,(function(t){return t||(0,l.A)(!1),r.createElement(e,(0,c.A)({},i,t,{ref:n}))}))};return n.displayName=t,n.WrappedComponent=e,f()(n,e)}var H=r.useContext;function G(){return H(_)}function W(){return H(w).location}function Y(){var e=H(w).match;return e?e.params:{}}function q(e){var t=W(),n=H(w).match;return e?D(t.pathname,e):n}},5:(e,t)=>{"use strict";var n="function"===typeof Symbol&&Symbol.for,i=n?Symbol.for("react.element"):60103,r=n?Symbol.for("react.portal"):60106,s=n?Symbol.for("react.fragment"):60107,a=n?Symbol.for("react.strict_mode"):60108,o=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,u=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,d=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,f=n?Symbol.for("react.suspense_list"):60120,m=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,v=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,_=n?Symbol.for("react.responder"):60118,w=n?Symbol.for("react.scope"):60119;function x(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case i:switch(e=e.type){case u:case h:case s:case o:case a:case p:return e;default:switch(e=e&&e.$$typeof){case c:case d:case g:case m:case l:return e;default:return t}}case r:return t}}}function b(e){return x(e)===h}},681:(e,t,n)=>{"use strict";n(5)},153:(e,t,n)=>{"use strict";var i=n(43),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var i,s={},c=null,u=null;for(i in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,i)&&!l.hasOwnProperty(i)&&(s[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===s[i]&&(s[i]=t[i]);return{$$typeof:r,type:e,key:c,ref:u,props:s,_owner:o.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function y(){}function _(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=_.prototype=new y;w.constructor=_,m(w,v.prototype),w.isPureReactComponent=!0;var x=Array.isArray,b=Object.prototype.hasOwnProperty,S={current:null},N={key:!0,ref:!0,__self:!0,__source:!0};function M(e,t,i){var r,s={},a=null,o=null;if(null!=t)for(r in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(a=""+t.key),t)b.call(t,r)&&!N.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(1===l)s.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===s[r]&&(s[r]=l[r]);return{$$typeof:n,type:e,key:a,ref:o,props:s,_owner:S.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var A=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function C(e,t,r,s,a){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case i:l=!0}}if(l)return a=a(l=e),e=""===s?"."+E(l,0):s,x(a)?(r="",null!=e&&(r=e.replace(A,"$&/")+"/"),C(a,t,r,"",(function(e){return e}))):null!=a&&(T(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,r+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(A,"$&/")+"/")+e)),t.push(a)),1;if(l=0,s=""===s?".":s+":",x(e))for(var c=0;c<e.length;c++){var u=s+E(o=e[c],c);l+=C(o,t,r,u,a)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=C(o=o.value,t,r,u=s+E(o,c++),a);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function I(e,t,n){if(null==e)return e;var i=[],r=0;return C(e,i,"","",(function(e){return t.call(n,e,r++)})),i}function R(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},D={transition:null},k={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:D,ReactCurrentOwner:S};t.Children={map:I,forEach:function(e,t,n){I(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return I(e,(function(){t++})),t},toArray:function(e){return I(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=r,t.Profiler=a,t.PureComponent=_,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=k,t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=m({},e.props),s=e.key,a=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,o=S.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)b.call(t,c)&&!N.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=i;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:n,type:e.type,key:s,ref:a,props:r,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=M,t.createFactory=function(e){var t=M.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:R}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,n){return P.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,n){return P.current.useReducer(e,t,n)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return P.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return P.current.useTransition()},t.version="18.2.0"},43:(e,t,n)=>{"use strict";e.exports=n(202)},579:(e,t,n)=>{"use strict";e.exports=n(153)},234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<s(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,a=r>>>1;i<a;){var o=2*(i+1)-1,l=e[o],c=o+1,u=e[c];if(0>s(l,n))c<r&&0>s(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[o]=n,i=o);else{if(!(c<r&&0>s(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,d=null,p=3,f=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,_="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=i(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(c,t)}t=i(u)}}function x(e){if(g=!1,w(e),!m)if(null!==i(c))m=!0,D(b);else{var t=i(u);null!==t&&k(x,t.startTime-e)}}function b(e,n){m=!1,g&&(g=!1,y(T),T=-1),f=!0;var s=p;try{for(w(n),d=i(c);null!==d&&(!(d.expirationTime>n)||e&&!C());){var a=d.callback;if("function"===typeof a){d.callback=null,p=d.priorityLevel;var o=a(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?d.callback=o:d===i(c)&&r(c),w(n)}else r(c);d=i(c)}if(null!==d)var l=!0;else{var h=i(u);null!==h&&k(x,h.startTime-n),l=!1}return l}finally{d=null,p=s,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,N=!1,M=null,T=-1,A=5,E=-1;function C(){return!(t.unstable_now()-E<A)}function I(){if(null!==M){var e=t.unstable_now();E=e;var n=!0;try{n=M(!0,e)}finally{n?S():(N=!1,M=null)}}else N=!1}if("function"===typeof _)S=function(){_(I)};else if("undefined"!==typeof MessageChannel){var R=new MessageChannel,P=R.port2;R.port1.onmessage=I,S=function(){P.postMessage(null)}}else S=function(){v(I,0)};function D(e){M=e,N||(N=!0,S())}function k(e,n){T=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,D(b))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,s){var a=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?a+s:a:s=a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:r,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>a?(e.sortIndex=s,n(u,e),null===i(c)&&e===i(u)&&(g?(y(T),T=-1):g=!0,k(x,s-a))):(e.sortIndex=o,n(c,e),m||f||(m=!0,D(b))),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},853:(e,t,n)=>{"use strict";e.exports=n(234)},213:e=>{"use strict";var t="Invariant failed";e.exports=function(e,n){if(!e)throw new Error(t)}},620:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});const i=function(e,t){}},168:(e,t,n)=>{"use strict";function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},i.apply(this,arguments)}n.d(t,{A:()=>i})},540:(e,t,n)=>{"use strict";function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,i(e,t)}n.d(t,{A:()=>r})},587:(e,t,n)=>{"use strict";function i(e,t){if(null==e)return{};var n,i,r={},s=Object.keys(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}n.d(t,{A:()=>i})},404:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=!0,r="Invariant failed";function s(e,t){if(!e){if(i)throw new Error(r);var n="function"===typeof t?t():t,s=n?"".concat(r,": ").concat(n):r;throw new Error(s)}}}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{"use strict";var e=n(391),t=n(43),i=n(323),r=n(579);const s=e=>(0,r.jsxs)(i.N_,{to:e.lk,children:[(0,r.jsx)("i",{class:e.ic}),(0,r.jsx)("span",{children:e.sp})]});var a=n(688);const o=!1,l=!1,c="${JSCORE_VERSION}",u=function(e,t){if(!e)throw h(t)},h=function(e){return new Error("Firebase Database ("+c+") INTERNAL ASSERT FAILED: "+e)},d=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296===(64512&r)&&i+1<e.length&&56320===(64512&e.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++i)),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t},p={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<e.length;r+=3){const t=e[r],s=r+1<e.length,a=s?e[r+1]:0,o=r+2<e.length,l=o?e[r+2]:0,c=t>>2,u=(3&t)<<4|a>>4;let h=(15&a)<<2|l>>6,d=63&l;o||(d=64,s||(h=64)),i.push(n[c],n[u],n[h],n[d])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(d(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,i=0;for(;n<e.length;){const r=e[n++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=e[n++];t[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[i++]=String.fromCharCode(55296+(s>>10)),t[i++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],a=e[n++];t[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<e.length;){const t=n[e.charAt(r++)],s=r<e.length?n[e.charAt(r)]:0;++r;const a=r<e.length?n[e.charAt(r)]:64;++r;const o=r<e.length?n[e.charAt(r)]:64;if(++r,null==t||null==s||null==a||null==o)throw new f;const l=t<<2|s>>4;if(i.push(l),64!==a){const e=s<<4&240|a>>2;if(i.push(e),64!==o){const e=a<<6&192|o;i.push(e)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class f extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const m=function(e){const t=d(e);return p.encodeByteArray(t,!0)},g=function(e){return m(e).replace(/\./g,"")},v=function(e){try{return p.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function y(e){return _(void 0,e)}function _(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=_(e[n],t[n]));return e}const w=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,x=()=>{try{return w()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&v(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},b=e=>{var t,n;return null===(n=null===(t=x())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},S=()=>{var e;return null===(e=x())||void 0===e?void 0:e.config},N=e=>{var t;return null===(t=x())||void 0===t?void 0:t["_".concat(e)]};class M{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function T(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function A(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(T())}function E(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function C(){return!0===o||!0===l}class I extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,I.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,R.prototype.create)}}class R{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),i=this.errors[e],r=i?function(e,t){return e.replace(P,((e,n)=>{const i=t[n];return null!=i?String(i):"<".concat(n,"?>")}))}(i,t):"Error",s="".concat(this.serviceName,": ").concat(r," (").concat(n,").");return new I(n,s,t)}}const P=/\{\$([^}]+)}/g;function D(e){return JSON.parse(e)}function k(e){return JSON.stringify(e)}const L=function(e){let t={},n={},i={},r="";try{const s=e.split(".");t=D(v(s[0])||""),n=D(v(s[1])||""),r=s[2],i=n.d||{},delete n.d}catch(s){}return{header:t,claims:n,data:i,signature:r}};function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function B(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function U(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function z(e,t,n){const i={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=t.call(n,e[r],r,e));return i}function V(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const r of n){if(!i.includes(r))return!1;const n=e[r],s=t[r];if(F(n)&&F(s)){if(!V(n,s))return!1}else if(n!==s)return!1}for(const r of i)if(!n.includes(r))return!1;return!0}function F(e){return null!==e&&"object"===typeof e}function j(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function H(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,i]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(i)}})),t}function G(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class W{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"===typeof e)for(let u=0;u<16;u++)n[u]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let u=0;u<16;u++)n[u]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let u=16;u<80;u++){const e=n[u-3]^n[u-8]^n[u-14]^n[u-16];n[u]=4294967295&(e<<1|e>>>31)}let i,r,s=this.chain_[0],a=this.chain_[1],o=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(let u=0;u<80;u++){u<40?u<20?(i=l^a&(o^l),r=1518500249):(i=a^o^l,r=1859775393):u<60?(i=a&o|l&(a|o),r=2400959708):(i=a^o^l,r=3395469782);const e=(s<<5|s>>>27)+i+c+r+n[u]&4294967295;c=l,l=o,o=4294967295&(a<<30|a>>>2),a=s,s=e}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+a&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let i=0;const r=this.buf_;let s=this.inbuf_;for(;i<t;){if(0===s)for(;i<=n;)this.compress_(e,i),i+=this.blockSize;if("string"===typeof e){for(;i<t;)if(r[s]=e.charCodeAt(i),++s,++i,s===this.blockSize){this.compress_(r),s=0;break}}else for(;i<t;)if(r[s]=e[i],++s,++i,s===this.blockSize){this.compress_(r),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let i=0;i<5;i++)for(let t=24;t>=0;t-=8)e[n]=this.chain_[i]>>t&255,++n;return e}}class Y{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=q),void 0===i.error&&(i.error=q),void 0===i.complete&&(i.complete=q);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(e){}})),this.observers.push(i),r}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function q(){}function X(e,t){return"".concat(e," failed: ").concat(t," argument ")}const K=function(e){let t=0;for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);i<128?t++:i<2048?t+=2:i>=55296&&i<=56319?(t+=4,n++):t+=3}return t};function J(e){return e&&e._delegate?e._delegate:e}class ${constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Q="[DEFAULT]";class Z{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new M;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),i=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(i)return null;throw r}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Q})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:i});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[r,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(r)&&s.resolve(i)}return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(i){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:(r=t,r===Q?void 0:r),options:n}),this.instances.set(t,i),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch(s){}var r;return i||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q;return this.component?this.component.multipleInstances?e:Q:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class ee{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Z(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const te=[];var ne;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(ne||(ne={}));const ie={debug:ne.DEBUG,verbose:ne.VERBOSE,info:ne.INFO,warn:ne.WARN,error:ne.ERROR,silent:ne.SILENT},re=ne.INFO,se={[ne.DEBUG]:"log",[ne.VERBOSE]:"log",[ne.INFO]:"info",[ne.WARN]:"warn",[ne.ERROR]:"error"},ae=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),i=se[t];if(!i)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var r=arguments.length,s=new Array(r>2?r-2:0),a=2;a<r;a++)s[a-2]=arguments[a];console[i]("[".concat(n,"]  ").concat(e.name,":"),...s)};class oe{constructor(e){this.name=e,this._logLevel=re,this._logHandler=ae,this._userLogHandler=null,te.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ne))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?ie[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ne.DEBUG,...t),this._logHandler(this,ne.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ne.VERBOSE,...t),this._logHandler(this,ne.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ne.INFO,...t),this._logHandler(this,ne.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ne.WARN,...t),this._logHandler(this,ne.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ne.ERROR,...t),this._logHandler(this,ne.ERROR,...t)}}const le=(e,t)=>t.some((t=>e instanceof t));let ce,ue;const he=new WeakMap,de=new WeakMap,pe=new WeakMap,fe=new WeakMap,me=new WeakMap;let ge={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return de.get(e);if("objectStoreNames"===t)return e.objectStoreNames||pe.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return _e(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function ve(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(ue||(ue=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.apply(we(this),n),_e(he.get(this))}:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return _e(e.apply(we(this),n))}:function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];const s=e.call(we(this),t,...i);return pe.set(s,t.sort?t.sort():[t]),_e(s)}}function ye(e){return"function"===typeof e?ve(e):(e instanceof IDBTransaction&&function(e){if(de.has(e))return;const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",s),e.removeEventListener("abort",s)},r=()=>{t(),i()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",r),e.addEventListener("error",s),e.addEventListener("abort",s)}));de.set(e,t)}(e),le(e,ce||(ce=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,ge):e)}function _e(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("success",r),e.removeEventListener("error",s)},r=()=>{t(_e(e.result)),i()},s=()=>{n(e.error),i()};e.addEventListener("success",r),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&he.set(t,e)})).catch((()=>{})),me.set(t,e),t}(e);if(fe.has(e))return fe.get(e);const t=ye(e);return t!==e&&(fe.set(e,t),me.set(t,e)),t}const we=e=>me.get(e);const xe=["get","getKey","getAll","getAllKeys","count"],be=["put","add","delete","clear"],Se=new Map;function Ne(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(Se.get(t))return Se.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=be.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!xe.includes(n))return;const s=async function(e){const t=this.transaction(e,r?"readwrite":"readonly");let s=t.store;for(var a=arguments.length,o=new Array(a>1?a-1:0),l=1;l<a;l++)o[l-1]=arguments[l];return i&&(s=s.index(o.shift())),(await Promise.all([s[n](...o),r&&t.done]))[0]};return Se.set(t,s),s}ge=(e=>({...e,get:(t,n,i)=>Ne(t,n)||e.get(t,n,i),has:(t,n)=>!!Ne(t,n)||e.has(t,n)}))(ge);class Me{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((e=>e)).join(" ")}}const Te="@firebase/app",Ae="0.10.1",Ee=new oe("@firebase/app"),Ce="@firebase/app-compat",Ie="@firebase/analytics-compat",Re="@firebase/analytics",Pe="@firebase/app-check-compat",De="@firebase/app-check",ke="@firebase/auth",Le="@firebase/auth-compat",Oe="@firebase/database",Be="@firebase/database-compat",Ue="@firebase/functions",ze="@firebase/functions-compat",Ve="@firebase/installations",Fe="@firebase/installations-compat",je="@firebase/messaging",He="@firebase/messaging-compat",Ge="@firebase/performance",We="@firebase/performance-compat",Ye="@firebase/remote-config",qe="@firebase/remote-config-compat",Xe="@firebase/storage",Ke="@firebase/storage-compat",Je="@firebase/firestore",$e="@firebase/firestore-compat",Qe="firebase",Ze="[DEFAULT]",et={[Te]:"fire-core",[Ce]:"fire-core-compat",[Re]:"fire-analytics",[Ie]:"fire-analytics-compat",[De]:"fire-app-check",[Pe]:"fire-app-check-compat",[ke]:"fire-auth",[Le]:"fire-auth-compat",[Oe]:"fire-rtdb",[Be]:"fire-rtdb-compat",[Ue]:"fire-fn",[ze]:"fire-fn-compat",[Ve]:"fire-iid",[Fe]:"fire-iid-compat",[je]:"fire-fcm",[He]:"fire-fcm-compat",[Ge]:"fire-perf",[We]:"fire-perf-compat",[Ye]:"fire-rc",[qe]:"fire-rc-compat",[Xe]:"fire-gcs",[Ke]:"fire-gcs-compat",[Je]:"fire-fst",[$e]:"fire-fst-compat","fire-js":"fire-js",[Qe]:"fire-js-all"},tt=new Map,nt=new Map,it=new Map;function rt(e,t){try{e.container.addComponent(t)}catch(n){Ee.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function st(e){const t=e.name;if(it.has(t))return Ee.debug("There were multiple attempts to register component ".concat(t,".")),!1;it.set(t,e);for(const n of tt.values())rt(n,e);for(const n of nt.values())rt(n,e);return!0}function at(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function ot(e){return void 0!==e.settings}const lt=new R("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class ct{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new $("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw lt.create("app-deleted",{appName:this._name})}}const ut="10.11.0";function ht(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const i=Object.assign({name:Ze,automaticDataCollectionEnabled:!1},t),r=i.name;if("string"!==typeof r||!r)throw lt.create("bad-app-name",{appName:String(r)});if(n||(n=S()),!n)throw lt.create("no-options");const s=tt.get(r);if(s){if(V(n,s.options)&&V(i,s.config))return s;throw lt.create("duplicate-app",{appName:r})}const a=new ee(r);for(const l of it.values())a.addComponent(l);const o=new ct(n,i,a);return tt.set(r,o),o}function dt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ze;const t=tt.get(e);if(!t&&e===Ze&&S())return ht();if(!t)throw lt.create("no-app",{appName:e});return t}function pt(e,t,n){var i;let r=null!==(i=et[e])&&void 0!==i?i:e;n&&(r+="-".concat(n));const s=r.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const e=['Unable to register library "'.concat(r,'" with version "').concat(t,'":')];return s&&e.push('library name "'.concat(r,'" contains illegal characters (whitespace or "/")')),s&&a&&e.push("and"),a&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void Ee.warn(e.join(" "))}st(new $("".concat(r,"-version"),(()=>({library:r,version:t})),"VERSION"))}const ft="firebase-heartbeat-database",mt=1,gt="firebase-heartbeat-store";let vt=null;function yt(){return vt||(vt=function(e,t){let{blocked:n,upgrade:i,blocking:r,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=indexedDB.open(e,t),o=_e(a);return i&&a.addEventListener("upgradeneeded",(e=>{i(_e(a.result),e.oldVersion,e.newVersion,_e(a.transaction),e)})),n&&a.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),o.then((e=>{s&&e.addEventListener("close",(()=>s())),r&&e.addEventListener("versionchange",(e=>r(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),o}(ft,mt,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(gt)}catch(n){console.warn(n)}}}).catch((e=>{throw lt.create("idb-open",{originalErrorMessage:e.message})}))),vt}async function _t(e,t){try{const n=(await yt()).transaction(gt,"readwrite"),i=n.objectStore(gt);await i.put(t,wt(e)),await n.done}catch(n){if(n instanceof I)Ee.warn(n.message);else{const e=lt.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});Ee.warn(e.message)}}}function wt(e){return"".concat(e.name,"!").concat(e.options.appId)}class xt{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new St(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=bt();if((null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==i&&!this._heartbeatsCache.heartbeats.some((e=>e.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=bt(),{heartbeatsToSend:n,unsentEntries:i}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let i=e.slice();for(const r of e){const e=n.find((e=>e.agent===r.agent));if(e){if(e.dates.push(r.date),Nt(n)>t){e.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Nt(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),r=g(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function bt(){return(new Date).toISOString().substring(0,10)}class St{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!function(){try{return"object"===typeof indexedDB}catch(e){return!1}}()&&new Promise(((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var e;t((null===(e=r.error)||void 0===e?void 0:e.message)||"")}}catch(gs){t(gs)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await yt()).transaction(gt),n=await t.objectStore(gt).get(wt(e));return await t.done,n}catch(t){if(t instanceof I)Ee.warn(t.message);else{const e=lt.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});Ee.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return _t(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return _t(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Nt(e){return g(JSON.stringify({version:2,heartbeats:e})).length}var Mt;Mt="",st(new $("platform-logger",(e=>new Me(e)),"PRIVATE")),st(new $("heartbeat",(e=>new xt(e)),"PRIVATE")),pt(Te,Ae,Mt),pt(Te,Ae,"esm2017"),pt("fire-js","");function Tt(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function At(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Et=At,Ct=new R("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),It=new oe("@firebase/auth");function Rt(e){if(It.logLevel<=ne.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];It.error("Auth (".concat(ut,"): ").concat(e),...n)}}function Pt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];throw Ot(e,...n)}function Dt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Ot(e,...n)}function kt(e,t,n){const i=Object.assign(Object.assign({},Et()),{[t]:n});return new R("auth","Firebase",i).create(t,{appName:e.name})}function Lt(e){return kt(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ot(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if("string"!==typeof e){const t=n[0],i=[...n.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(t,...i)}return Ct.create(e,...n)}function Bt(e,t){if(!e){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];throw Ot(t,...i)}}function Ut(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Rt(t),new Error(t)}function zt(e,t){e||Ut(t)}function Vt(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Ft(){return"http:"===jt()||"https:"===jt()}function jt(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function Ht(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Ft()||function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class Gt{constructor(e,t){this.shortDelay=e,this.longDelay=t,zt(t>e,"Short delay should be less than long delay!"),this.isMobile=A()||E()}get(){return Ht()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Wt(e,t){zt(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class Yt{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void Ut("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void Ut("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void Ut("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const qt={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Xt=new Gt(3e4,6e4);function Kt(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Jt(e,t,n,i){return $t(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let r={},s={};i&&("GET"===t?s=i:r={body:JSON.stringify(i)});const a=j(Object.assign({key:e.config.apiKey},s)).slice(1),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode),Yt.fetch()(Zt(e,e.config.apiHost,n,a),Object.assign({method:t,headers:o,referrerPolicy:"no-referrer"},r))}))}async function $t(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},qt),t);try{const t=new tn(e),r=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw nn(e,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const t=r.ok?s.errorMessage:s.error.message,[n,a]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw nn(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw nn(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw nn(e,"user-disabled",s);const o=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(a)throw kt(e,o,a);Pt(e,o)}}catch(r){if(r instanceof I)throw r;Pt(e,"network-request-failed",{message:String(r)})}}async function Qt(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await Jt(e,t,n,i,r);return"mfaPendingCredential"in s&&Pt(e,"multi-factor-auth-required",{_serverResponse:s}),s}function Zt(e,t,n,i){const r="".concat(t).concat(n,"?").concat(i);return e.config.emulator?Wt(e.config,r):"".concat(e.config.apiScheme,"://").concat(r)}function en(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class tn{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(Dt(this.auth,"network-request-failed"))),Xt.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function nn(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=Dt(e,t,i);return r.customData._tokenResponse=n,r}function rn(e){return void 0!==e&&void 0!==e.enterprise}class sn{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return en(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function an(e,t){return Jt(e,"GET","/v2/recaptchaConfig",Kt(e,t))}async function on(e,t){return Jt(e,"POST","/v1/accounts:lookup",t)}function ln(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function cn(e){return 1e3*Number(e)}function un(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return Rt("JWT malformed, contained fewer than 3 sections"),null;try{const e=v(n);return e?JSON.parse(e):(Rt("Failed to decode base64 JWT payload"),null)}catch(r){return Rt("Caught error parsing JWT payload as JSON",null===r||void 0===r?void 0:r.toString()),null}}function hn(e){const t=un(e);return Bt(t,"internal-error"),Bt("undefined"!==typeof t.exp,"internal-error"),Bt("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function dn(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof I&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class pn{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void((null===e||void 0===e?void 0:e.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class fn{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ln(this.lastLoginAt),this.creationTime=ln(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function mn(e){var t;const n=e.auth,i=await e.getIdToken(),r=await dn(e,on(n,{idToken:i}));Bt(null===r||void 0===r?void 0:r.users.length,n,"internal-error");const s=r.users[0];e._notifyReloadListener(s);const a=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?gn(s.providerUserInfo):[],o=(l=e.providerData,c=a,[...l.filter((e=>!c.some((t=>t.providerId===e.providerId)))),...c]);var l,c;const u=e.isAnonymous,h=!(e.email&&s.passwordHash)&&!(null===o||void 0===o?void 0:o.length),d=!!u&&h,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new fn(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,p)}function gn(e){return e.map((e=>{var{providerId:t}=e,n=Tt(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class vn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Bt(e.idToken,"internal-error"),Bt("undefined"!==typeof e.idToken,"internal-error"),Bt("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):hn(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Bt(0!==e.length,"internal-error");const t=hn(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(Bt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:r}=await async function(e,t){const n=await $t(e,{},(async()=>{const n=j({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:r}=e.config,s=Zt(e,i,"/v1/token","key=".concat(r)),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Yt.fetch()(s,{method:"POST",headers:a,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:r}=t,s=new vn;return n&&(Bt("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),i&&(Bt("string"===typeof i,"internal-error",{appName:e}),s.accessToken=i),r&&(Bt("number"===typeof r,"internal-error",{appName:e}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new vn,this.toJSON())}_performRefresh(){return Ut("not implemented")}}function yn(e,t){Bt("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class _n{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,r=Tt(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new pn(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new fn(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await dn(this,this.stsTokenManager.getToken(this.auth,e));return Bt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=J(e),i=await n.getIdToken(t),r=un(i);Bt(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s="object"===typeof r.firebase?r.firebase:void 0,a=null===s||void 0===s?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:ln(cn(r.auth_time)),issuedAtTime:ln(cn(r.iat)),expirationTime:ln(cn(r.exp)),signInProvider:a||null,signInSecondFactor:(null===s||void 0===s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=J(e);await mn(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Bt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new _n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Bt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await mn(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ot(this.auth.app))return Promise.reject(Lt(this.auth));const e=await this.getIdToken();return await dn(this,async function(e,t){return Jt(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,r,s,a,o,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(i=t.email)&&void 0!==i?i:void 0,d=null!==(r=t.phoneNumber)&&void 0!==r?r:void 0,p=null!==(s=t.photoURL)&&void 0!==s?s:void 0,f=null!==(a=t.tenantId)&&void 0!==a?a:void 0,m=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:y,emailVerified:_,isAnonymous:w,providerData:x,stsTokenManager:b}=t;Bt(y&&b,e,"internal-error");const S=vn.fromJSON(this.name,b);Bt("string"===typeof y,e,"internal-error"),yn(u,e.name),yn(h,e.name),Bt("boolean"===typeof _,e,"internal-error"),Bt("boolean"===typeof w,e,"internal-error"),yn(d,e.name),yn(p,e.name),yn(f,e.name),yn(m,e.name),yn(g,e.name),yn(v,e.name);const N=new _n({uid:y,auth:e,email:h,emailVerified:_,displayName:u,isAnonymous:w,photoURL:p,phoneNumber:d,tenantId:f,stsTokenManager:S,createdAt:g,lastLoginAt:v});return x&&Array.isArray(x)&&(N.providerData=x.map((e=>Object.assign({},e)))),m&&(N._redirectEventId=m),N}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=new vn;i.updateFromServerResponse(t);const r=new _n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await mn(r),r}static async _fromGetAccountInfoResponse(e,t,n){const i=t.users[0];Bt(void 0!==i.localId,"internal-error");const r=void 0!==i.providerUserInfo?gn(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!(null===r||void 0===r?void 0:r.length),a=new vn;a.updateFromIdToken(n);const o=new _n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:s}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new fn(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(null===r||void 0===r?void 0:r.length)};return Object.assign(o,l),o}}const wn=new Map;function xn(e){zt(e instanceof Function,"Expected a class definition");let t=wn.get(e);return t?(zt(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,wn.set(e,t),t)}class bn{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}bn.type="NONE";const Sn=bn;function Nn(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class Mn{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=Nn(this.userKey,i.apiKey,r),this.fullPersistenceKey=Nn("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?_n._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new Mn(xn(Sn),e,n);const i=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let r=i[0]||xn(Sn);const s=Nn(n,e.config.apiKey,e.name);let a=null;for(const c of t)try{const t=await c._get(s);if(t){const n=_n._fromJSON(e,t);c!==r&&(a=n),r=c;break}}catch(l){}const o=i.filter((e=>e._shouldAllowMigration));return r._shouldAllowMigration&&o.length?(r=o[0],a&&await r._set(s,a.toJSON()),await Promise.all(t.map((async e=>{if(e!==r)try{await e._remove(s)}catch(l){}}))),new Mn(r,e,n)):new Mn(r,e,n)}}function Tn(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(In(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(An(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Pn(t))return"Blackberry";if(Dn(t))return"Webos";if(En(t))return"Safari";if((t.includes("chrome/")||Cn(t))&&!t.includes("edge/"))return"Chrome";if(Rn(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function An(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return/firefox\//i.test(e)}function En(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:T()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Cn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return/crios\//i.test(e)}function In(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return/iemobile/i.test(e)}function Rn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return/android/i.test(e)}function Pn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return/blackberry/i.test(e)}function Dn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return/webos/i.test(e)}function kn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Ln(){return function(){const e=T();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function On(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return kn(e)||Rn(e)||Dn(e)||Pn(e)||/windows phone/i.test(e)||In(e)}function Bn(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=Tn(T());break;case"Worker":t="".concat(Tn(T()),"-").concat(e);break;default:t=e}const i=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(ut,"/").concat(i)}class Un{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,i)=>{try{n(e(t))}catch(r){i(r)}}));n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(i){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class zn{constructor(e){var t,n,i,r;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(r=e.forceUpgradeOnSignin)&&void 0!==r&&r,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,i,r,s,a;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(i=o.containsLowercaseLetter)||void 0===i||i),o.isValid&&(o.isValid=null===(r=o.containsUppercaseLetter)||void 0===r||r),o.isValid&&(o.isValid=null===(s=o.containsNumericCharacter)||void 0===s||s),o.isValid&&(o.isValid=null===(a=o.containsNonAlphanumericCharacter)||void 0===a||a),o}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}class Vn{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new jn(this),this.idTokenSubscription=new jn(this),this.beforeStateQueue=new Un(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ct,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=xn(t)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Mn.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(r){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await on(this,{idToken:e}),n=await _n._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(ot(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null===i||void 0===i?void 0:i._redirectEventId,a=await this.tryRedirectSignIn(e);n&&n!==s||!(null===a||void 0===a?void 0:a.user)||(i=a.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(s)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Bt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await mn(e)}catch(t){if((null===t||void 0===t?void 0:t.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ot(this.app))return Promise.reject(Lt(this));const t=e?J(e):null;return t&&Bt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&Bt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return ot(this.app)?Promise.reject(Lt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ot(this.app)?Promise.reject(Lt(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(xn(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return Jt(e,"GET","/v2/passwordPolicy",Kt(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new zn(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new R("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return Jt(e,"POST","/v2/accounts:revokeToken",Kt(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&xn(e)||this._popupRedirectResolver;Bt(t,this,"argument-error"),this.redirectPersistenceManager=await Mn.create(this,[xn(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const r="function"===typeof t?t:t.next.bind(t);let s=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Bt(a,this,"internal-error"),a.then((()=>{s||r(this.currentUser)})),"function"===typeof t){const r=e.addObserver(t,n,i);return()=>{s=!0,r()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Bt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Bn(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(It.logLevel<=ne.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];It.warn("Auth (".concat(ut,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function Fn(e){return J(e)}class jn{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new Y(e,t);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return Bt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Hn={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Gn(e){return Hn.loadJS(e)}function Wn(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class Yn{constructor(e){this.type="recaptcha-enterprise",this.auth=Fn(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,i){const r=window.grecaptcha;rn(r)?r.enterprise.ready((()=>{r.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,i)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{an(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const n=new sn(i);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((r=>{if(!t&&rn(window.grecaptcha))n(r,e,i);else{if("undefined"===typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));let t=Hn.recaptchaEnterpriseScript;0!==t.length&&(t+=r),Gn(t).then((()=>{n(r,e,i)})).catch((e=>{i(e)}))}})).catch((e=>{i(e)}))}))}}async function qn(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=new Yn(e);let s;try{s=await r.verify(n)}catch(gs){s=await r.verify(n,!0)}const a=Object.assign({},t);return i?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Xn(e,t,n,i){var r;if(null===(r=e._getRecaptchaConfig())||void 0===r?void 0:r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const r=await qn(e,t,n,"getOobCode"===n);return i(e,r)}return i(e,t).catch((async r=>{if(r.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const r=await qn(e,t,n,"getOobCode"===n);return i(e,r)}return Promise.reject(r)}))}function Kn(e,t,n){const i=Fn(e);Bt(i._canInitEmulator,i,"emulator-config-failed"),Bt(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=!!(null===n||void 0===n?void 0:n.disableWarnings),s=Jn(t),{host:a,port:o}=function(e){const t=Jn(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const e=r[1];return{host:e,port:$n(i.substr(e.length+1))}}{const[e,t]=i.split(":");return{host:e,port:$n(t)}}}(t),l=null===o?"":":".concat(o);i.config.emulator={url:"".concat(s,"//").concat(a).concat(l,"/")},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Jn(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function $n(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Qn{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ut("not implemented")}_getIdTokenResponse(e){return Ut("not implemented")}_linkToIdToken(e,t){return Ut("not implemented")}_getReauthenticationResolver(e){return Ut("not implemented")}}async function Zn(e,t){return Jt(e,"POST","/v1/accounts:signUp",t)}async function ei(e,t){return Qt(e,"POST","/v1/accounts:signInWithPassword",Kt(e,t))}async function ti(e,t){return Jt(e,"POST","/v1/accounts:sendOobCode",Kt(e,t))}async function ni(e,t){return ti(e,t)}class ii extends Qn{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new ii(e,t,"password")}static _fromEmailAndCode(e,t){return new ii(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Xn(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",ei);case"emailLink":return async function(e,t){return Qt(e,"POST","/v1/accounts:signInWithEmailLink",Kt(e,t))}(e,{email:this._email,oobCode:this._password});default:Pt(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Xn(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Zn);case"emailLink":return async function(e,t){return Qt(e,"POST","/v1/accounts:signInWithEmailLink",Kt(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Pt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function ri(e,t){return Qt(e,"POST","/v1/accounts:signInWithIdp",Kt(e,t))}class si extends Qn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new si(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Pt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,r=Tt(t,["providerId","signInMethod"]);if(!n||!i)return null;const s=new si(n,i);return s.idToken=r.idToken||void 0,s.accessToken=r.accessToken||void 0,s.secret=r.secret,s.nonce=r.nonce,s.pendingToken=r.pendingToken||null,s}_getIdTokenResponse(e){return ri(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,ri(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ri(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=j(t)}return e}}const ai={USER_NOT_FOUND:"user-not-found"};class oi extends Qn{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new oi({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new oi({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Qt(e,"POST","/v1/accounts:signInWithPhoneNumber",Kt(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Qt(e,"POST","/v1/accounts:signInWithPhoneNumber",Kt(e,t));if(n.temporaryProof)throw nn(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Qt(e,"POST","/v1/accounts:signInWithPhoneNumber",Kt(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),ai)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}=e;return n||t||i||r?new oi({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class li{constructor(e){var t,n,i,r,s,a;const o=H(G(e)),l=null!==(t=o.apiKey)&&void 0!==t?t:null,c=null!==(n=o.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=o.mode)&&void 0!==i?i:null);Bt(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(r=o.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(s=o.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(a=o.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function(e){const t=H(G(e)).link,n=t?H(G(t)).deep_link_id:null,i=H(G(e)).deep_link_id;return(i?H(G(i)).link:null)||i||n||t||e}(e);try{return new li(t)}catch(n){return null}}}class ci{constructor(){this.providerId=ci.PROVIDER_ID}static credential(e,t){return ii._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=li.parseLink(t);return Bt(n,"argument-error"),ii._fromEmailAndCode(e,n.code,n.tenantId)}}ci.PROVIDER_ID="password",ci.EMAIL_PASSWORD_SIGN_IN_METHOD="password",ci.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class ui{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class hi extends ui{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class di extends hi{constructor(){super("facebook.com")}static credential(e){return si._fromParams({providerId:di.PROVIDER_ID,signInMethod:di.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return di.credentialFromTaggedObject(e)}static credentialFromError(e){return di.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return di.credential(t.oauthAccessToken)}catch(n){return null}}}di.FACEBOOK_SIGN_IN_METHOD="facebook.com",di.PROVIDER_ID="facebook.com";class pi extends hi{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return si._fromParams({providerId:pi.PROVIDER_ID,signInMethod:pi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return pi.credentialFromTaggedObject(e)}static credentialFromError(e){return pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:i}=t;if(!n&&!i)return null;try{return pi.credential(n,i)}catch(r){return null}}}pi.GOOGLE_SIGN_IN_METHOD="google.com",pi.PROVIDER_ID="google.com";class fi extends hi{constructor(){super("github.com")}static credential(e){return si._fromParams({providerId:fi.PROVIDER_ID,signInMethod:fi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return fi.credentialFromTaggedObject(e)}static credentialFromError(e){return fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return fi.credential(t.oauthAccessToken)}catch(n){return null}}}fi.GITHUB_SIGN_IN_METHOD="github.com",fi.PROVIDER_ID="github.com";class mi extends hi{constructor(){super("twitter.com")}static credential(e,t){return si._fromParams({providerId:mi.PROVIDER_ID,signInMethod:mi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return mi.credentialFromTaggedObject(e)}static credentialFromError(e){return mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=t;if(!n||!i)return null;try{return mi.credential(n,i)}catch(r){return null}}}mi.TWITTER_SIGN_IN_METHOD="twitter.com",mi.PROVIDER_ID="twitter.com";class gi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=await _n._fromIdTokenResponse(e,n,i),s=vi(n);return new gi({user:r,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=vi(n);return new gi({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function vi(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class yi extends I{constructor(e,t,n,i){var r;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,yi.prototype),this.customData={appName:e.name,tenantId:null!==(r=e.tenantId)&&void 0!==r?r:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new yi(e,t,n,i)}}function _i(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw yi._fromErrorAndOperation(e,n,t,i);throw n}))}async function wi(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=await dn(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return gi._forOperation(e,"link",i)}async function xi(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:i}=e;if(ot(i.app))return Promise.reject(Lt(i));const r="reauthenticate";try{const s=await dn(e,_i(i,r,t,e),n);Bt(s.idToken,i,"internal-error");const a=un(s.idToken);Bt(a,i,"internal-error");const{sub:o}=a;return Bt(e.uid===o,i,"user-mismatch"),gi._forOperation(e,r,s)}catch(s){throw(null===s||void 0===s?void 0:s.code)==="auth/".concat("user-not-found")&&Pt(i,"user-mismatch"),s}}async function bi(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(ot(e.app))return Promise.reject(Lt(e));const i="signIn",r=await _i(e,i,t),s=await gi._fromIdTokenResponse(e,i,r);return n||await e._updateCurrentUser(s.user),s}async function Si(e,t){return bi(Fn(e),t)}function Ni(e,t,n){var i;Bt((null===(i=n.url)||void 0===i?void 0:i.length)>0,e,"invalid-continue-uri"),Bt("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(Bt(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(Bt(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function Mi(e){const t=Fn(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}function Ti(e,t,n){return ot(e.app)?Promise.reject(Lt(e)):Si(J(e),ci.credential(t,n)).catch((async t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&Mi(e),t}))}new WeakMap;const Ai="__sak";class Ei{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ai,"1"),this.storage.removeItem(Ai),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Ci extends Ei{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=T();return En(e)||kn(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=On(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},r=this.storage.getItem(n);Ln()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ci.type="LOCAL";const Ii=Ci;class Ri extends Ei{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Ri.type="SESSION";const Pi=Ri;class Di{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Di(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:r}=t.data,s=this.handlersMap[i];if(!(null===s||void 0===s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const a=Array.from(s).map((async e=>e(t.origin,r))),o=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(a);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function ki(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let i=0;i<t;i++)n+=Math.floor(10*Math.random());return e+n}Di.receivers=[];class Li{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const i="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise(((a,o)=>{const l=ki("",20);i.port1.start();const c=setTimeout((()=>{o(new Error("unsupported_event"))}),n);s={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),r=setTimeout((()=>{o(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),a(t.data.response);break;default:clearTimeout(c),clearTimeout(r),o(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function Oi(){return window}function Bi(){return"undefined"!==typeof Oi().WorkerGlobalScope&&"function"===typeof Oi().importScripts}const Ui="firebaseLocalStorageDb",zi="firebaseLocalStorage",Vi="fbase_key";class Fi{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function ji(e,t){return e.transaction([zi],t?"readwrite":"readonly").objectStore(zi)}function Hi(){const e=indexedDB.open(Ui,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(zi,{keyPath:Vi})}catch(i){n(i)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(zi)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Ui);return new Fi(e).toPromise()}(),t(await Hi()))}))}))}async function Gi(e,t,n){const i=ji(e,!0).put({[Vi]:t,value:n});return new Fi(i).toPromise()}function Wi(e,t){const n=ji(e,!0).delete(t);return new Fi(n).toPromise()}class Yi{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Hi()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Bi()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Di._getInstance(Bi()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Li(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Hi();return await Gi(e,Ai,"1"),await Wi(e,Ai),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Gi(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=ji(e,!1).get(t),i=await new Fi(n).toPromise();return void 0===i?null:i.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Wi(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=ji(e,!1).getAll();return new Fi(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:i,value:r}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Yi.type="LOCAL";const qi=Yi;Wn("rcb"),new Gt(3e4,6e4);const Xi="recaptcha";async function Ki(e,t,n){var i;const r=await n.verify();try{let s;if(Bt("string"===typeof r,e,"argument-error"),Bt(n.type===Xi,e,"argument-error"),s="string"===typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){Bt("enroll"===t.type,e,"internal-error");const n=await function(e,t){return Jt(e,"POST","/v2/accounts/mfaEnrollment:start",Kt(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{Bt("signin"===t.type,e,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;Bt(n,e,"missing-multi-factor-info");const a=await function(e,t){return Jt(e,"POST","/v2/accounts/mfaSignIn:start",Kt(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return a.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Jt(e,"POST","/v1/accounts:sendVerificationCode",Kt(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:r});return t}}finally{n._reset()}}class Ji{constructor(e){this.providerId=Ji.PROVIDER_ID,this.auth=Fn(e)}verifyPhoneNumber(e,t){return Ki(this.auth,e,J(t))}static credential(e,t){return oi._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Ji.credentialFromTaggedObject(t)}static credentialFromError(e){return Ji.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:i}=t;return n&&i?oi._fromTokenResponse(n,i):null}}function $i(e,t){return t?xn(t):(Bt(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Ji.PROVIDER_ID="phone",Ji.PHONE_SIGN_IN_METHOD="phone";class Qi extends Qn{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ri(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ri(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ri(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Zi(e){return bi(e.auth,new Qi(e),e.bypassAuthState)}function er(e){const{auth:t,user:n}=e;return Bt(n,t,"internal-error"),xi(n,new Qi(e),e.bypassAuthState)}async function tr(e){const{auth:t,user:n}=e;return Bt(n,t,"internal-error"),wi(n,new Qi(e),e.bypassAuthState)}class nr{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:r,error:s,type:a}=e;if(s)return void this.reject(s);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(o))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Zi;case"linkViaPopup":case"linkViaRedirect":return tr;case"reauthViaPopup":case"reauthViaRedirect":return er;default:Pt(this.auth,"internal-error")}}resolve(e){zt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){zt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const ir=new Gt(2e3,1e4);class rr extends nr{constructor(e,t,n,i,r){super(e,t,i,r),this.provider=n,this.authWindow=null,this.pollId=null,rr.currentPopupAction&&rr.currentPopupAction.cancel(),rr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Bt(e,this.auth,"internal-error"),e}async onExecution(){zt(1===this.filter.length,"Popup operations only handle one event");const e=ki();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(Dt(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Dt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,rr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Dt(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,ir.get())};e()}}rr.currentPopupAction=null;const sr="pendingRedirect",ar=new Map;class or extends nr{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=ar.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=ur(t),i=cr(e);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}ar.set(this.auth._key(),e)}return this.bypassAuthState||ar.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function lr(e,t){ar.set(e._key(),t)}function cr(e){return xn(e._redirectPersistence)}function ur(e){return Nn(sr,e.config.apiKey,e.name)}async function hr(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(ot(e.app))return Promise.reject(Lt(e));const i=Fn(e),r=$i(i,t),s=new or(i,r,n),a=await s.execute();return a&&!n&&(delete a.user._redirectEventId,await i._persistUserIfCurrent(a.user),await i._setRedirectUser(null,t)),a}class dr{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return fr(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!fr(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Dt(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(pr(e))}saveEventToCache(e){this.cachedEventUids.add(pr(e)),this.lastProcessedEventTime=Date.now()}}function pr(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function fr(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const mr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,gr=/^https?/;async function vr(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return Jt(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const i of t)try{if(yr(i))return}catch(n){}Pt(e,"unauthorized-domain")}function yr(e){const t=Vt(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!gr.test(n))return!1;if(mr.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const _r=new Gt(3e4,6e4);function wr(){const e=Oi().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function xr(e){return new Promise(((t,n)=>{var i,r,s;function a(){wr(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{wr(),n(Dt(e,"network-request-failed"))},timeout:_r.get()})}if(null===(r=null===(i=Oi().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=Oi().gapi)||void 0===s?void 0:s.load)){const t=Wn("iframefcb");return Oi()[t]=()=>{gapi.load?a():n(Dt(e,"network-request-failed"))},Gn("".concat(Hn.gapiScript,"?onload=").concat(t)).catch((e=>n(e)))}a()}})).catch((e=>{throw br=null,e}))}let br=null;const Sr=new Gt(5e3,15e3),Nr="__/auth/iframe",Mr="emulator/auth/iframe",Tr={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ar=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Er(e){const t=e.config;Bt(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Wt(t,Mr):"https://".concat(e.config.authDomain,"/").concat(Nr),i={apiKey:t.apiKey,appName:e.name,v:ut},r=Ar.get(e.config.apiHost);r&&(i.eid=r);const s=e._getFrameworks();return s.length&&(i.fw=s.join(",")),"".concat(n,"?").concat(j(i).slice(1))}async function Cr(e){const t=await function(e){return br=br||xr(e),br}(e),n=Oi().gapi;return Bt(n,e,"internal-error"),t.open({where:document.body,url:Er(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Tr,dontclear:!0},(t=>new Promise((async(n,i)=>{await t.restyle({setHideOnLeave:!1});const r=Dt(e,"network-request-failed"),s=Oi().setTimeout((()=>{i(r)}),Sr.get());function a(){Oi().clearTimeout(s),n(t)}t.ping(a).then(a,(()=>{i(r)}))}))))}const Ir={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Rr{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Pr(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const s=Math.max((window.screen.availHeight-r)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString();let o="";const l=Object.assign(Object.assign({},Ir),{width:i.toString(),height:r.toString(),top:s,left:a}),c=T().toLowerCase();n&&(o=Cn(c)?"_blank":n),An(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce(((e,t)=>{let[n,i]=t;return"".concat(e).concat(n,"=").concat(i,",")}),"");if(function(){var e;return kn(arguments.length>0&&void 0!==arguments[0]?arguments[0]:T())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==o)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(t||"",o),new Rr(null);const h=window.open(t||"",o,u);Bt(h,e,"popup-blocked");try{h.focus()}catch(d){}return new Rr(h)}const Dr="__/auth/handler",kr="emulator/auth/handler",Lr=encodeURIComponent("fac");async function Or(e,t,n,i,r,s){Bt(e.config.authDomain,e,"auth-domain-config-required"),Bt(e.config.apiKey,e,"invalid-api-key");const a={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:ut,eventId:r};if(t instanceof ui){t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",U(t.getCustomParameters())||(a.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))a[e]=t}if(t instanceof hi){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(a.scopes=e.join(","))}e.tenantId&&(a.tid=e.tenantId);const o=a;for(const u of Object.keys(o))void 0===o[u]&&delete o[u];const l=await e._getAppCheckToken(),c=l?"#".concat(Lr,"=").concat(encodeURIComponent(l)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(Dr);return Wt(t,kr)}(e),"?").concat(j(o).slice(1)).concat(c)}const Br="webStorageSupport";const Ur=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Pi,this._completeRedirectFn=hr,this._overrideRedirectResult=lr}async _openPopup(e,t,n,i){var r;zt(null===(r=this.eventManagers[e._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()");return Pr(e,await Or(e,t,n,Vt(),i),ki())}async _openRedirect(e,t,n,i){await this._originValidation(e);return function(e){Oi().location.href=e}(await Or(e,t,n,Vt(),i)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(zt(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await Cr(e),n=new dr(e);return t.register("authEvent",(t=>{Bt(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Br,{type:Br},(n=>{var i;const r=null===(i=null===n||void 0===n?void 0:n[0])||void 0===i?void 0:i[Br];void 0!==r&&t(!!r),Pt(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=vr(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return On()||En()||kn()}};var zr="@firebase/auth",Vr="1.7.1";class Fr{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Bt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const jr=N("authIdTokenMaxAge")||300;let Hr=null;function Gr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dt();const t=at(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=at(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(V(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;Pt(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Ur,persistence:[qi,Ii,Pi]}),i=N("authTokenSyncURL");if(i&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(i,location.origin);if(location.origin===e.origin){const t=(r=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>jr)return;const i=null===t||void 0===t?void 0:t.token;Hr!==i&&(Hr=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:"Bearer ".concat(i)}:{}}))});!function(e,t,n){J(e).beforeAuthStateChanged(t,n)}(n,t,(()=>t(n.currentUser))),function(e,t,n,i){J(e).onIdTokenChanged(t,n,i)}(n,(e=>t(e)))}}var r;const s=b("auth");return s&&Kn(n,"http://".concat(s)),n}var Wr,Yr;Wr={loadJS:e=>new Promise(((t,n)=>{const i=document.createElement("script");i.setAttribute("src",e),i.onload=t,i.onerror=e=>{const t=Dt("internal-error");t.customData=e,n(t)},i.type="text/javascript",i.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(i)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Hn=Wr,Yr="Browser",st(new $("auth",((e,t)=>{let{options:n}=t;const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=i.options;Bt(a&&!a.includes(":"),"invalid-api-key",{appName:i.name});const l={apiKey:a,authDomain:o,clientPlatform:Yr,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Bn(Yr)},c=new Vn(i,r,s,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(xn);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),st(new $("auth-internal",(e=>(e=>new Fr(e))(Fn(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),pt(zr,Vr,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Yr)),pt(zr,Vr,"esm2017");pt("firebase","10.11.0","app");const qr=ht({apiKey:"AIzaSyC7tKm8rbkmYLQ6IqQZn5uri_X1RQV7KLc",authDomain:"legalcapital-1f52c.firebaseapp.com",databaseURL:"https://legalcapital-1f52c-default-rtdb.firebaseio.com",projectId:"legalcapital-1f52c",storageBucket:"legalcapital-1f52c.appspot.com",messagingSenderId:"484884229897",appId:"1:484884229897:web:3c76833fe481fedd112dd8"}),Xr=Gr(qr),Kr=()=>{const e=(0,a.useHistory)();return(0,r.jsxs)("button",{class:"btnLo",onClick:()=>{(function(e){return J(e).signOut()})(Xr).then((()=>{console.log("Usuario desconectado exitosamente"),e.push("/")})).catch((e=>{console.error("Error al desconectar al usuario:",e)}))},children:[(0,r.jsx)("div",{class:"sign",children:(0,r.jsx)("svg",{viewBox:"0 0 512 512",children:(0,r.jsx)("path",{d:"M377.9 105.9L500.7 228.7c7.2 7.2 11.3 17.1 11.3 27.3s-4.1 20.1-11.3 27.3L377.9 406.1c-6.4 6.4-15 9.9-24 9.9c-18.7 0-33.9-15.2-33.9-33.9l0-62.1-128 0c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l128 0 0-62.1c0-18.7 15.2-33.9 33.9-33.9c9 0 17.6 3.6 24 9.9zM160 96L96 96c-17.7 0-32 14.3-32 32l0 256c0 17.7 14.3 32 32 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-64 0c-53 0-96-43-96-96L0 128C0 75 43 32 96 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32z"})})}),(0,r.jsx)("div",{class:"text",children:"Logout"})]})},Jr=()=>(0,r.jsx)("nav",{class:"navegacion",children:(0,r.jsxs)("ul",{children:[(0,r.jsx)("h4",{children:"Main menu"}),(0,r.jsx)("hr",{}),(0,r.jsx)("li",{children:(0,r.jsx)(s,{lk:"/Dashboard/home",ic:"bi bi-house",sp:"Home"})}),(0,r.jsx)("li",{children:(0,r.jsx)(s,{lk:"/Dashboard/packs",ic:"bi bi-boxes",sp:"Products"})}),(0,r.jsx)("li",{children:(0,r.jsx)(s,{lk:"/Dashboard/comming-soon",ic:"bi bi-diagram-3",sp:"My network"})}),(0,r.jsx)("li",{children:(0,r.jsx)(s,{lk:"/Dashboard/comming-soon",ic:"bi bi-graph-up-arrow",sp:"dividend"})}),(0,r.jsx)("li",{children:(0,r.jsx)(s,{lk:"/Dashboard/comming-soon",ic:"bi bi-person-vcard",sp:"Withdrawals"})}),(0,r.jsx)("li",{children:(0,r.jsx)(s,{lk:"/Dashboard/comming-soon",ic:"bi bi-bag",sp:"E-comerce"})}),(0,r.jsx)("li",{children:(0,r.jsx)(s,{lk:"/Dashboard/comming-soon",ic:"bi bi-archive",sp:"Tools"})}),(0,r.jsx)("li",{children:(0,r.jsx)(s,{lk:"/Dashboard/comming-soon",ic:"bi bi-exclamation-octagon",sp:"Support"})}),(0,r.jsx)("li",{children:(0,r.jsx)(s,{lk:"/Dashboard/comming-soon",ic:"bi bi-person-gear",sp:"Edit profile"})})]})}),$r=e=>(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"barra-lateral ".concat(e.max?"mini-barra-lateral":"max-barra-lateral"),children:[(0,r.jsx)("div",{className:e.max?"headNav":"headNavMax",children:(0,r.jsx)("img",{alt:"logo",className:e.max?"logoNav":"logoNavMax"})}),(0,r.jsx)(Jr,{})]})}),Qr="@firebase/database",Zr="1.0.4";let es="";function ts(e){es=e}class ns{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),k(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:D(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class is{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return O(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const rs=function(e){try{if("undefined"!==typeof window&&"undefined"!==typeof window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new ns(t)}}catch(t){}return new is},ss=rs("localStorage"),as=rs("sessionStorage"),os=new oe("@firebase/database"),ls=function(){let e=1;return function(){return e++}}(),cs=function(e){const t=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);if(r>=55296&&r<=56319){const t=r-55296;i++,u(i<e.length,"Surrogate pair missing trail surrogate."),r=65536+(t<<10)+(e.charCodeAt(i)-56320)}r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):r<65536?(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t}(e),n=new W;n.update(t);const i=n.digest();return p.encodeByteArray(i)},us=function(){let e="";for(let t=0;t<arguments.length;t++){const n=t<0||arguments.length<=t?void 0:arguments[t];Array.isArray(n)||n&&"object"===typeof n&&"number"===typeof n.length?e+=us.apply(null,n):e+="object"===typeof n?k(n):n,e+=" "}return e};let hs=null,ds=!0;const ps=function(e,t){u(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(os.logLevel=ne.VERBOSE,hs=os.log.bind(os),t&&as.set("logging_enabled",!0)):"function"===typeof e?hs=e:(hs=null,as.remove("logging_enabled"))},fs=function(){if(!0===ds&&(ds=!1,null===hs&&!0===as.get("logging_enabled")&&ps(!0)),hs){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=us.apply(null,t);hs(i)}},ms=function(e){return function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];fs(e,...n)}},gs=function(){const e="FIREBASE INTERNAL ERROR: "+us(...arguments);os.error(e)},vs=function(){const e="FIREBASE FATAL ERROR: ".concat(us(...arguments));throw os.error(e),new Error(e)},ys=function(){const e="FIREBASE WARNING: "+us(...arguments);os.warn(e)},_s=function(e){return"number"===typeof e&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},ws="[MIN_NAME]",xs="[MAX_NAME]",bs=function(e,t){if(e===t)return 0;if(e===ws||t===xs)return-1;if(t===ws||e===xs)return 1;{const n=Is(e),i=Is(t);return null!==n?null!==i?n-i===0?e.length-t.length:n-i:-1:null!==i?1:e<t?-1:1}},Ss=function(e,t){return e===t?0:e<t?-1:1},Ns=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+k(t))},Ms=function(e){if("object"!==typeof e||null===e)return k(e);const t=[];for(const i in e)t.push(i);t.sort();let n="{";for(let i=0;i<t.length;i++)0!==i&&(n+=","),n+=k(t[i]),n+=":",n+=Ms(e[t[i]]);return n+="}",n},Ts=function(e,t){const n=e.length;if(n<=t)return[e];const i=[];for(let r=0;r<n;r+=t)r+t>n?i.push(e.substring(r,n)):i.push(e.substring(r,r+t));return i};function As(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const Es=function(e){u(!_s(e),"Invalid JSON number");const t=1023;let n,i,r,s,a;0===e?(i=0,r=0,n=1/e===-1/0?1:0):(n=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(s=Math.min(Math.floor(Math.log(e)/Math.LN2),t),i=s+t,r=Math.round(e*Math.pow(2,52-s)-Math.pow(2,52))):(i=0,r=Math.round(e/Math.pow(2,-1074))));const o=[];for(a=52;a;a-=1)o.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)o.push(i%2?1:0),i=Math.floor(i/2);o.push(n?1:0),o.reverse();const l=o.join("");let c="";for(a=0;a<64;a+=8){let e=parseInt(l.substr(a,8),2).toString(16);1===e.length&&(e="0"+e),c+=e}return c.toLowerCase()};const Cs=new RegExp("^-?(0*)\\d{1,10}$"),Is=function(e){if(Cs.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},Rs=function(e){try{e()}catch(t){setTimeout((()=>{const e=t.stack||"";throw ys("Exception was thrown by user callback.",e),t}),Math.floor(0))}},Ps=function(e,t){const n=setTimeout(e,t);return"number"===typeof n&&"undefined"!==typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"===typeof n&&n.unref&&n.unref(),n};class Ds{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null===t||void 0===t?void 0:t.getImmediate({optional:!0}),this.appCheck||null===t||void 0===t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){ys('Provided AppCheck credentials for the app named "'.concat(this.appName_,'" ')+"are invalid. This usually indicates your app was not initialized correctly.")}}class ks{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(fs("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ys(e)}}class Ls{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Ls.OWNER="owner";const Os="5",Bs=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Us="ac",zs="websocket",Vs="long_polling";class Fs{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.secure=t,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=s,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=o,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=ss.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&ss.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"";return"".concat(e).concat(this.host,"/").concat(t)}}function js(e,t,n){let i;if(u("string"===typeof t,"typeof type must == string"),u("object"===typeof n,"typeof params must == object"),t===zs)i=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==Vs)throw new Error("Unknown connection type: "+t);i=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const r=[];return As(n,((e,t)=>{r.push(e+"="+t)})),i+r.join("&")}class Hs{constructor(){this.counters_={}}incrementCounter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;O(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return y(this.counters_)}}const Gs={},Ws={};function Ys(e){const t=e.toString();return Gs[t]||(Gs[t]=new Hs),Gs[t]}class qs{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&Rs((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const Xs="start";class Ks{constructor(e,t,n,i,r,s,a){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=i,this.authToken=r,this.transportSessionId=s,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=ms(e),this.stats_=Ys(t),this.urlFn=e=>(this.appCheckToken&&(e[Us]=this.appCheckToken),js(t,Vs,e))}open(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new qs(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if(C()||"complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new Js((function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const[r,s,a,o,l]=t;if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,r===Xs)n.id=s,n.password=a;else{if("close"!==r)throw new Error("Unrecognized command received: "+r);s?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(s,(()=>{n.onClosed_()}))):n.onClosed_()}}),(function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const[r,s]=t;n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(r,s)}),(()=>{this.onClosed_()}),this.urlFn);const e={};e[Xs]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=Os,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[Us]=this.appCheckToken),"undefined"!==typeof location&&location.hostname&&Bs.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Ks.forceAllow_=!0}static forceDisallow(){Ks.forceDisallow_=!0}static isAvailable(){return!C()&&(!!Ks.forceAllow_||!Ks.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=k(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=m(t),i=Ts(n,1840);for(let r=0;r<i.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[r]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(C())return;this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=k(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Js{constructor(e,t,n,i){if(this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,C())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=ls(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=Js.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)){n='<script>document.domain="'+document.domain+'";<\/script>'}const i="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(r){fs("frame writing exception"),r.stack&&fs(r.stack),fs(r)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||fs("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",i=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+i+"="+e.seg+"&ts"+i+"="+e.ts+"&d"+i+"="+e.d,i++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(i),n()}))}addTag(e,t){C()?this.doNodeLongPoll(e,t):setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{fs("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(n){}}),Math.floor(1))}}let $s=null;"undefined"!==typeof MozWebSocket?$s=MozWebSocket:"undefined"!==typeof WebSocket&&($s=WebSocket);class Qs{constructor(e,t,n,i,r,s,a){this.connId=e,this.applicationId=n,this.appCheckToken=i,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=ms(this.connId),this.stats_=Ys(t),this.connURL=Qs.connectionURL_(t,s,a,i,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,i,r){const s={};return s.v=Os,!C()&&"undefined"!==typeof location&&location.hostname&&Bs.test(location.hostname)&&(s.r="f"),t&&(s.s=t),n&&(s.ls=n),i&&(s[Us]=i),r&&(s.p=r),js(e,zs,s)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,ss.set("previous_websocket_failure",!0);try{let e;if(C()){const t=this.nodeAdmin?"AdminNode":"Node";e={headers:{"User-Agent":"Firebase/".concat(Os,"/").concat(es,"/").concat(process.platform,"/").concat(t),"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(e.headers.Authorization="Bearer ".concat(this.authToken)),this.appCheckToken&&(e.headers["X-Firebase-AppCheck"]=this.appCheckToken);const n={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0},i=0===this.connURL.indexOf("wss://")?n.HTTPS_PROXY||n.https_proxy:n.HTTP_PROXY||n.http_proxy;i&&(e.proxy={origin:i})}this.mySock=new $s(this.connURL,[],e)}catch(n){this.log_("Error instantiating WebSocket.");const e=n.message||n.data;return e&&this.log_(e),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){Qs.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!==typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==$s&&!Qs.forceDisallow_}static previouslyFailed(){return ss.isInMemoryStorage||!0===ss.get("previous_websocket_failure")}markConnectionHealthy(){ss.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=D(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(u(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=k(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=Ts(t,16384);n.length>1&&this.sendString_(String(n.length));for(let i=0;i<n.length;i++)this.sendString_(n[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Qs.responsesRequiredToBeHealthy=2,Qs.healthyTimeout=3e4;class Zs{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Ks,Qs]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=Qs&&Qs.isAvailable();let n=t&&!Qs.previouslyFailed();if(e.webSocketOnly&&(t||ys("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[Qs];else{const e=this.transports_=[];for(const t of Zs.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);Zs.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Zs.globalTransportInitialized_=!1;class ea{constructor(e,t,n,i,r,s,a,o,l,c){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=s,this.onReady_=a,this.onDisconnect_=o,this.onKill_=l,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=ms("c:"+this.id+":"),this.transportManager_=new Zs(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Ps((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Ns("t",e),n=Ns("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Ns("t",e),n=Ns("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Ns("t",e);if("d"in e){const n=e.d;if("h"===t){const e=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?gs("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):gs("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Os!==n&&ys("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),Ps((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Ps((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(ss.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class ta{put(e,t,n,i){}merge(e,t,n,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class na{constructor(e){this.allowedEvents_=e,this.listeners_={},u(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(let e=0;e<r.length;e++)r[e].callback.apply(r[e].context,n)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const i=this.getInitialEvent(e);i&&t.apply(n,i)}off(e,t,n){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let r=0;r<i.length;r++)if(i[r].callback===t&&(!n||n===i[r].context))return void i.splice(r,1)}validateEventType_(e){u(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}class ia extends na{constructor(){super(["online"]),this.online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||A()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new ia}getInitialEvent(e){return u("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}const ra=32,sa=768;class aa{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function oa(){return new aa("")}function la(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function ca(e){return e.pieces_.length-e.pieceNum_}function ua(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new aa(e.pieces_,t)}function ha(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function da(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function pa(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new aa(t,0)}function fa(e,t){const n=[];for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);if(t instanceof aa)for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new aa(n,0)}function ma(e){return e.pieceNum_>=e.pieces_.length}function ga(e,t){const n=la(e),i=la(t);if(null===n)return t;if(n===i)return ga(ua(e),ua(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function va(e,t){if(ca(e)!==ca(t))return!1;for(let n=e.pieceNum_,i=t.pieceNum_;n<=e.pieces_.length;n++,i++)if(e.pieces_[n]!==t.pieces_[i])return!1;return!0}function ya(e,t){let n=e.pieceNum_,i=t.pieceNum_;if(ca(e)>ca(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[i])return!1;++n,++i}return!0}class _a{constructor(e,t){this.errorPrefix_=t,this.parts_=da(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=K(this.parts_[n]);wa(this)}}function wa(e){if(e.byteLength_>sa)throw new Error(e.errorPrefix_+"has a key path longer than "+sa+" bytes ("+e.byteLength_+").");if(e.parts_.length>ra)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+ra+") or object contains a cycle "+xa(e))}function xa(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class ba extends na{constructor(){let e,t;super(["visible"]),"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(t="visibilitychange",e="hidden"):"undefined"!==typeof document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):"undefined"!==typeof document.msHidden?(t="msvisibilitychange",e="msHidden"):"undefined"!==typeof document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new ba}getInitialEvent(e){return u("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Sa=1e3;class Na extends ta{constructor(e,t,n,i,r,s,a,o){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=i,this.onServerInfoUpdate_=r,this.authTokenProvider_=s,this.appCheckTokenProvider_=a,this.authOverride_=o,this.id=Na.nextPersistentConnectionId_++,this.log_=ms("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Sa,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,o&&!C())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");ba.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&ia.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const i=++this.requestNumber_,r={r:i,a:e,b:t};this.log_(k(r)),u(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),n&&(this.requestCBHash_[i]=n)}get(e){this.initConnection_();const t=new M,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),t.promise}listen(e,t,n,i){this.initConnection_();const r=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+r),this.listens.has(s)||this.listens.set(s,new Map),u(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),u(!this.listens.get(s).has(r),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:t,query:e,tag:n};this.listens.get(s).set(r,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+n+" for "+i);const r={p:n};e.tag&&(r.q=t._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest("q",r,(r=>{const s=r.d,a=r.s;Na.warnOnListenWarnings_(s,t);(this.listens.get(n)&&this.listens.get(n).get(i))===e&&(this.log_("listen response",r),"ok"!==a&&this.removeListen_(n,i),e.onComplete&&e.onComplete(a,s))}))}static warnOnListenWarnings_(e,t){if(e&&"object"===typeof e&&O(e,"w")){const n=B(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();ys("Using an unspecified index. Your data will be downloaded and "+"filtered on the client. Consider adding ".concat(e," at ")+"".concat(n," to your security rules for better performance."))}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(e){const t=L(e).claims;return"object"===typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=function(e){const t=L(e).claims;return!!t&&"object"===typeof t&&t.hasOwnProperty("iat")}(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"===typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,i=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,i))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+i),u(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,i)&&this.connected_&&this.sendUnlisten_(n,i,e._queryObject,t)}sendUnlisten_(e,t,n,i){this.log_("Unlisten on "+e+" for "+t);const r={p:e};i&&(r.q=n,r.t=i),this.sendRequest("n",r)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,i){const r={p:t,d:n};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,(e=>{i&&setTimeout((()=>{i(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,i){this.putInternal("p",e,t,n,i)}merge(e,t,n,i){this.putInternal("m",e,t,n,i)}putInternal(e,t,n,i,r){this.initConnection_();const s={p:t,d:n};void 0!==r&&(s.h=r),this.outstandingPuts_.push({action:e,request:s,onComplete:i}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),i&&i(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+k(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):gs("Unrecognized action received from server: "+k(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){u(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Sa,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Sa,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Sa),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Na.nextConnectionId_++,r=this.lastSessionId;let s=!1,a=null;const o=function(){a?a.close():(s=!0,n())},l=function(e){u(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(e)};this.realtime_={close:o,sendRequest:l};const c=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[o,l]=await Promise.all([this.authTokenProvider_.getToken(c),this.appCheckTokenProvider_.getToken(c)]);s?fs("getToken() completed but was canceled"):(fs("getToken() completed. Creating connection."),this.authToken_=o&&o.accessToken,this.appCheckToken_=l&&l.token,a=new ea(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{ys(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),r))}catch(gs){this.log_("Failed to get token: "+gs),s||(this.repoInfo_.nodeAdmin&&ys(gs),o())}}}interrupt(e){fs("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){fs("Resuming connection for reason: "+e),delete this.interruptReasons_[e],U(this.interruptReasons_)&&(this.reconnectDelay_=Sa,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>Ms(e))).join("$"):"default";const i=this.removeListen_(e,n);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const n=new aa(e).toString();let i;if(this.listens.has(n)){const e=this.listens.get(n);i=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else i=void 0;return i}onAuthRevoked_(e,t){fs("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){fs("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";C()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+es.replace(/\./g,"-")]=1,A()?e["framework.cordova"]=1:E()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=ia.getInstance().currentlyOnline();return U(this.interruptReasons_)&&e}}Na.nextPersistentConnectionId_=0,Na.nextConnectionId_=0;class Ma{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Ma(e,t)}}class Ta{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Ma(ws,e),i=new Ma(ws,t);return 0!==this.compare(n,i)}minPost(){return Ma.MIN}}let Aa;class Ea extends Ta{static get __EMPTY_NODE(){return Aa}static set __EMPTY_NODE(e){Aa=e}compare(e,t){return bs(e.name,t.name)}isDefinedOn(e){throw h("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Ma.MIN}maxPost(){return new Ma(xs,Aa)}makePost(e,t){return u("string"===typeof e,"KeyIndex indexValue must always be a string."),new Ma(e,Aa)}toString(){return".key"}}const Ca=new Ea;class Ia{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,i&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Ra{constructor(e,t,n,i,r){this.key=e,this.value=t,this.color=null!=n?n:Ra.RED,this.left=null!=i?i:Pa.EMPTY_NODE,this.right=null!=r?r:Pa.EMPTY_NODE}copy(e,t,n,i,r){return new Ra(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const r=n(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return Pa.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,i;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Pa.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Ra.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Ra.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Ra.RED=!0,Ra.BLACK=!1;class Pa{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pa.EMPTY_NODE;this.comparator_=e,this.root_=t}insert(e,t){return new Pa(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Ra.BLACK,null,null))}remove(e){return new Pa(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ra.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,i=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(i=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ia(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Ia(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Ia(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Ia(this.root_,null,this.comparator_,!0,e)}}function Da(e,t){return bs(e.name,t.name)}function ka(e,t){return bs(e,t)}let La;Pa.EMPTY_NODE=new class{copy(e,t,n,i,r){return this}insert(e,t,n){return new Ra(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const Oa=function(e){return"number"===typeof e?"number:"+Es(e):"string:"+e},Ba=function(e){if(e.isLeafNode()){const t=e.val();u("string"===typeof t||"number"===typeof t||"object"===typeof t&&O(t,".sv"),"Priority must be a string or number.")}else u(e===La||e.isEmpty(),"priority of unexpected type.");u(e===La||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Ua,za,Va;class Fa{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Fa.__childrenNodeConstructor.EMPTY_NODE;this.value_=e,this.priorityNode_=t,this.lazyHash_=null,u(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Ba(this.priorityNode_)}static set __childrenNodeConstructor(e){Ua=e}static get __childrenNodeConstructor(){return Ua}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Fa(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:Fa.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return ma(e)?this:".priority"===la(e)?this.priorityNode_:Fa.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:Fa.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=la(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(u(".priority"!==n||1===ca(e),".priority must be the last token in a path"),this.updateImmediateChild(n,Fa.__childrenNodeConstructor.EMPTY_NODE.updateChild(ua(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Oa(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?Es(this.value_):this.value_,this.lazyHash_=cs(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Fa.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Fa.__childrenNodeConstructor?-1:(u(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,i=Fa.VALUE_TYPE_ORDER.indexOf(t),r=Fa.VALUE_TYPE_ORDER.indexOf(n);return u(i>=0,"Unknown leaf type: "+t),u(r>=0,"Unknown leaf type: "+n),i===r?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}Fa.VALUE_TYPE_ORDER=["object","boolean","number","string"];const ja=new class extends Ta{compare(e,t){const n=e.node.getPriority(),i=t.node.getPriority(),r=n.compareTo(i);return 0===r?bs(e.name,t.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Ma.MIN}maxPost(){return new Ma(xs,new Fa("[PRIORITY-POST]",Va))}makePost(e,t){const n=za(e);return new Ma(t,new Fa("[PRIORITY-POST]",n))}toString(){return".priority"}},Ha=Math.log(2);class Ga{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/Ha,10)),this.current_=this.count-1;const n=(i=this.count,parseInt(Array(i+1).join("1"),2));var i;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Wa=function(e,t,n,i){e.sort(t);const r=function(t,i){const s=i-t;let a,o;if(0===s)return null;if(1===s)return a=e[t],o=n?n(a):a,new Ra(o,a.node,Ra.BLACK,null,null);{const l=parseInt(s/2,10)+t,c=r(t,l),u=r(l+1,i);return a=e[l],o=n?n(a):a,new Ra(o,a.node,Ra.BLACK,c,u)}},s=function(t){let i=null,s=null,a=e.length;const o=function(t,i){const s=a-t,o=a;a-=t;const c=r(s+1,o),u=e[s],h=n?n(u):u;l(new Ra(h,u.node,i,null,c))},l=function(e){i?(i.left=e,i=e):(s=e,i=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),i=Math.pow(2,t.count-(e+1));n?o(i,Ra.BLACK):(o(i,Ra.BLACK),o(i,Ra.RED))}return s}(new Ga(e.length));return new Pa(i||t,s)};let Ya;const qa={};class Xa{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return u(qa&&ja,"ChildrenNode.ts has not been loaded"),Ya=Ya||new Xa({".priority":qa},{".priority":ja}),Ya}get(e){const t=B(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Pa?t:null}hasIndex(e){return O(this.indexSet_,e.toString())}addIndex(e,t){u(e!==Ca,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let i=!1;const r=t.getIterator(Ma.Wrap);let s,a=r.getNext();for(;a;)i=i||e.isDefinedOn(a.node),n.push(a),a=r.getNext();s=i?Wa(n,e.getCompare()):qa;const o=e.toString(),l=Object.assign({},this.indexSet_);l[o]=e;const c=Object.assign({},this.indexes_);return c[o]=s,new Xa(c,l)}addToIndexes(e,t){const n=z(this.indexes_,((n,i)=>{const r=B(this.indexSet_,i);if(u(r,"Missing index implementation for "+i),n===qa){if(r.isDefinedOn(e.node)){const n=[],i=t.getIterator(Ma.Wrap);let s=i.getNext();for(;s;)s.name!==e.name&&n.push(s),s=i.getNext();return n.push(e),Wa(n,r.getCompare())}return qa}{const i=t.get(e.name);let r=n;return i&&(r=r.remove(new Ma(e.name,i))),r.insert(e,e.node)}}));return new Xa(n,this.indexSet_)}removeFromIndexes(e,t){const n=z(this.indexes_,(n=>{if(n===qa)return n;{const i=t.get(e.name);return i?n.remove(new Ma(e.name,i)):n}}));return new Xa(n,this.indexSet_)}}let Ka;class Ja{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Ba(this.priorityNode_),this.children_.isEmpty()&&u(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Ka||(Ka=new Ja(new Pa(ka),null,Xa.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ka}updatePriority(e){return this.children_.isEmpty()?this:new Ja(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?Ka:t}}getChild(e){const t=la(e);return null===t?this:this.getImmediateChild(t).getChild(ua(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(u(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new Ma(e,t);let i,r;t.isEmpty()?(i=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(n,this.children_)):(i=this.children_.insert(e,t),r=this.indexMap_.addToIndexes(n,this.children_));const s=i.isEmpty()?Ka:this.priorityNode_;return new Ja(i,s,r)}}updateChild(e,t){const n=la(e);if(null===n)return t;{u(".priority"!==la(e)||1===ca(e),".priority must be the last token in a path");const i=this.getImmediateChild(n).updateChild(ua(e),t);return this.updateImmediateChild(n,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,i=0,r=!0;if(this.forEachChild(ja,((s,a)=>{t[s]=a.val(e),n++,r&&Ja.INTEGER_REGEXP_.test(s)?i=Math.max(i,Number(s)):r=!1})),!e&&r&&i<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+Oa(this.getPriority().val())+":"),this.forEachChild(ja,((t,n)=>{const i=n.hash();""!==i&&(e+=":"+t+":"+i)})),this.lazyHash_=""===e?"":cs(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const i=this.resolveIndex_(n);if(i){const n=i.getPredecessorKey(new Ma(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Ma(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Ma(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,Ma.Wrap);let i=n.peek();for(;null!=i&&t.compare(i,e)<0;)n.getNext(),i=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,Ma.Wrap);let i=n.peek();for(;null!=i&&t.compare(i,e)>0;)n.getNext(),i=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===$a?-1:0}withIndex(e){if(e===Ca||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Ja(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Ca||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(ja),n=t.getIterator(ja);let i=e.getNext(),r=n.getNext();for(;i&&r;){if(i.name!==r.name||!i.node.equals(r.node))return!1;i=e.getNext(),r=n.getNext()}return null===i&&null===r}return!1}return!1}}resolveIndex_(e){return e===Ca?null:this.indexMap_.get(e.toString())}}Ja.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const $a=new class extends Ja{constructor(){super(new Pa(ka),Ja.EMPTY_NODE,Xa.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Ja.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Ma,{MIN:{value:new Ma(ws,Ja.EMPTY_NODE)},MAX:{value:new Ma(xs,$a)}}),Ea.__EMPTY_NODE=Ja.EMPTY_NODE,Fa.__childrenNodeConstructor=Ja,La=$a,function(e){Va=e}($a);const Qa=!0;function Za(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return Ja.EMPTY_NODE;if("object"===typeof e&&".priority"in e&&(t=e[".priority"]),u(null===t||"string"===typeof t||"number"===typeof t||"object"===typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"===typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!==typeof e||".sv"in e){return new Fa(e,Za(t))}if(e instanceof Array||!Qa){let n=Ja.EMPTY_NODE;return As(e,((t,i)=>{if(O(e,t)&&"."!==t.substring(0,1)){const e=Za(i);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(Za(t))}{const n=[];let i=!1;if(As(e,((e,t)=>{if("."!==e.substring(0,1)){const r=Za(t);r.isEmpty()||(i=i||!r.getPriority().isEmpty(),n.push(new Ma(e,r)))}})),0===n.length)return Ja.EMPTY_NODE;const r=Wa(n,Da,(e=>e.name),ka);if(i){const e=Wa(n,ja.getCompare());return new Ja(r,Za(t),new Xa({".priority":e},{".priority":ja}))}return new Ja(r,Za(t),Xa.Default)}}!function(e){za=e}(Za);class eo extends Ta{constructor(e){super(),this.indexPath_=e,u(!ma(e)&&".priority"!==la(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),i=this.extractChild(t.node),r=n.compareTo(i);return 0===r?bs(e.name,t.name):r}makePost(e,t){const n=Za(e),i=Ja.EMPTY_NODE.updateChild(this.indexPath_,n);return new Ma(t,i)}maxPost(){const e=Ja.EMPTY_NODE.updateChild(this.indexPath_,$a);return new Ma(xs,e)}toString(){return da(this.indexPath_,0).join("/")}}const to=new class extends Ta{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?bs(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Ma.MIN}maxPost(){return Ma.MAX}makePost(e,t){const n=Za(e);return new Ma(t,n)}toString(){return".value"}};function no(e){return{type:"value",snapshotNode:e}}function io(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function ro(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function so(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class ao{constructor(e){this.index_=e}updateChild(e,t,n,i,r,s){u(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(i).equals(n.getChild(i))&&a.isEmpty()===n.isEmpty()?e:(null!=s&&(n.isEmpty()?e.hasChild(t)?s.trackChildChange(ro(t,a)):u(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?s.trackChildChange(io(t,n)):s.trackChildChange(so(t,n,a))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(ja,((e,i)=>{t.hasChild(e)||n.trackChildChange(ro(e,i))})),t.isLeafNode()||t.forEachChild(ja,((t,i)=>{if(e.hasChild(t)){const r=e.getImmediateChild(t);r.equals(i)||n.trackChildChange(so(t,i,r))}else n.trackChildChange(io(t,i))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Ja.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class oo{constructor(e){this.indexedFilter_=new ao(e.getIndex()),this.index_=e.getIndex(),this.startPost_=oo.getStartPost_(e),this.endPost_=oo.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}updateChild(e,t,n,i,r,s){return this.matches(new Ma(t,n))||(n=Ja.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,i,r,s)}updateFullNode(e,t,n){t.isLeafNode()&&(t=Ja.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(Ja.EMPTY_NODE);const r=this;return t.forEachChild(ja,((e,t)=>{r.matches(new Ma(e,t))||(i=i.updateImmediateChild(e,Ja.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,i,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class lo{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{const t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new oo(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,n,i,r,s){return this.rangedFilter_.matches(new Ma(t,n))||(n=Ja.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,i,r,s):this.fullLimitUpdateChild_(e,t,n,r,s)}updateFullNode(e,t,n){let i;if(t.isLeafNode()||t.isEmpty())i=Ja.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;i=Ja.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();if(this.withinDirectionalStart(t)){if(!this.withinDirectionalEnd(t))break;i=i.updateImmediateChild(t.name,t.node),n++}}}else{let e;i=t.withIndex(this.index_),i=i.updatePriority(Ja.EMPTY_NODE),e=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let n=0;for(;e.hasNext();){const t=e.getNext();n<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t)?n++:i=i.updateImmediateChild(t.name,Ja.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,i,r){let s;if(this.reverse_){const e=this.index_.getCompare();s=(t,n)=>e(n,t)}else s=this.index_.getCompare();const a=e;u(a.numChildren()===this.limit_,"");const o=new Ma(t,n),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),c=this.rangedFilter_.matches(o);if(a.hasChild(t)){const e=a.getImmediateChild(t);let u=i.getChildAfterChild(this.index_,l,this.reverse_);for(;null!=u&&(u.name===t||a.hasChild(u.name));)u=i.getChildAfterChild(this.index_,u,this.reverse_);const h=null==u?1:s(u,o);if(c&&!n.isEmpty()&&h>=0)return null!=r&&r.trackChildChange(so(t,n,e)),a.updateImmediateChild(t,n);{null!=r&&r.trackChildChange(ro(t,e));const n=a.updateImmediateChild(t,Ja.EMPTY_NODE);return null!=u&&this.rangedFilter_.matches(u)?(null!=r&&r.trackChildChange(io(u.name,u.node)),n.updateImmediateChild(u.name,u.node)):n}}return n.isEmpty()?e:c&&s(l,o)>=0?(null!=r&&(r.trackChildChange(ro(l.name,l.node)),r.trackChildChange(io(t,n))),a.updateImmediateChild(t,n).updateImmediateChild(l.name,Ja.EMPTY_NODE)):e}}class co{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ja}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return u(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return u(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ws}hasEnd(){return this.endSet_}getIndexEndValue(){return u(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return u(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:xs}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return u(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ja}copy(){const e=new co;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function uo(e,t,n){const i=e.copy();return i.startSet_=!0,void 0===t&&(t=null),i.indexStartValue_=t,null!=n?(i.startNameSet_=!0,i.indexStartName_=n):(i.startNameSet_=!1,i.indexStartName_=""),i}function ho(e,t,n){const i=e.copy();return i.endSet_=!0,void 0===t&&(t=null),i.indexEndValue_=t,void 0!==n?(i.endNameSet_=!0,i.indexEndName_=n):(i.endNameSet_=!1,i.indexEndName_=""),i}function po(e,t){const n=e.copy();return n.index_=t,n}function fo(e){const t={};if(e.isDefault())return t;let n;if(e.index_===ja?n="$priority":e.index_===to?n="$value":e.index_===Ca?n="$key":(u(e.index_ instanceof eo,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=k(n),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=k(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+k(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=k(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+k(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function mo(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==ja&&(t.i=e.index_.toString()),t}class go extends ta{constructor(e,t,n,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=i,this.log_=ms("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(u(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,i){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const s=go.getListenId_(e,n),a={};this.listens_[s]=a;const o=fo(e._queryParams);this.restRequest_(r+".json",o,((e,t)=>{let o=t;if(404===e&&(o=null,e=null),null===e&&this.onDataUpdate_(r,o,!1,n),B(this.listens_,s)===a){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",i(t,null)}}))}unlisten(e,t){const n=go.getListenId_(e,t);delete this.listens_[n]}get(e){const t=fo(e._queryParams),n=e._path.toString(),i=new M;return this.restRequest_(n+".json",t,((e,t)=>{let r=t;404===e&&(r=null,e=null),null===e?(this.onDataUpdate_(n,r,!1,null),i.resolve(r)):i.reject(new Error(r))})),i.promise}refreshAuthToken(e){}restRequest_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((i=>{let[r,s]=i;r&&r.accessToken&&(t.auth=r.accessToken),s&&s.token&&(t.ac=s.token);const a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+j(t);this.log_("Sending REST request for "+a);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&4===o.readyState){this.log_("REST Response for "+a+" received. status:",o.status,"response:",o.responseText);let t=null;if(o.status>=200&&o.status<300){try{t=D(o.responseText)}catch(e){ys("Failed to parse JSON response for "+a+": "+o.responseText)}n(null,t)}else 401!==o.status&&404!==o.status&&ys("Got unsuccessful REST response for "+a+" Status: "+o.status),n(o.status);n=null}},o.open("GET",a,!0),o.send()}))}}class vo{constructor(){this.rootNode_=Ja.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function yo(){return{value:null,children:new Map}}function _o(e,t,n){if(ma(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const i=la(t);e.children.has(i)||e.children.set(i,yo());_o(e.children.get(i),t=ua(t),n)}}function wo(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}(e,((e,i)=>{wo(i,new aa(t.toString()+"/"+e),n)}))}class xo{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&As(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}class bo{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new xo(e);const n=1e4+2e4*Math.random();Ps(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;As(e,((e,i)=>{i>0&&O(this.statsToReport_,e)&&(t[e]=i,n=!0)})),n&&this.server_.reportStats(t),Ps(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var So;function No(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(So||(So={}));class Mo{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=So.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(ma(this.path)){if(null!=this.affectedTree.value)return u(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new aa(e));return new Mo(oa(),t,this.revert)}}return u(la(this.path)===e,"operationForChild called for unrelated child."),new Mo(ua(this.path),this.affectedTree,this.revert)}}class To{constructor(e,t){this.source=e,this.path=t,this.type=So.LISTEN_COMPLETE}operationForChild(e){return ma(this.path)?new To(this.source,oa()):new To(this.source,ua(this.path))}}class Ao{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=So.OVERWRITE}operationForChild(e){return ma(this.path)?new Ao(this.source,oa(),this.snap.getImmediateChild(e)):new Ao(this.source,ua(this.path),this.snap)}}class Eo{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=So.MERGE}operationForChild(e){if(ma(this.path)){const t=this.children.subtree(new aa(e));return t.isEmpty()?null:t.value?new Ao(this.source,oa(),t.value):new Eo(this.source,oa(),t)}return u(la(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Eo(this.source,ua(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Co{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ma(e))return this.isFullyInitialized()&&!this.filtered_;const t=la(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Io{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Ro(e,t,n,i,r,s){const a=i.filter((e=>e.type===n));a.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw h("Should only compare child_ events.");const i=new Ma(t.childName,t.snapshotNode),r=new Ma(n.childName,n.snapshotNode);return e.index_.compare(i,r)}(e,t,n))),a.forEach((n=>{const i=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,s);r.forEach((r=>{r.respondsTo(n.type)&&t.push(r.createEvent(i,e.query_))}))}))}function Po(e,t){return{eventCache:e,serverCache:t}}function Do(e,t,n,i){return Po(new Co(t,n,i),e.serverCache)}function ko(e,t,n,i){return Po(e.eventCache,new Co(t,n,i))}function Lo(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Oo(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let Bo;class Uo{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(Bo||(Bo=new Pa(Ss)),Bo);this.value=e,this.children=t}static fromObject(e){let t=new Uo(null);return As(e,((e,n)=>{t=t.set(new aa(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:oa(),value:this.value};if(ma(e))return null;{const n=la(e),i=this.children.get(n);if(null!==i){const r=i.findRootMostMatchingPathAndValue(ua(e),t);if(null!=r){return{path:fa(new aa(n),r.path),value:r.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(ma(e))return this;{const t=la(e),n=this.children.get(t);return null!==n?n.subtree(ua(e)):new Uo(null)}}set(e,t){if(ma(e))return new Uo(t,this.children);{const n=la(e),i=(this.children.get(n)||new Uo(null)).set(ua(e),t),r=this.children.insert(n,i);return new Uo(this.value,r)}}remove(e){if(ma(e))return this.children.isEmpty()?new Uo(null):new Uo(null,this.children);{const t=la(e),n=this.children.get(t);if(n){const i=n.remove(ua(e));let r;return r=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&r.isEmpty()?new Uo(null):new Uo(this.value,r)}return this}}get(e){if(ma(e))return this.value;{const t=la(e),n=this.children.get(t);return n?n.get(ua(e)):null}}setTree(e,t){if(ma(e))return t;{const n=la(e),i=(this.children.get(n)||new Uo(null)).setTree(ua(e),t);let r;return r=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),new Uo(this.value,r)}}fold(e){return this.fold_(oa(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((i,r)=>{n[i]=r.fold_(fa(e,i),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,oa(),t)}findOnPath_(e,t,n){const i=!!this.value&&n(t,this.value);if(i)return i;if(ma(e))return null;{const i=la(e),r=this.children.get(i);return r?r.findOnPath_(ua(e),fa(t,i),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,oa(),t)}foreachOnPath_(e,t,n){if(ma(e))return this;{this.value&&n(t,this.value);const i=la(e),r=this.children.get(i);return r?r.foreachOnPath_(ua(e),fa(t,i),n):new Uo(null)}}foreach(e){this.foreach_(oa(),e)}foreach_(e,t){this.children.inorderTraversal(((n,i)=>{i.foreach_(fa(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}class zo{constructor(e){this.writeTree_=e}static empty(){return new zo(new Uo(null))}}function Vo(e,t,n){if(ma(t))return new zo(new Uo(n));{const i=e.writeTree_.findRootMostValueAndPath(t);if(null!=i){const r=i.path;let s=i.value;const a=ga(r,t);return s=s.updateChild(a,n),new zo(e.writeTree_.set(r,s))}{const i=new Uo(n),r=e.writeTree_.setTree(t,i);return new zo(r)}}}function Fo(e,t,n){let i=e;return As(n,((e,n)=>{i=Vo(i,fa(t,e),n)})),i}function jo(e,t){if(ma(t))return zo.empty();{const n=e.writeTree_.setTree(t,new Uo(null));return new zo(n)}}function Ho(e,t){return null!=Go(e,t)}function Go(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(ga(n.path,t)):null}function Wo(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(ja,((e,n)=>{t.push(new Ma(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new Ma(e,n.value))})),t}function Yo(e,t){if(ma(t))return e;{const n=Go(e,t);return new zo(null!=n?new Uo(n):e.writeTree_.subtree(t))}}function qo(e){return e.writeTree_.isEmpty()}function Xo(e,t){return Ko(oa(),e.writeTree_,t)}function Ko(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let i=null;return t.children.inorderTraversal(((t,r)=>{".priority"===t?(u(null!==r.value,"Priority writes must always be leaf nodes"),i=r.value):n=Ko(fa(e,t),r,n)})),n.getChild(e).isEmpty()||null===i||(n=n.updateChild(fa(e,".priority"),i)),n}}function Jo(e,t){return cl(t,e)}function $o(e,t){const n=e.allWrites.findIndex((e=>e.writeId===t));u(n>=0,"removeWrite called with nonexistent writeId.");const i=e.allWrites[n];e.allWrites.splice(n,1);let r=i.visible,s=!1,a=e.allWrites.length-1;for(;r&&a>=0;){const t=e.allWrites[a];t.visible&&(a>=n&&Qo(t,i.path)?r=!1:ya(i.path,t.path)&&(s=!0)),a--}if(r){if(s)return function(e){e.visibleWrites=el(e.allWrites,Zo,oa()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;if(i.snap)e.visibleWrites=jo(e.visibleWrites,i.path);else{As(i.children,(t=>{e.visibleWrites=jo(e.visibleWrites,fa(i.path,t))}))}return!0}return!1}function Qo(e,t){if(e.snap)return ya(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&ya(fa(e.path,n),t))return!0;return!1}function Zo(e){return e.visible}function el(e,t,n){let i=zo.empty();for(let r=0;r<e.length;++r){const s=e[r];if(t(s)){const e=s.path;let t;if(s.snap)ya(n,e)?(t=ga(n,e),i=Vo(i,t,s.snap)):ya(e,n)&&(t=ga(e,n),i=Vo(i,oa(),s.snap.getChild(t)));else{if(!s.children)throw h("WriteRecord should have .snap or .children");if(ya(n,e))t=ga(n,e),i=Fo(i,t,s.children);else if(ya(e,n))if(t=ga(e,n),ma(t))i=Fo(i,oa(),s.children);else{const e=B(s.children,la(t));if(e){const n=e.getChild(ua(t));i=Vo(i,oa(),n)}}}}}return i}function tl(e,t,n,i,r){if(i||r){const s=Yo(e.visibleWrites,t);if(!r&&qo(s))return n;if(r||null!=n||Ho(s,oa())){const s=function(e){return(e.visible||r)&&(!i||!~i.indexOf(e.writeId))&&(ya(e.path,t)||ya(t,e.path))};return Xo(el(e.allWrites,s,t),n||Ja.EMPTY_NODE)}return null}{const i=Go(e.visibleWrites,t);if(null!=i)return i;{const i=Yo(e.visibleWrites,t);if(qo(i))return n;if(null!=n||Ho(i,oa())){return Xo(i,n||Ja.EMPTY_NODE)}return null}}}function nl(e,t,n,i){return tl(e.writeTree,e.treePath,t,n,i)}function il(e,t){return function(e,t,n){let i=Ja.EMPTY_NODE;const r=Go(e.visibleWrites,t);if(r)return r.isLeafNode()||r.forEachChild(ja,((e,t)=>{i=i.updateImmediateChild(e,t)})),i;if(n){const r=Yo(e.visibleWrites,t);return n.forEachChild(ja,((e,t)=>{const n=Xo(Yo(r,new aa(e)),t);i=i.updateImmediateChild(e,n)})),Wo(r).forEach((e=>{i=i.updateImmediateChild(e.name,e.node)})),i}return Wo(Yo(e.visibleWrites,t)).forEach((e=>{i=i.updateImmediateChild(e.name,e.node)})),i}(e.writeTree,e.treePath,t)}function rl(e,t,n,i){return function(e,t,n,i,r){u(i||r,"Either existingEventSnap or existingServerSnap must exist");const s=fa(t,n);if(Ho(e.visibleWrites,s))return null;{const t=Yo(e.visibleWrites,s);return qo(t)?r.getChild(n):Xo(t,r.getChild(n))}}(e.writeTree,e.treePath,t,n,i)}function sl(e,t){return function(e,t){return Go(e.visibleWrites,t)}(e.writeTree,fa(e.treePath,t))}function al(e,t,n,i,r,s){return function(e,t,n,i,r,s,a){let o;const l=Yo(e.visibleWrites,t),c=Go(l,oa());if(null!=c)o=c;else{if(null==n)return[];o=Xo(l,n)}if(o=o.withIndex(a),o.isEmpty()||o.isLeafNode())return[];{const e=[],t=a.getCompare(),n=s?o.getReverseIteratorFrom(i,a):o.getIteratorFrom(i,a);let l=n.getNext();for(;l&&e.length<r;)0!==t(l,i)&&e.push(l),l=n.getNext();return e}}(e.writeTree,e.treePath,t,n,i,r,s)}function ol(e,t,n){return function(e,t,n,i){const r=fa(t,n),s=Go(e.visibleWrites,r);if(null!=s)return s;if(i.isCompleteForChild(n))return Xo(Yo(e.visibleWrites,r),i.getNode().getImmediateChild(n));return null}(e.writeTree,e.treePath,t,n)}function ll(e,t){return cl(fa(e.treePath,t),e.writeTree)}function cl(e,t){return{treePath:e,writeTree:t}}class ul{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;u("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),u(".priority"!==n,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(n);if(i){const r=i.type;if("child_added"===t&&"child_removed"===r)this.changeMap.set(n,so(n,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===r)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===r)this.changeMap.set(n,ro(n,i.oldSnap));else if("child_changed"===t&&"child_added"===r)this.changeMap.set(n,io(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==r)throw h("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(n,so(n,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}const hl=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class dl{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new Co(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return ol(this.writes_,e,t)}}getChildAfterChild(e,t,n){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Oo(this.viewCache_),r=al(this.writes_,i,t,1,n,e);return 0===r.length?null:r[0]}}function pl(e,t,n,i,r){const s=new ul;let a,o;if(n.type===So.OVERWRITE){const l=n;l.source.fromUser?a=gl(e,t,l.path,l.snap,i,r,s):(u(l.source.fromServer,"Unknown source."),o=l.source.tagged||t.serverCache.isFiltered()&&!ma(l.path),a=ml(e,t,l.path,l.snap,i,r,o,s))}else if(n.type===So.MERGE){const l=n;l.source.fromUser?a=function(e,t,n,i,r,s,a){let o=t;return i.foreach(((i,l)=>{const c=fa(n,i);vl(t,la(c))&&(o=gl(e,o,c,l,r,s,a))})),i.foreach(((i,l)=>{const c=fa(n,i);vl(t,la(c))||(o=gl(e,o,c,l,r,s,a))})),o}(e,t,l.path,l.children,i,r,s):(u(l.source.fromServer,"Unknown source."),o=l.source.tagged||t.serverCache.isFiltered(),a=_l(e,t,l.path,l.children,i,r,o,s))}else if(n.type===So.ACK_USER_WRITE){const o=n;a=o.revert?function(e,t,n,i,r,s){let a;if(null!=sl(i,n))return t;{const o=new dl(i,t,r),l=t.eventCache.getNode();let c;if(ma(n)||".priority"===la(n)){let n;if(t.serverCache.isFullyInitialized())n=nl(i,Oo(t));else{const e=t.serverCache.getNode();u(e instanceof Ja,"serverChildren would be complete if leaf node"),n=il(i,e)}c=e.filter.updateFullNode(l,n,s)}else{const r=la(n);let u=ol(i,r,t.serverCache);null==u&&t.serverCache.isCompleteForChild(r)&&(u=l.getImmediateChild(r)),c=null!=u?e.filter.updateChild(l,r,u,ua(n),o,s):t.eventCache.getNode().hasChild(r)?e.filter.updateChild(l,r,Ja.EMPTY_NODE,ua(n),o,s):l,c.isEmpty()&&t.serverCache.isFullyInitialized()&&(a=nl(i,Oo(t)),a.isLeafNode()&&(c=e.filter.updateFullNode(c,a,s)))}return a=t.serverCache.isFullyInitialized()||null!=sl(i,oa()),Do(t,c,a,e.filter.filtersNodes())}}(e,t,o.path,i,r,s):function(e,t,n,i,r,s,a){if(null!=sl(r,n))return t;const o=t.serverCache.isFiltered(),l=t.serverCache;if(null!=i.value){if(ma(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return ml(e,t,n,l.getNode().getChild(n),r,s,o,a);if(ma(n)){let i=new Uo(null);return l.getNode().forEachChild(Ca,((e,t)=>{i=i.set(new aa(e),t)})),_l(e,t,n,i,r,s,o,a)}return t}{let c=new Uo(null);return i.foreach(((e,t)=>{const i=fa(n,e);l.isCompleteForPath(i)&&(c=c.set(e,l.getNode().getChild(i)))})),_l(e,t,n,c,r,s,o,a)}}(e,t,o.path,o.affectedTree,i,r,s)}else{if(n.type!==So.LISTEN_COMPLETE)throw h("Unknown operation type: "+n.type);a=function(e,t,n,i,r){const s=t.serverCache,a=ko(t,s.getNode(),s.isFullyInitialized()||ma(n),s.isFiltered());return fl(e,a,n,i,hl,r)}(e,t,n.path,i,s)}const l=s.getChanges();return function(e,t,n){const i=t.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=Lo(e);(n.length>0||!e.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&n.push(no(Lo(t)))}}(t,a,l),{viewCache:a,changes:l}}function fl(e,t,n,i,r,s){const a=t.eventCache;if(null!=sl(i,n))return t;{let o,l;if(ma(n))if(u(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=Oo(t),r=il(i,n instanceof Ja?n:Ja.EMPTY_NODE);o=e.filter.updateFullNode(t.eventCache.getNode(),r,s)}else{const n=nl(i,Oo(t));o=e.filter.updateFullNode(t.eventCache.getNode(),n,s)}else{const c=la(n);if(".priority"===c){u(1===ca(n),"Can't have a priority with additional path components");const r=a.getNode();l=t.serverCache.getNode();const s=rl(i,n,r,l);o=null!=s?e.filter.updatePriority(r,s):a.getNode()}else{const u=ua(n);let h;if(a.isCompleteForChild(c)){l=t.serverCache.getNode();const e=rl(i,n,a.getNode(),l);h=null!=e?a.getNode().getImmediateChild(c).updateChild(u,e):a.getNode().getImmediateChild(c)}else h=ol(i,c,t.serverCache);o=null!=h?e.filter.updateChild(a.getNode(),c,h,u,r,s):a.getNode()}}return Do(t,o,a.isFullyInitialized()||ma(n),e.filter.filtersNodes())}}function ml(e,t,n,i,r,s,a,o){const l=t.serverCache;let c;const u=a?e.filter:e.filter.getIndexedFilter();if(ma(n))c=u.updateFullNode(l.getNode(),i,null);else if(u.filtersNodes()&&!l.isFiltered()){const e=l.getNode().updateChild(n,i);c=u.updateFullNode(l.getNode(),e,null)}else{const e=la(n);if(!l.isCompleteForPath(n)&&ca(n)>1)return t;const r=ua(n),s=l.getNode().getImmediateChild(e).updateChild(r,i);c=".priority"===e?u.updatePriority(l.getNode(),s):u.updateChild(l.getNode(),e,s,r,hl,null)}const h=ko(t,c,l.isFullyInitialized()||ma(n),u.filtersNodes());return fl(e,h,n,r,new dl(r,h,s),o)}function gl(e,t,n,i,r,s,a){const o=t.eventCache;let l,c;const u=new dl(r,t,s);if(ma(n))c=e.filter.updateFullNode(t.eventCache.getNode(),i,a),l=Do(t,c,!0,e.filter.filtersNodes());else{const r=la(n);if(".priority"===r)c=e.filter.updatePriority(t.eventCache.getNode(),i),l=Do(t,c,o.isFullyInitialized(),o.isFiltered());else{const s=ua(n),c=o.getNode().getImmediateChild(r);let h;if(ma(s))h=i;else{const e=u.getCompleteChild(r);h=null!=e?".priority"===ha(s)&&e.getChild(pa(s)).isEmpty()?e:e.updateChild(s,i):Ja.EMPTY_NODE}if(c.equals(h))l=t;else{l=Do(t,e.filter.updateChild(o.getNode(),r,h,s,u,a),o.isFullyInitialized(),e.filter.filtersNodes())}}}return l}function vl(e,t){return e.eventCache.isCompleteForChild(t)}function yl(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function _l(e,t,n,i,r,s,a,o){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l,c=t;l=ma(n)?i:new Uo(null).setTree(n,i);const u=t.serverCache.getNode();return l.children.inorderTraversal(((n,i)=>{if(u.hasChild(n)){const l=yl(0,t.serverCache.getNode().getImmediateChild(n),i);c=ml(e,c,new aa(n),l,r,s,a,o)}})),l.children.inorderTraversal(((n,i)=>{const l=!t.serverCache.isCompleteForChild(n)&&null===i.value;if(!u.hasChild(n)&&!l){const l=yl(0,t.serverCache.getNode().getImmediateChild(n),i);c=ml(e,c,new aa(n),l,r,s,a,o)}})),c}class wl{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,i=new ao(n.getIndex()),r=(s=n).loadsAllData()?new ao(s.getIndex()):s.hasLimit()?new lo(s):new oo(s);var s;this.processor_=function(e){return{filter:e}}(r);const a=t.serverCache,o=t.eventCache,l=i.updateFullNode(Ja.EMPTY_NODE,a.getNode(),null),c=r.updateFullNode(Ja.EMPTY_NODE,o.getNode(),null),u=new Co(l,a.isFullyInitialized(),i.filtersNodes()),h=new Co(c,o.isFullyInitialized(),r.filtersNodes());this.viewCache_=Po(h,u),this.eventGenerator_=new Io(this.query_)}get query(){return this.query_}}function xl(e,t){const n=Oo(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!ma(t)&&!n.getImmediateChild(la(t)).isEmpty())?n.getChild(t):null}function bl(e){return 0===e.eventRegistrations_.length}function Sl(e,t,n){const i=[];if(n){u(null==t,"A cancel should cancel all event registrations.");const r=e.query._path;e.eventRegistrations_.forEach((e=>{const t=e.createCancelEvent(n,r);t&&i.push(t)}))}if(t){let n=[];for(let i=0;i<e.eventRegistrations_.length;++i){const r=e.eventRegistrations_[i];if(r.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(i+1));break}}else n.push(r)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return i}function Nl(e,t,n,i){t.type===So.MERGE&&null!==t.source.queryId&&(u(Oo(e.viewCache_),"We should always have a full cache before handling merges"),u(Lo(e.viewCache_),"Missing event cache, even though we have a server cache"));const r=e.viewCache_,s=pl(e.processor_,r,t,n,i);var a,o;return a=e.processor_,o=s.viewCache,u(o.eventCache.getNode().isIndexed(a.filter.getIndex()),"Event snap not indexed"),u(o.serverCache.getNode().isIndexed(a.filter.getIndex()),"Server snap not indexed"),u(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,Ml(e,s.changes,s.viewCache.eventCache.getNode(),null)}function Ml(e,t,n,i){const r=i?[i]:e.eventRegistrations_;return function(e,t,n,i){const r=[],s=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&s.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),Ro(e,r,"child_removed",t,i,n),Ro(e,r,"child_added",t,i,n),Ro(e,r,"child_moved",s,i,n),Ro(e,r,"child_changed",t,i,n),Ro(e,r,"value",t,i,n),r}(e.eventGenerator_,t,n,r)}let Tl,Al;class El{constructor(){this.views=new Map}}function Cl(e,t,n,i){const r=t.source.queryId;if(null!==r){const s=e.views.get(r);return u(null!=s,"SyncTree gave us an op for an invalid query."),Nl(s,t,n,i)}{let r=[];for(const s of e.views.values())r=r.concat(Nl(s,t,n,i));return r}}function Il(e,t,n,i,r){const s=t._queryIdentifier,a=e.views.get(s);if(!a){let e=nl(n,r?i:null),s=!1;e?s=!0:i instanceof Ja?(e=il(n,i),s=!1):(e=Ja.EMPTY_NODE,s=!1);const a=Po(new Co(e,s,!1),new Co(i,r,!1));return new wl(t,a)}return a}function Rl(e,t,n,i,r,s){const a=Il(e,t,i,r,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,a),function(e,t){e.eventRegistrations_.push(t)}(a,n),function(e,t){const n=e.viewCache_.eventCache,i=[];n.getNode().isLeafNode()||n.getNode().forEachChild(ja,((e,t)=>{i.push(io(e,t))}));return n.isFullyInitialized()&&i.push(no(n.getNode())),Ml(e,i,n.getNode(),t)}(a,n)}function Pl(e,t,n,i){const r=t._queryIdentifier,s=[];let a=[];const o=Bl(e);if("default"===r)for(const[l,c]of e.views.entries())a=a.concat(Sl(c,n,i)),bl(c)&&(e.views.delete(l),c.query._queryParams.loadsAllData()||s.push(c.query));else{const t=e.views.get(r);t&&(a=a.concat(Sl(t,n,i)),bl(t)&&(e.views.delete(r),t.query._queryParams.loadsAllData()||s.push(t.query)))}return o&&!Bl(e)&&s.push(new(u(Tl,"Reference.ts has not been loaded"),Tl)(t._repo,t._path)),{removed:s,events:a}}function Dl(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function kl(e,t){let n=null;for(const i of e.views.values())n=n||xl(i,t);return n}function Ll(e,t){if(t._queryParams.loadsAllData())return Ul(e);{const n=t._queryIdentifier;return e.views.get(n)}}function Ol(e,t){return null!=Ll(e,t)}function Bl(e){return null!=Ul(e)}function Ul(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let zl=1;class Vl{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Uo(null),this.pendingWriteTree_={visibleWrites:zo.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Fl(e,t,n,i,r){return function(e,t,n,i,r){u(i>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),e.allWrites.push({path:t,snap:n,writeId:i,visible:r}),r&&(e.visibleWrites=Vo(e.visibleWrites,t,n)),e.lastWriteId=i}(e.pendingWriteTree_,t,n,i,r),r?Kl(e,new Ao({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function jl(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=function(e,t){for(let n=0;n<e.allWrites.length;n++){const i=e.allWrites[n];if(i.writeId===t)return i}return null}(e.pendingWriteTree_,t);if($o(e.pendingWriteTree_,t)){let t=new Uo(null);return null!=i.snap?t=t.set(oa(),!0):As(i.children,(e=>{t=t.set(new aa(e),!0)})),Kl(e,new Mo(i.path,t,n))}return[]}function Hl(e,t,n){return Kl(e,new Ao({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function Gl(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=t._path,a=e.syncPointTree_.get(s);let o=[];if(a&&("default"===t._queryIdentifier||Ol(a,t))){const l=Pl(a,t,n,i);0===a.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(s));const c=l.removed;if(o=l.events,!r){const n=-1!==c.findIndex((e=>e._queryParams.loadsAllData())),r=e.syncPointTree_.findOnPath(s,((e,t)=>Bl(t)));if(n&&!r){const t=e.syncPointTree_.subtree(s);if(!t.isEmpty()){const n=function(e){return e.fold(((e,t,n)=>{if(t&&Bl(t)){return[Ul(t)]}{let e=[];return t&&(e=Dl(t)),As(n,((t,n)=>{e=e.concat(n)})),e}}))}(t);for(let t=0;t<n.length;++t){const i=n[t],r=i.query,s=Ql(e,i);e.listenProvider_.startListening(rc(r),Zl(e,r),s.hashFn,s.onComplete)}}}if(!r&&c.length>0&&!i)if(n){const n=null;e.listenProvider_.stopListening(rc(t),n)}else c.forEach((t=>{const n=e.queryToTagMap.get(ec(t));e.listenProvider_.stopListening(rc(t),n)}))}!function(e,t){for(let n=0;n<t.length;++n){const i=t[n];if(!i._queryParams.loadsAllData()){const t=ec(i),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,c)}return o}function Wl(e,t,n,i){const r=tc(e,i);if(null!=r){const i=nc(r),s=i.path,a=i.queryId,o=ga(s,t);return ic(e,s,new Ao(No(a),o,n))}return[]}function Yl(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=t._path;let s=null,a=!1;e.syncPointTree_.foreachOnPath(r,((e,t)=>{const n=ga(e,r);s=s||kl(t,n),a=a||Bl(t)}));let o,l=e.syncPointTree_.get(r);if(l?(a=a||Bl(l),s=s||kl(l,oa())):(l=new El,e.syncPointTree_=e.syncPointTree_.set(r,l)),null!=s)o=!0;else{o=!1,s=Ja.EMPTY_NODE;e.syncPointTree_.subtree(r).foreachChild(((e,t)=>{const n=kl(t,oa());n&&(s=s.updateImmediateChild(e,n))}))}const c=Ol(l,t);if(!c&&!t._queryParams.loadsAllData()){const n=ec(t);u(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const i=zl++;e.queryToTagMap.set(n,i),e.tagToQueryMap.set(i,n)}let h=Rl(l,t,n,Jo(e.pendingWriteTree_,r),s,o);if(!c&&!a&&!i){const n=Ll(l,t);h=h.concat(function(e,t,n){const i=t._path,r=Zl(e,t),s=Ql(e,n),a=e.listenProvider_.startListening(rc(t),r,s.hashFn,s.onComplete),o=e.syncPointTree_.subtree(i);if(r)u(!Bl(o.value),"If we're adding a query, it shouldn't be shadowed");else{const t=o.fold(((e,t,n)=>{if(!ma(e)&&t&&Bl(t))return[Ul(t).query];{let e=[];return t&&(e=e.concat(Dl(t).map((e=>e.query)))),As(n,((t,n)=>{e=e.concat(n)})),e}}));for(let n=0;n<t.length;++n){const i=t[n];e.listenProvider_.stopListening(rc(i),Zl(e,i))}}return a}(e,t,n))}return h}function ql(e,t,n){const i=e.pendingWriteTree_,r=e.syncPointTree_.findOnPath(t,((e,n)=>{const i=kl(n,ga(e,t));if(i)return i}));return tl(i,t,r,n,!0)}function Xl(e,t){const n=t._path;let i=null;e.syncPointTree_.foreachOnPath(n,((e,t)=>{const r=ga(e,n);i=i||kl(t,r)}));let r=e.syncPointTree_.get(n);r?i=i||kl(r,oa()):(r=new El,e.syncPointTree_=e.syncPointTree_.set(n,r));const s=null!=i,a=s?new Co(i,!0,!1):null;return function(e){return Lo(e.viewCache_)}(Il(r,t,Jo(e.pendingWriteTree_,t._path),s?a.getNode():Ja.EMPTY_NODE,s))}function Kl(e,t){return Jl(t,e.syncPointTree_,null,Jo(e.pendingWriteTree_,oa()))}function Jl(e,t,n,i){if(ma(e.path))return $l(e,t,n,i);{const r=t.get(oa());null==n&&null!=r&&(n=kl(r,oa()));let s=[];const a=la(e.path),o=e.operationForChild(a),l=t.children.get(a);if(l&&o){const e=n?n.getImmediateChild(a):null,t=ll(i,a);s=s.concat(Jl(o,l,e,t))}return r&&(s=s.concat(Cl(r,e,i,n))),s}}function $l(e,t,n,i){const r=t.get(oa());null==n&&null!=r&&(n=kl(r,oa()));let s=[];return t.children.inorderTraversal(((t,r)=>{const a=n?n.getImmediateChild(t):null,o=ll(i,t),l=e.operationForChild(t);l&&(s=s.concat($l(l,r,a,o)))})),r&&(s=s.concat(Cl(r,e,i,n))),s}function Ql(e,t){const n=t.query,i=Zl(e,n);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||Ja.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return i?function(e,t,n){const i=tc(e,n);if(i){const n=nc(i),r=n.path,s=n.queryId,a=ga(r,t);return ic(e,r,new To(No(s),a))}return[]}(e,n._path,i):function(e,t){return Kl(e,new To({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const i=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const i=new Error(e+" at "+t._path.toString()+": "+n);return i.code=e.toUpperCase(),i}(t,n);return Gl(e,n,null,i)}}}}function Zl(e,t){const n=ec(t);return e.queryToTagMap.get(n)}function ec(e){return e._path.toString()+"$"+e._queryIdentifier}function tc(e,t){return e.tagToQueryMap.get(t)}function nc(e){const t=e.indexOf("$");return u(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new aa(e.substr(0,t))}}function ic(e,t,n){const i=e.syncPointTree_.get(t);u(i,"Missing sync point for query tag that we're tracking");return Cl(i,n,Jo(e.pendingWriteTree_,t),null)}function rc(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(u(Al,"Reference.ts has not been loaded"),Al)(e._repo,e._path):e}class sc{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new sc(t)}node(){return this.node_}}class ac{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=fa(this.path_,e);return new ac(this.syncTree_,t)}node(){return ql(this.syncTree_,this.path_)}}const oc=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},lc=function(e,t,n){return e&&"object"===typeof e?(u(".sv"in e,"Unexpected leaf node or priority contents"),"string"===typeof e[".sv"]?cc(e[".sv"],t,n):"object"===typeof e[".sv"]?uc(e[".sv"],t):void u(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},cc=function(e,t,n){if("timestamp"===e)return n.timestamp;u(!1,"Unexpected server value: "+e)},uc=function(e,t,n){e.hasOwnProperty("increment")||u(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const i=e.increment;"number"!==typeof i&&u(!1,"Unexpected increment value: "+i);const r=t.node();if(u(null!==r&&"undefined"!==typeof r,"Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const s=r.getValue();return"number"!==typeof s?i:s+i},hc=function(e,t,n,i){return pc(t,new ac(n,e),i)},dc=function(e,t,n){return pc(e,new sc(t),n)};function pc(e,t,n){const i=e.getPriority().val(),r=lc(i,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const i=e,s=lc(i.getValue(),t,n);return s!==i.getValue()||r!==i.getPriority().val()?new Fa(s,Za(r)):e}{const i=e;return s=i,r!==i.getPriority().val()&&(s=s.updatePriority(new Fa(r))),i.forEachChild(ja,((e,i)=>{const r=pc(i,t.getImmediateChild(e),n);r!==i&&(s=s.updateImmediateChild(e,r))})),s}}class fc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};this.name=e,this.parent=t,this.node=n}}function mc(e,t){let n=t instanceof aa?t:new aa(t),i=e,r=la(n);for(;null!==r;){const e=B(i.node.children,r)||{children:{},childCount:0};i=new fc(r,i,e),n=ua(n),r=la(n)}return i}function gc(e){return e.node.value}function vc(e,t){e.node.value=t,bc(e)}function yc(e){return e.node.childCount>0}function _c(e,t){As(e.node.children,((n,i)=>{t(new fc(n,e,i))}))}function wc(e,t,n,i){n&&!i&&t(e),_c(e,(e=>{wc(e,t,!0,i)})),n&&i&&t(e)}function xc(e){return new aa(null===e.parent?e.name:xc(e.parent)+"/"+e.name)}function bc(e){null!==e.parent&&function(e,t,n){const i=function(e){return void 0===gc(e)&&!yc(e)}(n),r=O(e.node.children,t);i&&r?(delete e.node.children[t],e.node.childCount--,bc(e)):i||r||(e.node.children[t]=n.node,e.node.childCount++,bc(e))}(e.parent,e.name,e)}const Sc=/[\[\].#$\/\u0000-\u001F\u007F]/,Nc=/[\[\].#$\u0000-\u001F\u007F]/,Mc=10485760,Tc=function(e){return"string"===typeof e&&0!==e.length&&!Sc.test(e)},Ac=function(e){return"string"===typeof e&&0!==e.length&&!Nc.test(e)},Ec=function(e){return null===e||"string"===typeof e||"number"===typeof e&&!_s(e)||e&&"object"===typeof e&&O(e,".sv")},Cc=function(e,t,n,i){i&&void 0===t||Ic(X(e,"value"),t,n)},Ic=function(e,t,n){const i=n instanceof aa?new _a(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+xa(i));if("function"===typeof t)throw new Error(e+"contains a function "+xa(i)+" with contents = "+t.toString());if(_s(t))throw new Error(e+"contains "+t.toString()+" "+xa(i));if("string"===typeof t&&t.length>Mc/3&&K(t)>Mc)throw new Error(e+"contains a string greater than "+Mc+" utf8 bytes "+xa(i)+" ('"+t.substring(0,50)+"...')");if(t&&"object"===typeof t){let n=!1,r=!1;if(As(t,((t,s)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(r=!0,!Tc(t)))throw new Error(e+" contains an invalid key ("+t+") "+xa(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=K(t),wa(e)}(i,t),Ic(e,s,i),function(e){const t=e.parts_.pop();e.byteLength_-=K(t),e.parts_.length>0&&(e.byteLength_-=1)}(i)})),n&&r)throw new Error(e+' contains ".value" child '+xa(i)+" in addition to actual children.")}},Rc=function(e,t,n,i){if((!i||void 0!==n)&&!Tc(n))throw new Error(X(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Pc=function(e,t,n,i){if((!i||void 0!==n)&&!Ac(n))throw new Error(X(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Dc=function(e,t,n,i){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Pc(e,t,n,i)},kc=function(e,t){if(".info"===la(t))throw new Error(e+" failed = Can't modify data under /.info/")},Lc=function(e,t){const n=t.path.toString();if("string"!==typeof t.repoInfo.host||0===t.repoInfo.host.length||!Tc(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Ac(e)}(n))throw new Error(X(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Oc{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Bc(e,t){let n=null;for(let i=0;i<t.length;i++){const r=t[i],s=r.getPath();null===n||va(s,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(r)}n&&e.eventLists_.push(n)}function Uc(e,t,n){Bc(e,n),zc(e,(e=>ya(e,t)||ya(t,e)))}function zc(e,t){e.recursionDepth_++;let n=!0;for(let i=0;i<e.eventLists_.length;i++){const r=e.eventLists_[i];if(r){t(r.path)?(Vc(e.eventLists_[i]),e.eventLists_[i]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function Vc(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const i=n.getEventRunner();hs&&fs("event: "+n.toString()),Rs(i)}}}const Fc="repo_interrupt",jc=25;class Hc{constructor(e,t,n,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Oc,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=yo(),this.transactionQueueTree_=new fc,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Gc(e,t,n){if(e.stats_=Ys(e.repoInfo_),e.forceRestClient_||("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new go(e.repoInfo_,((t,n,i,r)=>{qc(e,t,n,i,r)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>Xc(e,!0)),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{k(n)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}e.persistentConnection_=new Na(e.repoInfo_,t,((t,n,i,r)=>{qc(e,t,n,i,r)}),(t=>{Xc(e,t)}),(t=>{!function(e,t){As(t,((t,n)=>{Kc(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){const n=e.toString();return Ws[n]||(Ws[n]=t()),Ws[n]}(e.repoInfo_,(()=>new bo(e.stats_,e.server_))),e.infoData_=new vo,e.infoSyncTree_=new Vl({startListening:(t,n,i,r)=>{let s=[];const a=e.infoData_.getNode(t._path);return a.isEmpty()||(s=Hl(e.infoSyncTree_,t._path,a),setTimeout((()=>{r("ok")}),0)),s},stopListening:()=>{}}),Kc(e,"connected",!1),e.serverSyncTree_=new Vl({startListening:(t,n,i,r)=>(e.server_.listen(t,i,n,((n,i)=>{const s=r(n,i);Uc(e.eventQueue_,t._path,s)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function Wc(e){const t=e.infoData_.getNode(new aa(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function Yc(e){return oc({timestamp:Wc(e)})}function qc(e,t,n,i,r){e.dataUpdateCount++;const s=new aa(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let a=[];if(r)if(i){const t=z(n,(e=>Za(e)));a=function(e,t,n,i){const r=tc(e,i);if(r){const i=nc(r),s=i.path,a=i.queryId,o=ga(s,t),l=Uo.fromObject(n);return ic(e,s,new Eo(No(a),o,l))}return[]}(e.serverSyncTree_,s,t,r)}else{const t=Za(n);a=Wl(e.serverSyncTree_,s,t,r)}else if(i){const t=z(n,(e=>Za(e)));a=function(e,t,n){const i=Uo.fromObject(n);return Kl(e,new Eo({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,i))}(e.serverSyncTree_,s,t)}else{const t=Za(n);a=Hl(e.serverSyncTree_,s,t)}let o=s;a.length>0&&(o=iu(e,s)),Uc(e.eventQueue_,o,a)}function Xc(e,t){Kc(e,"connected",t),!1===t&&function(e){Zc(e,"onDisconnectEvents");const t=Yc(e),n=yo();wo(e.onDisconnect_,oa(),((i,r)=>{const s=hc(i,r,e.serverSyncTree_,t);_o(n,i,s)}));let i=[];wo(n,oa(),((t,n)=>{i=i.concat(Hl(e.serverSyncTree_,t,n));const r=lu(e,t);iu(e,r)})),e.onDisconnect_=yo(),Uc(e.eventQueue_,oa(),i)}(e)}function Kc(e,t,n){const i=new aa("/.info/"+t),r=Za(n);e.infoData_.updateSnapshot(i,r);const s=Hl(e.infoSyncTree_,i,r);Uc(e.eventQueue_,i,s)}function Jc(e){return e.nextWriteId_++}function $c(e,t,n,i,r){Zc(e,"set",{path:t.toString(),value:n,priority:i});const s=Yc(e),a=Za(n,i),o=ql(e.serverSyncTree_,t),l=dc(a,o,s),c=Jc(e),u=Fl(e.serverSyncTree_,t,l,c,!0);Bc(e.eventQueue_,u),e.server_.put(t.toString(),a.val(!0),((n,i)=>{const s="ok"===n;s||ys("set at "+t+" failed: "+n);const a=jl(e.serverSyncTree_,c,!s);Uc(e.eventQueue_,t,a),eu(e,r,n,i)}));const h=lu(e,t);iu(e,h),Uc(e.eventQueue_,h,[])}function Qc(e){e.persistentConnection_&&e.persistentConnection_.interrupt(Fc)}function Zc(e){let t="";e.persistentConnection_&&(t=e.persistentConnection_.id+":");for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];fs(t,...i)}function eu(e,t,n,i){t&&Rs((()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let r=e;i&&(r+=": "+i);const s=new Error(r);s.code=e,t(s)}}))}function tu(e,t,n){return ql(e.serverSyncTree_,t,n)||Ja.EMPTY_NODE}function nu(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||ou(e,t),gc(t)){const n=su(e,t);u(n.length>0,"Sending zero length transaction queue");n.every((e=>0===e.status))&&function(e,t,n){const i=n.map((e=>e.currentWriteId)),r=tu(e,t,i);let s=r;const a=r.hash();for(let c=0;c<n.length;c++){const e=n[c];u(0===e.status,"tryToSendTransactionQueue_: items in queue should all be run."),e.status=1,e.retryCount++;const i=ga(t,e.path);s=s.updateChild(i,e.currentOutputSnapshotRaw)}const o=s.val(!0),l=t;e.server_.put(l.toString(),o,(i=>{Zc(e,"transaction put response",{path:l.toString(),status:i});let r=[];if("ok"===i){const i=[];for(let t=0;t<n.length;t++)n[t].status=2,r=r.concat(jl(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&i.push((()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved))),n[t].unwatcher();ou(e,mc(e.transactionQueueTree_,t)),nu(e,e.transactionQueueTree_),Uc(e.eventQueue_,t,r);for(let e=0;e<i.length;e++)Rs(i[e])}else{if("datastale"===i)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{ys("transaction at "+l.toString()+" failed: "+i);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=i}iu(e,t)}}),a)}(e,xc(t),n)}else yc(t)&&_c(t,(t=>{nu(e,t)}))}function iu(e,t){const n=ru(e,t),i=xc(n);return function(e,t,n){if(0===t.length)return;const i=[];let r=[];const s=t.filter((e=>0===e.status)),a=s.map((e=>e.currentWriteId));for(let l=0;l<t.length;l++){const s=t[l],c=ga(n,s.path);let h,d=!1;if(u(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===s.status)d=!0,h=s.abortReason,r=r.concat(jl(e.serverSyncTree_,s.currentWriteId,!0));else if(0===s.status)if(s.retryCount>=jc)d=!0,h="maxretry",r=r.concat(jl(e.serverSyncTree_,s.currentWriteId,!0));else{const n=tu(e,s.path,a);s.currentInputSnapshot=n;const i=t[l].update(n.val());if(void 0!==i){Ic("transaction failed: Data returned ",i,s.path);let t=Za(i);"object"===typeof i&&null!=i&&O(i,".priority")||(t=t.updatePriority(n.getPriority()));const o=s.currentWriteId,l=Yc(e),c=dc(t,n,l);s.currentOutputSnapshotRaw=t,s.currentOutputSnapshotResolved=c,s.currentWriteId=Jc(e),a.splice(a.indexOf(o),1),r=r.concat(Fl(e.serverSyncTree_,s.path,c,s.currentWriteId,s.applyLocally)),r=r.concat(jl(e.serverSyncTree_,o,!0))}else d=!0,h="nodata",r=r.concat(jl(e.serverSyncTree_,s.currentWriteId,!0))}Uc(e.eventQueue_,n,r),r=[],d&&(t[l].status=2,o=t[l].unwatcher,setTimeout(o,Math.floor(0)),t[l].onComplete&&("nodata"===h?i.push((()=>t[l].onComplete(null,!1,t[l].currentInputSnapshot))):i.push((()=>t[l].onComplete(new Error(h),!1,null)))))}var o;ou(e,e.transactionQueueTree_);for(let l=0;l<i.length;l++)Rs(i[l]);nu(e,e.transactionQueueTree_)}(e,su(e,n),i),i}function ru(e,t){let n,i=e.transactionQueueTree_;for(n=la(t);null!==n&&void 0===gc(i);)i=mc(i,n),n=la(t=ua(t));return i}function su(e,t){const n=[];return au(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function au(e,t,n){const i=gc(t);if(i)for(let r=0;r<i.length;r++)n.push(i[r]);_c(t,(t=>{au(e,t,n)}))}function ou(e,t){const n=gc(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,vc(t,n.length>0?n:void 0)}_c(t,(t=>{ou(e,t)}))}function lu(e,t){const n=xc(ru(e,t)),i=mc(e.transactionQueueTree_,t);return function(e,t,n){let i=n?e:e.parent;for(;null!==i;){if(t(i))return!0;i=i.parent}}(i,(t=>{cu(e,t)})),cu(e,i),wc(i,(t=>{cu(e,t)})),n}function cu(e,t){const n=gc(t);if(n){const i=[];let r=[],s=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?(u(s===t-1,"All SENT items should be at beginning of queue."),s=t,n[t].status=3,n[t].abortReason="set"):(u(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),r=r.concat(jl(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&i.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===s?vc(t,void 0):n.length=s+1,Uc(e.eventQueue_,xc(t),r);for(let e=0;e<i.length;e++)Rs(i[e])}}const uu=function(e,t){const n=hu(e),i=n.namespace;"firebase.com"===n.domain&&vs(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),i&&"undefined"!==i||"localhost"===n.domain||vs("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&ys("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const r="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new Fs(n.host,n.secure,i,r,t,"",i!==n.subdomain),path:new aa(n.pathString)}},hu=function(e){let t="",n="",i="",r="",s="",a=!0,o="https",l=443;if("string"===typeof e){let c=e.indexOf("//");c>=0&&(o=e.substring(0,c-1),e=e.substring(c+2));let u=e.indexOf("/");-1===u&&(u=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(u,h)),u<h&&(r=function(e){let t="";const n=e.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let e=n[r];try{e=decodeURIComponent(e.replace(/\+/g," "))}catch(i){}t+="/"+e}return t}(e.substring(u,h)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const i=n.split("=");2===i.length?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):ys("Invalid query segment '".concat(n,"' in query '").concat(e,"'"))}return t}(e.substring(Math.min(e.length,h)));c=t.indexOf(":"),c>=0?(a="https"===o||"wss"===o,l=parseInt(t.substring(c+1),10)):c=t.length;const p=t.slice(0,c);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{const e=t.indexOf(".");i=t.substring(0,e).toLowerCase(),n=t.substring(e+1),s=i}"ns"in d&&(s=d.ns)}return{host:t,port:l,domain:n,subdomain:i,secure:a,scheme:o,pathString:r,namespace:s}},du="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",pu=function(){let e=0;const t=[];return function(n){const i=n===e;let r;e=n;const s=new Array(8);for(r=7;r>=0;r--)s[r]=du.charAt(n%64),n=Math.floor(n/64);u(0===n,"Cannot push at time == 0");let a=s.join("");if(i){for(r=11;r>=0&&63===t[r];r--)t[r]=0;t[r]++}else for(r=0;r<12;r++)t[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)a+=du.charAt(t[r]);return u(20===a.length,"nextPushId: Length should be 20."),a}}();class fu{constructor(e,t,n,i){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+k(this.snapshot.exportVal())}}class mu{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class gu{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return u(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class vu{constructor(e,t,n,i){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=i}get key(){return ma(this._path)?null:ha(this._path)}get ref(){return new xu(this._repo,this._path)}get _queryIdentifier(){const e=mo(this._queryParams),t=Ms(e);return"{}"===t?"default":t}get _queryObject(){return mo(this._queryParams)}isEqual(e){if(!((e=J(e))instanceof vu))return!1;const t=this._repo===e._repo,n=va(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&n&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}function yu(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function _u(e){let t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===Ca){const i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",r="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==ws)throw new Error(i);if("string"!==typeof t)throw new Error(r)}if(e.hasEnd()){if(e.getIndexEndName()!==xs)throw new Error(i);if("string"!==typeof n)throw new Error(r)}}else if(e.getIndex()===ja){if(null!=t&&!Ec(t)||null!=n&&!Ec(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(u(e.getIndex()instanceof eo||e.getIndex()===to,"unknown index type."),null!=t&&"object"===typeof t||null!=n&&"object"===typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function wu(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class xu extends vu{constructor(e,t){super(e,t,new co,!1)}get parent(){const e=pa(this._path);return null===e?null:new xu(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class bu{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new aa(e),n=Nu(this.ref,e);return new bu(this._node.getChild(t),n,ja)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,((t,n)=>e(new bu(n,Nu(this.ref,t),ja))))}hasChild(e){const t=new aa(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Su(e,t){return(e=J(e))._checkNotDeleted("ref"),void 0!==t?Nu(e._root,t):e._root}function Nu(e,t){return null===la((e=J(e))._path)?Dc("child","path",t,!1):Pc("child","path",t,!1),new xu(e._repo,fa(e._path,t))}function Mu(e,t){e=J(e),kc("push",e._path),Cc("push",t,e._path,!0);const n=Wc(e._repo),i=pu(n),r=Nu(e,i),s=Nu(e,i);let a;return a=null!=t?Tu(s,t).then((()=>s)):Promise.resolve(s),r.then=a.then.bind(a),r.catch=a.then.bind(a,void 0),r}function Tu(e,t){e=J(e),kc("set",e._path),Cc("set",t,e._path,!1);const n=new M;return $c(e._repo,e._path,t,null,n.wrapCallback((()=>{}))),n.promise}function Au(e){e=J(e);const t=new gu((()=>{})),n=new Eu(t);return function(e,t,n){const i=Xl(e.serverSyncTree_,t);return null!=i?Promise.resolve(i):e.server_.get(t).then((i=>{const r=Za(i).withIndex(t._queryParams.getIndex());let s;if(Yl(e.serverSyncTree_,t,n,!0),t._queryParams.loadsAllData())s=Hl(e.serverSyncTree_,t._path,r);else{const n=Zl(e.serverSyncTree_,t);s=Wl(e.serverSyncTree_,t._path,r,n)}return Uc(e.eventQueue_,t._path,s),Gl(e.serverSyncTree_,t,n,null,!0),r}),(n=>(Zc(e,"get for query "+k(t)+" failed: "+n),Promise.reject(new Error(n)))))}(e._repo,e,n).then((t=>new bu(t,new xu(e._repo,e._path),e._queryParams.getIndex())))}class Eu{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new fu("value",this,new bu(e.snapshotNode,new xu(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new mu(this,e,t):null}matches(e){return e instanceof Eu&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class Cu{}class Iu extends Cu{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){Cc("endAt",this._value,e._path,!0);const t=ho(e._queryParams,this._value,this._key);if(wu(t),_u(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new vu(e._repo,e._path,t,e._orderByCalled)}}class Ru extends Cu{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){Cc("startAt",this._value,e._path,!0);const t=uo(e._queryParams,this._value,this._key);if(wu(t),_u(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new vu(e._repo,e._path,t,e._orderByCalled)}}class Pu extends Cu{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){yu(e,"orderByChild");const t=new aa(this._path);if(ma(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const n=new eo(t),i=po(e._queryParams,n);return _u(i),new vu(e._repo,e._path,i,!0)}}function Du(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Pc("orderByChild","path",e,!1),new Pu(e)}class ku extends Cu{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(Cc("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Iu(this._value,this._key)._apply(new Ru(this._value,this._key)._apply(e))}}function Lu(e,t){return Rc("equalTo","key",t,!0),new ku(e,t)}function Ou(e){let t=J(e);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];for(const s of i)t=s._apply(t);return t}!function(e){u(!Tl,"__referenceConstructor has already been defined"),Tl=e}(xu),function(e){u(!Al,"__referenceConstructor has already been defined"),Al=e}(xu);const Bu="FIREBASE_DATABASE_EMULATOR_HOST",Uu={};let zu=!1;function Vu(e,t,n,i,r){let s=i||e.options.databaseURL;void 0===s&&(e.options.projectId||vs("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),fs("Using default host for project ",e.options.projectId),s="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));let a,o,l=uu(s,r),c=l.repoInfo;"undefined"!==typeof process&&(o={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}[Bu]),o?(a=!0,s="http://".concat(o,"?ns=").concat(c.namespace),l=uu(s,r),c=l.repoInfo):a=!l.repoInfo.secure;const u=r&&a?new Ls(Ls.OWNER):new ks(e.name,e.options,t);Lc("Invalid Firebase Database URL",l),ma(l.path)||vs("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(e,t,n,i){let r=Uu[t.name];r||(r={},Uu[t.name]=r);let s=r[e.toURLString()];s&&vs("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return s=new Hc(e,zu,n,i),r[e.toURLString()]=s,s}(c,e,u,new Ds(e.name,n));return new Fu(h,e)}class Fu{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Gc(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new xu(this._repo,oa())),this._rootInternal}_delete(){return null!==this._rootInternal&&(!function(e,t){const n=Uu[t];n&&n[e.key]===e||vs("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),Qc(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&vs("Cannot call "+e+" on a deleted database.")}}function ju(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dt(),t=arguments.length>1?arguments[1]:void 0;const n=at(e,"database").getImmediate({identifier:t});if(!n._instanceStarted){const e=(e=>{const t=b(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const i=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),i]:[t.substring(0,n),i]})("database");e&&function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=J(e),e._checkNotDeleted("useEmulator"),e._instanceStarted&&vs("Cannot call useEmulator() after instance has already been initialized.");const r=e._repoInternal;let s;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&vs('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Ls(Ls.OWNER);else if(i.mockUserToken){const t="string"===typeof i.mockUserToken?i.mockUserToken:function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",i=e.iat||0,r=e.sub||e.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},e);return[g(JSON.stringify({alg:"none",type:"JWT"})),g(JSON.stringify(s)),""].join(".")}(i.mockUserToken,e.app.options.projectId);s=new Ls(t)}!function(e,t,n,i){e.repoInfo_=new Fs("".concat(t,":").concat(n),!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),i&&(e.authTokenProvider_=i)}(r,t,n,s)}(n,...e)}return n}Na.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Na.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};!function(e){ts(ut),st(new $("database",((e,t)=>{let{instanceIdentifier:n}=t;return Vu(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)}),"PUBLIC").setMultipleInstances(!0)),pt(Qr,Zr,e),pt(Qr,Zr,"esm2017")}();const Hu=class{constructor(e){this.getCurrentUser=()=>Gr().currentUser,this.getUserData=async()=>{const e=Su(ju(qr),"users/"),t=await Au(e);if(t.exists()){const e=Object.values(t.val()),n=this.getCurrentUser(),i=e.find((e=>e.email===n.email));i?this.setUserData(i):alert("No se encontr\xf3 el usuario")}else alert("No se encontraron datos en la base de datos")},this.addToWallet=async(e,t)=>{try{alert(e);const n=ju(qr),i=Su(n,"users"),r=await Au(i);if(r.exists()){const i=Object.values(r.val()).find((t=>t.userName===e));if(i){i.walletDiv+=t;const r=Su(n,"users/".concat(i.firebaseKey));await Tu(r,i),console.log("Se aument\xf3 la cantidad en la wallet de ".concat(e))}else console.log("No se encontr\xf3 al usuario ".concat(e))}else console.log("No se encontraron usuarios en la base de datos")}catch(gs){console.error("Error al aumentar la cantidad en la wallet:",gs)}},this.setUserData=e}isNullOrEmpty(e){return null===e||void 0===e||""===e||" "===e}};const Gu=n.p+"static/media/rank-1.1f46908c5afe5efc91ce.png",Wu=n.p+"static/media/Rank-3.2360e3d232f0d189438d.png",Yu=n.p+"static/media/Rank-4.2c882b173e21a34f20f7.png",qu=n.p+"static/media/Rank-5.1f46908c5afe5efc91ce.png",Xu=n.p+"static/media/Rank-6.0cfeb0c4567c691755e7.png",Ku=n.p+"static/media/Rank-7.f5268433f530dc9537c9.png",Ju=n.p+"static/media/Rank-8.e3234e1ce151d95e61e3.png",$u=n.p+"static/media/Rank-9.88cfdfc55832aa05393b.png";const Qu=class{constructor(e,t,n){var i=this;this.getDirectRef=async()=>{try{const e=ju(qr),t=Ou(Su(e,"users"),Du("referredBy"),Lu(this.userData.userName)),n=await Au(t),i=n.exists()?Object.values(n.val()):[];return this.setReferidos(i.length),i.length}catch(gs){return console.error("Error counting direct referrals:",gs),this.setReferidos(0),0}},this.contarTotalReferidos=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;try{const n=Su(ju(qr),"users"),r=await Au(Ou(n,Du("referredBy"),Lu(e))),s=r.exists()?Object.values(r.val()):[];t+=s.length;for(const e of s)t+=await i.contarTotalReferidos(e.userName);i.setReferidosTotales(t)}catch(gs){console.error("Error counting direct referrals:",gs),i.setReferidosTotales(0)}},this.userData=e,this.setReferidos=t,this.setReferidosTotales=n}},Zu=e=>{const[n,i]=(0,t.useState)(""),[s,a]=(0,t.useState)(""),[o,l]=(0,t.useState)(""),[c,u]=(0,t.useState)(0),[h,d]=(0,t.useState)(0);(0,t.useEffect)((()=>{p(e.userData.rank),f(e.userData.walletDiv);new Qu(e.userData,u,d)}),[]);const p=e=>{switch(e){case 1:i("Zarifo Ejecutivo"),a(Gu);break;case 2:i("Ruby Ejecutivo"),a(Gu);break;case 3:i("Esmeralda Ejecutivo"),a(Wu);break;case 4:i("Ejecutivo Diamante"),a(Yu);break;case 5:i("Diamante Azul"),a(qu);break;case 6:i("Diamante Negro"),a(Xu);break;case 7:i("Diamante Royal"),a(Ku);break;case 8:i("Diamante Corona"),a(Ju);break;case 9:i("Diamante Royal"),a($u);break;default:i("No Rank"),a("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjAAAAE7CAYAAADD3rsxAAAMHklEQVR4Ae3QgQAAAADDoPlTn+AGhVBhwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGDBgwIABAwYMGLgDA8YRAAEUSf0YAAAAAElFTkSuQmCC")}},f=e=>{switch(!0){case e<=99:l("");break;case e>=100&&e<=499:l("Builder");break;case e>=500&&e<=2499:l("Bronze");break;case e>=2500&&e<=4900:l("Silver");break;case e>=5e3&&e<=1e4:l("Gold");break;default:l("Platinum")}};return(0,r.jsxs)("section",{className:"userDetail",children:[(0,r.jsx)("img",{className:"rangoImg",src:s,alt:"rango"}),(0,r.jsxs)("p",{className:"p0",children:["Username: ",e.userData.userName]}),(0,r.jsx)("p",{className:"p1",children:n}),(0,r.jsxs)("div",{className:"datosUser",children:[(0,r.jsx)("p",{className:"p2",children:"Team capital: $0"}),(0,r.jsxs)("p",{className:"p2",children:["fecha de activacion: ",e.userData.admissionDate]}),(0,r.jsxs)("p",{className:"p2",children:["Paquete actual:",o]})]}),(0,r.jsxs)("div",{class:"tablaRed",children:[(0,r.jsxs)("div",{className:"datosRedes",children:[(0,r.jsx)("p",{className:"titulo",children:"My network"}),(0,r.jsx)("p",{className:"datoRed",children:c})]}),(0,r.jsxs)("div",{className:"datosRedes",children:[(0,r.jsx)("p",{className:"titulo",children:"Total network"}),(0,r.jsx)("p",{className:"datoRed",children:h})]})]})]})},eh=e=>(0,r.jsxs)("div",{className:"contain-link",children:[(0,r.jsx)("div",{className:"header",children:(0,r.jsxs)("h3",{children:[(0,r.jsx)("i",{class:"bi bi-person-fill-add"})," Invitation Link:"]})}),(0,r.jsxs)("div",{className:"link",children:[(0,r.jsx)("input",{id:"invitationLink",type:"text",value:"https://legalcapital-corp.com/register/"+e.username,readOnly:!0}),(0,r.jsx)("button",{onClick:()=>{document.getElementById("invitationLink").select(),document.execCommand("copy"),window.getSelection().removeAllRanges()},children:(0,r.jsx)("i",{class:"bi bi-copy"})})]})]}),th=e=>{const[n,i]=(0,t.useState)(0);return(0,t.useEffect)((()=>{i(e.dato||0)}),[]),(0,r.jsxs)("section",{className:"contain-data",children:[(0,r.jsxs)("div",{className:"contain1",children:[(0,r.jsxs)("div",{className:"title",children:[(0,r.jsx)("img",{className:"logo",alt:"logo"}),(0,r.jsx)("p",{children:e.titulo})]}),(0,r.jsx)("div",{className:"data",children:(0,r.jsxs)("p",{children:[n," USDT"]})})]}),(0,r.jsxs)("div",{className:e.type?"content2-btn":"none",children:[(0,r.jsxs)("button",{className:e.typeBtn1?"Btn":"none",children:["Add to wallet",(0,r.jsx)("svg",{version:"1.0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 250 250",width:"70px",height:"40px",preserveAspectRatio:"xMidYMid meet",children:(0,r.jsxs)("g",{transform:"translate(25,230) scale(0.04,-0.04)",fill:"#fff",stroke:"none",children:[(0,r.jsx)("path",{d:"M679 4855 c-242 -59 -447 -265 -504 -505 -22 -94 -23 -3318 -1 -3422\r 69 -323 326 -584 649 -658 92 -21 95 -21 1847 -18 l1755 3 73 27 c110 40 178\r 84 267 173 63 63 90 98 122 165 77 156 73 63 73 1513 0 1287 0 1298 -21 1360\r -26 79 -67 143 -127 199 -61 56 -103 81 -179 107 -62 21 -64 21 -1920 21\r -1157 0 -1880 4 -1917 10 -119 19 -223 97 -277 207 -20 41 -24 63 -24 148 0\r 90 3 105 28 153 39 75 87 124 159 163 l63 34 1385 5 c1375 5 1385 5 1420 26\r 103 60 109 213 11 280 l-36 24 -1395 -1 c-1138 -1 -1405 -3 -1451 -14z m1\r -1342 c60 -16 203 -18 1962 -23 l1897 -5 28 -21 c15 -12 37 -36 48 -55 19 -32\r 20 -55 23 -361 l3 -327 -378 -3 -378 -3 -67 -26 c-192 -75 -332 -218 -400\r -409 -21 -59 -23 -82 -23 -245 0 -163 2 -186 23 -245 68 -190 217 -342 405\r -411 60 -22 76 -23 440 -27 l377 -3 0 -192 c0 -106 -5 -222 -10 -260 -18 -126\r -82 -218 -192 -278 l-63 -34 -1710 -3 c-1204 -2 -1726 1 -1763 9 -134 27 -284\r 141 -349 264 -73 140 -67 24 -71 1456 l-3 1286 68 -33 c37 -19 97 -41 133 -51z\r m3960 -1473 l0 -360 -333 0 c-381 0 -394 2 -477 77 -28 25 -63 69 -78 97 -25\r 48 -27 59 -27 181 0 121 2 133 27 180 31 59 104 130 156 152 64 27 119 31 430\r 32 l302 1 0 -360z"}),(0,r.jsx)("path",{d:"M965 4336 c-37 -16 -82 -68 -91 -102 -4 -14 -4 -48 -2 -75 4 -40 12\r\n-57 39 -85 18 -19 49 -39 69 -45 23 -6 459 -9 1292 -7 l1257 3 28 21 c99 74\r\n99 204 0 278 l-28 21 -1267 2 c-1038 2 -1273 0 -1297 -11z"})]})})]}),(0,r.jsxs)("button",{className:e.typeBtn2?"Btn":"none",children:["Withdraw from wallet",(0,r.jsx)("svg",{version:"1.0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 250 250",width:"70px",height:"40px",preserveAspectRatio:"xMidYMid meet",children:(0,r.jsxs)("g",{transform:"translate(25,230) scale(0.04,-0.04)",fill:"#fff",stroke:"none",children:[(0,r.jsx)("path",{d:"M665 4612 c-103 -35 -169 -77 -244 -157 -70 -75 -125 -181 -146 -280\r -22 -103 -22 -1416 0 -1520 37 -176 152 -328 308 -405 102 -50 192 -70 325\r -70 l102 0 0 -599 c0 -597 0 -599 23 -679 45 -154 153 -287 289 -356 137 -69\r 71 -66 1237 -66 926 0 1060 2 1114 16 122 31 238 108 314 209 60 79 80 121\r 104 212 18 71 19 115 19 670 l0 593 103 0 c132 0 222 20 324 70 156 77 271\r 229 308 405 22 104 22 1417 0 1520 -43 205 -199 377 -397 440 l-79 25 -1812 0\r -1812 0 -80 -28z m3703 -321 c31 -14 69 -43 93 -69 71 -82 70 -64 67 -833 l-3\r -684 -22 -41 c-29 -53 -75 -99 -127 -126 -32 -17 -64 -22 -153 -26 l-113 -5 0\r 475 0 475 57 6 c96 10 153 71 153 165 0 68 -27 115 -81 142 -38 20 -67 20\r -1680 20 -1829 0 -1684 6 -1735 -69 -33 -49 -34 -134 -1 -181 35 -52 70 -73\r 132 -78 l55 -4 0 -475 0 -476 -112 5 c-90 4 -122 9 -154 26 -52 27 -98 73\r -127 126 l-22 41 -3 684 c-3 769 -4 751 68 833 43 49 87 74 153 88 23 4 820 7\r 1772 6 l1730 -1 53 -24z m-588 -2053 l0 -1223 -24 -50 c-28 -62 -77 -111 -136\r -139 -45 -21 -46 -21 -1060 -21 -1008 0 -1015 0 -1060 21 -59 27 -107 76 -136\r 139 l-24 50 0 1223 0 1222 1220 0 1220 0 0 -1222z"}),(0,r.jsx)("path",{d:"M2500 2929 c-14 -5 -36 -20 -48 -32 -53 -49 -52 -33 -52 -649 l0\r -572 -197 196 c-169 167 -204 197 -236 203 -131 25 -226 -71 -202 -202 6 -33\r 49 -81 348 -381 188 -189 354 -350 369 -358 35 -18 121 -18 156 0 15 8 181\r 169 369 358 299 300 342 348 348 381 24 131 -71 227 -202 202 -32 -6 -67 -36\r -235 -203 l-198 -196 0 575 0 576 -22 33 c-13 18 -35 42 -50 53 -31 23 -111\r 32 -148 16z"})]})})]})]})]})},nh=(n.p,n.p,e=>{const[n,i]=(0,t.useState)("");(0,t.useEffect)((()=>{if(e.userData&&(i(e.userData.walletDiv),n)){const e=n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});i(e)}}),[e.userData]);return(0,r.jsx)("div",{className:"seccion-main",children:(0,r.jsxs)("section",{className:"dashboard",children:[(0,r.jsxs)("div",{className:"sec0",children:[(0,r.jsx)("h1",{children:"VIRTUAL OFFICE"}),(0,r.jsx)("i",{className:"bi bi-house"})]}),(0,r.jsx)("div",{className:"item-grid sec1",children:(0,r.jsx)(eh,{username:e.userData.userName})}),(0,r.jsx)("div",{className:"item-grid sec2",children:(0,r.jsx)(th,{dato:(e.userData.walletDiv+e.userData.walletCom).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),type:!1,titulo:"TOTAL EARNINGS"})}),(0,r.jsx)("div",{className:"item-grid sec3",children:(0,r.jsx)(th,{dato:e.userData.bonoIgualacion,type:!1,titulo:"TOTAL WITHDRAWALS"})}),(0,r.jsx)("div",{className:"item-grid sec4",children:(0,r.jsx)(th,{dato:e.userData.bonoIgualacion,type:!1,titulo:"WALLET DIVIDENDOS"})}),(0,r.jsx)("div",{className:"item-grid sec5",children:(0,r.jsx)(th,{dato:e.userData.bonoIgualacion,type:!1,titulo:"COMMISSION WALLET"})}),(0,r.jsx)("div",{className:"item-grid sec6",children:(0,r.jsx)(th,{dato:e.userData.bonoIgualacion,type:!1,titulo:"RESIDUAL RANK"})}),(0,r.jsx)("div",{className:"item-grid sec7",children:(0,r.jsx)(th,{dato:e.userData.bonoIgualacion,type:!1,titulo:"DIRECT REFERRAL BONUS"})}),(0,r.jsx)("div",{className:"item-grid sec8",children:(0,r.jsx)(th,{dato:e.userData.bonoIgualacion,type:!1,titulo:"RESIDUAL INCOME FEES"})}),(0,r.jsx)("div",{className:"item-grid sec9",children:(0,r.jsx)(th,{dato:e.userData.bonoIgualacion,type:!1,titulo:"MATCHING BONUS"})}),(0,r.jsx)("div",{className:"item-grid sec10",children:(0,r.jsx)(th,{dato:e.userData.bonoIgualacion,type:!1,titulo:"FASTRACK BONUS"})}),(0,r.jsx)("div",{className:"item-grid sec12",children:(0,r.jsx)(th,{dato:e.userData.bonoIgualacion,type:!1,titulo:"MATCHING BONUS"})}),(0,r.jsx)("div",{className:"item-grid sec13",children:(0,r.jsx)("img",{alt:"promo"})}),(0,r.jsx)("div",{className:"item-grid sec14",children:(0,r.jsx)(Zu,{userData:e.userData})})]})})}),ih=e=>{const[n,i]=(0,t.useState)(!1);return(0,t.useEffect)((()=>{e.userData&&""!==e.userData.validity&&"unpaid"!==e.userData.validity&&i(!1)}),[]),(0,r.jsxs)("div",{className:"aviso".concat(n?"":"-0"),children:[(0,r.jsxs)("div",{className:"aviso1",children:[(0,r.jsx)("img",{alt:"advertencia"}),(0,r.jsxs)("p",{children:[(0,r.jsx)("h2",{children:"Legal Capital Corp"}),(0,r.jsx)("h3",{children:"Oficina Virtual"}),(0,r.jsx)("br",{}),(0,r.jsx)("span",{children:"Su cuenta a\xfan no est\xe1 activa"}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"Todav\xeda no hemos identificado la confirmaci\xf3n de pago de un paquete de incio.",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"Si ya ha elegido un paquete de inicio, pruebe recargar la pagina. Si realiz\xf3 el pago, el acceso a la oficina ser\xe1 completamente liberado tan pronto como se confirme.",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"Si a\xfan no ha realizado un pedido de activaci\xf3n, haga clic en el bot\xf3n de abajo:"]})]}),(0,r.jsxs)("button",{class:"cta",children:[(0,r.jsx)("span",{class:"hover-underline-animation",children:" Shop now "}),(0,r.jsx)("svg",{viewBox:"0 0 46 16",height:"10",width:"30",xmlns:"http://www.w3.org/2000/svg",id:"arrow-horizontal",children:(0,r.jsx)("path",{transform:"translate(30)",d:"M8,0,6.545,1.455l5.506,5.506H-30V9.039H12.052L6.545,14.545,8,16l8-8Z","data-name":"Path 10",id:"Path_10"})})]})]})},rh=e=>(0,r.jsxs)("div",{class:"card",children:[(0,r.jsx)("div",{className:"imgPack",children:(0,r.jsx)("img",{src:e.img,alt:"imgpack"})}),(0,r.jsx)("button",{onClick:function(){e.setIsVisible(!0),e.setOpc(e.op),e.setImg(e.img)},class:"btn1",children:"Buy"})]}),sh=n.p+"static/media/builder.6f4466d9b04385d2a3ef.png",ah=n.p+"static/media/bronze.3c2a20745b0a67460047.png",oh=n.p+"static/media/plata.ed6cb6218904572b0f4a.png",lh=n.p+"static/media/gold.ef55156d8dd608bfaafa.png",ch=n.p+"static/media/platinum.615a99197293021d78b9.png";const uh=class{constructor(e){this.setRequest=async()=>{const e=this.common.getCurrentUser();if(!e)return void alert("No hay usuario actualmente autenticado.");const t=ju(qr),n=Su(t,"users/"),i=await Au(n);if(i.exists()){const n=i.val(),r=Object.values(n).find((t=>t.email===e.email));if(r){r.request=this.request;try{await Tu(Su(t,"users/".concat(r.firebaseKey)),r)}catch(gs){}}}},this.request=e,this.common=new Hu}},hh=e=>{const[n,i]=(0,t.useState)(0);return(0,r.jsx)("section",{className:e.visible?"compQR":"none",children:(0,r.jsxs)("div",{className:"modalMain",children:[(0,r.jsx)("div",{className:"overlay"}),(0,r.jsxs)("div",{className:"modal-content",children:[(0,r.jsxs)("div",{className:"seccion1-mc",children:[(0,r.jsx)("h2",{children:"Payment information"}),(0,r.jsx)("img",{className:"qr"})]}),(0,r.jsxs)("div",{className:"seccion2-mc",children:[(0,r.jsxs)("div",{className:"seccion3-mc",children:[(0,r.jsx)("button",{className:"close-modal",onClick:()=>{e.setIsVisible(!1)},children:(0,r.jsx)("i",{class:"bi bi-x-square-fill"})}),(0,r.jsx)("span",{children:"Wallet address"}),(0,r.jsxs)("div",{className:"wallet",children:[(0,r.jsx)("input",{type:"text",id:"wallet",readOnly:!0,value:"TMuMJUSBamBf1d2vhbd4g1p13pUf6N7TtM"}),(0,r.jsx)("button",{onClick:()=>{document.getElementById("wallet").select(),document.execCommand("copy"),window.getSelection().removeAllRanges()},children:(0,r.jsx)("i",{class:"bi bi-copy"})})]}),(0,r.jsx)("span",{children:"Price"}),(0,r.jsxs)("div",{className:"select-container",children:[(0,r.jsx)("select",{className:"select-box",value:n,onChange:e=>{const t=parseInt(e.target.value,10);i(t),console.log(n)},children:(e=>{switch(e){case 1:return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("option",{value:0,children:"Seleccione una opci\xf3n"}),";",(0,r.jsx)("option",{value:100,children:"100"}),(0,r.jsx)("option",{value:100,children:"100"}),(0,r.jsx)("option",{value:200,children:"200"}),(0,r.jsx)("option",{value:300,children:"300"}),(0,r.jsx)("option",{value:400,children:"400"})]});case 2:return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("option",{value:0,children:"Seleccione una opci\xf3n"}),";",(0,r.jsx)("option",{value:500,children:"500"}),(0,r.jsx)("option",{value:600,children:"600"}),(0,r.jsx)("option",{value:700,children:"700"}),(0,r.jsx)("option",{value:800,children:"800"}),(0,r.jsx)("option",{value:900,children:"900"}),(0,r.jsx)("option",{value:1e3,children:"1000"}),(0,r.jsx)("option",{value:1100,children:"1100"}),(0,r.jsx)("option",{value:1200,children:"1200"}),(0,r.jsx)("option",{value:1300,children:"1300"}),(0,r.jsx)("option",{value:1400,children:"1400"}),(0,r.jsx)("option",{value:1500,children:"1500"}),(0,r.jsx)("option",{value:1600,children:"1600"}),(0,r.jsx)("option",{value:1700,children:"1700"}),(0,r.jsx)("option",{value:1800,children:"1800"}),(0,r.jsx)("option",{value:1900,children:"1900"}),(0,r.jsx)("option",{value:2e3,children:"2000"}),(0,r.jsx)("option",{value:2100,children:"2100"}),(0,r.jsx)("option",{value:2200,children:"2200"}),(0,r.jsx)("option",{value:2300,children:"2300"}),(0,r.jsx)("option",{value:2400,children:"2400"})]});case 3:return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("option",{value:0,children:"Seleccione una opci\xf3n"}),";",(0,r.jsx)("option",{value:2500,children:"2500"}),(0,r.jsx)("option",{value:2600,children:"2600"}),(0,r.jsx)("option",{value:2700,children:"2700"}),(0,r.jsx)("option",{value:2800,children:"2800"}),(0,r.jsx)("option",{value:2900,children:"2900"}),(0,r.jsx)("option",{value:3e3,children:"3000"}),(0,r.jsx)("option",{value:3100,children:"3100"}),(0,r.jsx)("option",{value:3200,children:"3200"}),(0,r.jsx)("option",{value:3300,children:"3300"}),(0,r.jsx)("option",{value:3400,children:"3400"}),(0,r.jsx)("option",{value:3500,children:"3500"}),(0,r.jsx)("option",{value:3600,children:"3600"}),(0,r.jsx)("option",{value:3700,children:"3700"}),(0,r.jsx)("option",{value:3800,children:"3800"}),(0,r.jsx)("option",{value:3900,children:"3900"}),(0,r.jsx)("option",{value:4e3,children:"4000"}),(0,r.jsx)("option",{value:4100,children:"4100"}),(0,r.jsx)("option",{value:4200,children:"4200"}),(0,r.jsx)("option",{value:4300,children:"4300"}),(0,r.jsx)("option",{value:4400,children:"4400"}),(0,r.jsx)("option",{value:4500,children:"4500"}),(0,r.jsx)("option",{value:4600,children:"4600"}),(0,r.jsx)("option",{value:4700,children:"4700"}),(0,r.jsx)("option",{value:4800,children:"4800"}),(0,r.jsx)("option",{value:4900,children:"4900"})]});case 4:return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("option",{value:0,children:"Seleccione una opci\xf3n"}),";",(0,r.jsx)("option",{value:5e3,children:"5000"}),(0,r.jsx)("option",{value:5100,children:"5100"}),(0,r.jsx)("option",{value:5200,children:"5200"}),(0,r.jsx)("option",{value:5300,children:"5300"}),(0,r.jsx)("option",{value:5400,children:"5400"}),(0,r.jsx)("option",{value:5500,children:"5500"}),(0,r.jsx)("option",{value:5600,children:"5600"}),(0,r.jsx)("option",{value:5700,children:"5700"}),(0,r.jsx)("option",{value:5800,children:"5800"}),(0,r.jsx)("option",{value:5900,children:"5900"}),(0,r.jsx)("option",{value:6e3,children:"6000"}),(0,r.jsx)("option",{value:6100,children:"6100"}),(0,r.jsx)("option",{value:6200,children:"6200"}),(0,r.jsx)("option",{value:6300,children:"6300"}),(0,r.jsx)("option",{value:6400,children:"6400"}),(0,r.jsx)("option",{value:6500,children:"6500"}),(0,r.jsx)("option",{value:6600,children:"6600"}),(0,r.jsx)("option",{value:6700,children:"6700"}),(0,r.jsx)("option",{value:6800,children:"6800"}),(0,r.jsx)("option",{value:6900,children:"6900"}),(0,r.jsx)("option",{value:7e3,children:"7000"}),(0,r.jsx)("option",{value:7100,children:"7100"}),(0,r.jsx)("option",{value:7200,children:"7200"}),(0,r.jsx)("option",{value:7300,children:"7300"}),(0,r.jsx)("option",{value:7400,children:"7400"}),(0,r.jsx)("option",{value:7500,children:"7500"}),(0,r.jsx)("option",{value:7600,children:"7600"}),(0,r.jsx)("option",{value:7700,children:"7700"}),(0,r.jsx)("option",{value:7800,children:"7800"}),(0,r.jsx)("option",{value:7900,children:"7900"}),(0,r.jsx)("option",{value:8e3,children:"8000"}),(0,r.jsx)("option",{value:8100,children:"8100"}),(0,r.jsx)("option",{value:8200,children:"8200"}),(0,r.jsx)("option",{value:8300,children:"8300"}),(0,r.jsx)("option",{value:8400,children:"8400"}),(0,r.jsx)("option",{value:8500,children:"8500"}),(0,r.jsx)("option",{value:8600,children:"8600"}),(0,r.jsx)("option",{value:8700,children:"8700"}),(0,r.jsx)("option",{value:8800,children:"8800"}),(0,r.jsx)("option",{value:8900,children:"8900"}),(0,r.jsx)("option",{value:9e3,children:"9000"}),(0,r.jsx)("option",{value:9100,children:"9100"}),(0,r.jsx)("option",{value:9200,children:"9200"}),(0,r.jsx)("option",{value:9300,children:"9300"}),(0,r.jsx)("option",{value:9400,children:"9400"}),(0,r.jsx)("option",{value:9500,children:"9500"}),(0,r.jsx)("option",{value:9600,children:"9600"}),(0,r.jsx)("option",{value:9700,children:"9700"}),(0,r.jsx)("option",{value:9800,children:"9800"}),(0,r.jsx)("option",{value:9900,children:"9900"})]});case 5:return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("option",{value:0,children:"Seleccione una opci\xf3n"}),";",(0,r.jsx)("option",{value:1e4,children:"10000"}),(0,r.jsx)("option",{value:10100,children:"10100"}),(0,r.jsx)("option",{value:10200,children:"10200"}),(0,r.jsx)("option",{value:10300,children:"10300"}),(0,r.jsx)("option",{value:10400,children:"10400"}),(0,r.jsx)("option",{value:10500,children:"10500"}),(0,r.jsx)("option",{value:10600,children:"10600"}),(0,r.jsx)("option",{value:10700,children:"10700"}),(0,r.jsx)("option",{value:10800,children:"10800"}),(0,r.jsx)("option",{value:10900,children:"10900"}),(0,r.jsx)("option",{value:11e3,children:"11000"}),(0,r.jsx)("option",{value:11100,children:"11100"}),(0,r.jsx)("option",{value:11200,children:"11200"}),(0,r.jsx)("option",{value:11300,children:"11300"}),(0,r.jsx)("option",{value:11400,children:"11400"}),(0,r.jsx)("option",{value:11500,children:"11500"}),(0,r.jsx)("option",{value:11600,children:"11600"}),(0,r.jsx)("option",{value:11700,children:"11700"}),(0,r.jsx)("option",{value:11800,children:"11800"}),(0,r.jsx)("option",{value:11900,children:"11900"}),(0,r.jsx)("option",{value:12e3,children:"12000"}),(0,r.jsx)("option",{value:12100,children:"12100"}),(0,r.jsx)("option",{value:12200,children:"12200"}),(0,r.jsx)("option",{value:12300,children:"12300"}),(0,r.jsx)("option",{value:12400,children:"12400"}),(0,r.jsx)("option",{value:12500,children:"12500"}),(0,r.jsx)("option",{value:12600,children:"12600"}),(0,r.jsx)("option",{value:12700,children:"12700"}),(0,r.jsx)("option",{value:12800,children:"12800"}),(0,r.jsx)("option",{value:12900,children:"12900"}),(0,r.jsx)("option",{value:13e3,children:"13000"}),(0,r.jsx)("option",{value:13100,children:"13100"}),(0,r.jsx)("option",{value:13200,children:"13200"}),(0,r.jsx)("option",{value:13300,children:"13300"}),(0,r.jsx)("option",{value:13400,children:"13400"}),(0,r.jsx)("option",{value:13500,children:"13500"}),(0,r.jsx)("option",{value:13600,children:"13600"}),(0,r.jsx)("option",{value:13700,children:"13700"}),(0,r.jsx)("option",{value:13800,children:"13800"}),(0,r.jsx)("option",{value:13900,children:"13900"}),(0,r.jsx)("option",{value:14e3,children:"14000"}),(0,r.jsx)("option",{value:14100,children:"14100"}),(0,r.jsx)("option",{value:14200,children:"14200"}),(0,r.jsx)("option",{value:14300,children:"14300"}),(0,r.jsx)("option",{value:14400,children:"14400"}),(0,r.jsx)("option",{value:14500,children:"14500"}),(0,r.jsx)("option",{value:14600,children:"14600"}),(0,r.jsx)("option",{value:14700,children:"14700"}),(0,r.jsx)("option",{value:14800,children:"14800"}),(0,r.jsx)("option",{value:14900,children:"14900"}),(0,r.jsx)("option",{value:15e3,children:"15000"})]});default:return(0,r.jsx)("option",{value:0,children:"Seleccione una opci\xf3n"})}})(e.op)}),(0,r.jsx)("div",{className:"icon-container",children:(0,r.jsx)("i",{class:"bi bi-caret-down-fill"})})]})]}),(0,r.jsxs)("div",{className:"seccion4-mc",children:[(0,r.jsxs)("div",{className:"seccion5-mc",children:[(0,r.jsx)("p",{children:"Starter pack"}),(0,r.jsx)("img",{src:e.img,alt:"stp"})]}),(0,r.jsxs)("div",{className:"seccion6-mc",children:[(0,r.jsx)("div",{className:"seccion7-mc",children:(0,r.jsxs)("p",{children:["Capital income will be verified and approved within 24 hours. ",(0,r.jsx)("span",{children:"You will be notified once they have been approved."})]})}),(0,r.jsxs)("button",{className:"button",onClick:()=>(t=>{new uh(t).setRequest(),e.setIsVisible(!1)})(n),children:[(0,r.jsxs)("svg",{height:"24",width:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("path",{d:"M0 0h24v24H0z",fill:"none"}),(0,r.jsx)("path",{d:"M5 13c0-5.088 2.903-9.436 7-11.182C16.097 3.564 19 7.912 19 13c0 .823-.076 1.626-.22 2.403l1.94 1.832a.5.5 0 0 1 .095.603l-2.495 4.575a.5.5 0 0 1-.793.114l-2.234-2.234a1 1 0 0 0-.707-.293H9.414a1 1 0 0 0-.707.293l-2.234 2.234a.5.5 0 0 1-.793-.114l-2.495-4.575a.5.5 0 0 1 .095-.603l1.94-1.832C5.077 14.626 5 13.823 5 13zm1.476 6.696l.817-.817A3 3 0 0 1 9.414 18h5.172a3 3 0 0 1 2.121.879l.817.817.982-1.8-1.1-1.04a2 2 0 0 1-.593-1.82c.124-.664.187-1.345.187-2.036 0-3.87-1.995-7.3-5-8.96C8.995 5.7 7 9.13 7 13c0 .691.063 1.372.187 2.037a2 2 0 0 1-.593 1.82l-1.1 1.039.982 1.8zM12 13a2 2 0 1 1 0-4 2 2 0 0 1 0 4z",fill:"currentColor"})]}),(0,r.jsx)("span",{children:"End"})]})]})]})]})]})]})})},dh=()=>{const[e,n]=(0,t.useState)(!1),[i,s]=(0,t.useState)(0),[a,o]=(0,t.useState)("");return(0,r.jsxs)("section",{className:"Packs",children:[(0,r.jsx)(ih,{}),(0,r.jsx)(hh,{visible:e,setIsVisible:n,op:i,img:a}),(0,r.jsxs)("div",{className:"containPacks",children:[(0,r.jsxs)("div",{className:"titulo",children:[(0,r.jsx)("h1",{children:"STARTER PACKS"}),(0,r.jsx)("i",{class:"bi bi-boxes"})]}),(0,r.jsx)("div",{className:"seccion1-p",children:(0,r.jsx)(rh,{img:sh,setImg:o,setOpc:s,op:1,isVisible:e,setIsVisible:n})}),(0,r.jsx)("div",{className:"seccion2-p",children:(0,r.jsx)(rh,{img:ah,setImg:o,setOpc:s,op:2,isVisible:e,setIsVisible:n})}),(0,r.jsx)("div",{className:"seccion3-p",children:(0,r.jsx)(rh,{img:oh,setImg:o,setOpc:s,op:3,isVisible:e,setIsVisible:n})}),(0,r.jsx)("div",{className:"seccion4-p",children:(0,r.jsx)(rh,{img:lh,setImg:o,setOpc:s,op:4,isVisible:e,setIsVisible:n})}),(0,r.jsx)("div",{className:"seccion5-p",children:(0,r.jsx)(rh,{img:ch,setImg:o,setOpc:s,op:5,isVisible:e,setIsVisible:n})})]})]})},ph=e=>{const[n,i]=(0,t.useState)(!0);return(0,r.jsxs)("section",{className:"headerSec",children:[(0,r.jsx)("div",{className:"sech1",children:(0,r.jsx)("button",{className:"btnMenu",type:"button",onClick:t=>{t.preventDefault(),e.setMax(!n),i(!n)},children:(0,r.jsx)("i",{class:"bi bi-list"})})}),(0,r.jsx)("div",{className:"sech2"}),(0,r.jsx)("div",{className:"sech3"}),(0,r.jsx)("div",{className:"sech4",children:(0,r.jsx)(Kr,{})})]})},fh=()=>{const[e,n]=(0,t.useState)([]),i=new Hu(n),[s,o]=(0,t.useState)(!1);return(0,t.useEffect)((()=>{i.getUserData()}),[]),(0,r.jsx)("div",{className:"layout",children:(0,r.jsxs)("div",{className:"containDash",children:[(0,r.jsxs)("div",{className:"sidebar",children:[(0,r.jsx)($r,{max:s})," "]}),(0,r.jsx)("div",{className:"cabeza",children:(0,r.jsx)(ph,{setMax:o})}),(0,r.jsxs)("div",{className:"container",children:[(0,r.jsx)(ih,{}),(0,r.jsx)("div",{className:"contentSeccion",children:(0,r.jsxs)(a.Switch,{children:[(0,r.jsx)(a.Route,{path:"/Dashboard/home",component:function(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(nh,{userData:e})})}}),(0,r.jsx)(a.Route,{path:"/Dashboard/packs",component:function(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(dh,{})})}})]})})]})]})})};var mh=n(540),gh=n(321),vh=n(168),yh=n(587),_h=n(404),wh=function(e){function n(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).history=(0,gh.createBrowserHistory)(t.props),t}return(0,mh.A)(n,e),n.prototype.render=function(){return t.createElement(a.Router,{history:this.history,children:this.props.children})},n}(t.Component);t.Component;var xh=function(e,t){return"function"===typeof e?e(t):e},bh=function(e,t){return"string"===typeof e?(0,gh.createLocation)(e,null,null,t):e},Sh=function(e){return e},Nh=t.forwardRef;"undefined"===typeof Nh&&(Nh=Sh);var Mh=Nh((function(e,n){var i=e.innerRef,r=e.navigate,s=e.onClick,a=(0,yh.A)(e,["innerRef","navigate","onClick"]),o=a.target,l=(0,vh.A)({},a,{onClick:function(e){try{s&&s(e)}catch(t){throw e.preventDefault(),t}e.defaultPrevented||0!==e.button||o&&"_self"!==o||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)||(e.preventDefault(),r())}});return l.ref=Sh!==Nh&&n||i,t.createElement("a",l)}));var Th=Nh((function(e,n){var i=e.component,r=void 0===i?Mh:i,s=e.replace,o=e.to,l=e.innerRef,c=(0,yh.A)(e,["component","replace","to","innerRef"]);return t.createElement(a.__RouterContext.Consumer,null,(function(e){e||(0,_h.A)(!1);var i=e.history,a=bh(xh(o,e.location),e.location),u=a?i.createHref(a):"",h=(0,vh.A)({},c,{href:u,navigate:function(){var t=xh(o,e.location),n=(0,gh.createPath)(e.location)===(0,gh.createPath)(bh(t));(s||n?i.replace:i.push)(t)}});return Sh!==Nh?h.ref=n||l:h.innerRef=l,t.createElement(r,h)}))})),Ah=function(e){return e},Eh=t.forwardRef;"undefined"===typeof Eh&&(Eh=Ah);Eh((function(e,n){var i=e["aria-current"],r=void 0===i?"page":i,s=e.activeClassName,o=void 0===s?"active":s,l=e.activeStyle,c=e.className,u=e.exact,h=e.isActive,d=e.location,p=e.sensitive,f=e.strict,m=e.style,g=e.to,v=e.innerRef,y=(0,yh.A)(e,["aria-current","activeClassName","activeStyle","className","exact","isActive","location","sensitive","strict","style","to","innerRef"]);return t.createElement(a.__RouterContext.Consumer,null,(function(e){e||(0,_h.A)(!1);var i=d||e.location,s=bh(xh(g,i),i),_=s.pathname,w=_&&_.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),x=w?(0,a.matchPath)(i.pathname,{path:w,exact:u,sensitive:p,strict:f}):null,b=!!(h?h(x,i):x),S="function"===typeof c?c(b):c,N="function"===typeof m?m(b):m;b&&(S=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return e})).join(" ")}(S,o),N=(0,vh.A)({},N,l));var M=(0,vh.A)({"aria-current":b&&r||null,className:S,style:N,to:s},y);return Ah!==Eh?M.ref=n||v:M.innerRef=v,t.createElement(Th,M)}))}));const Ch=Gr(qr);const Ih=class{constructor(e,t,n,i,r){this.functAutentication=async e=>{e.preventDefault(),await this.getUserData();try{await Ti(Ch,this.email,this.password),"admin"===this.userRole?this.history.push("/admin"):this.history.push("/Dashboard/home")}catch(gs){console.error("Error durante el inicio de sesi\xf3n:",gs),this.email===this.userData.userName&&this.password===this.userData.password?(await Ti(Ch,this.userData.email,this.userData.password),"admin"===this.userRole?this.history.push("/admin"):this.history.push("/Dashboard/home")):(this.setTextError("The username or password is incorrect."),this.setDisplayError(!0))}},this.getUserData=async()=>{const e=Su(ju(qr),"users/"),t=await Au(e);if(t.exists()){const e=Object.values(t.val()),n=e.find((e=>e.email===this.email));if(n)this.userRole=n.rol,this.userData=n;else{const t=e.find((e=>e.userName===this.email));t&&(this.userRole=t.rol,this.userData=t)}}},this.comprobarVigencia=async()=>{const e=Su(ju(qr),"users/");try{const t=await Au(e);t.exists()?t.forEach((e=>{const t=e.val();this.compararFechaActual(t.validity)&&this.restarWallet(t.firebaseKey)})):console.log("No se encontraron usuarios en la base de datos.")}catch(gs){console.error("Error al obtener datos de Firebase:",gs.message)}},this.compararFechaActual=e=>{const t=new Date,n=t.getDate(),i=t.getMonth()+1,r=t.getFullYear(),s=e.split("/"),a=parseInt(s[0],10),o=parseInt(s[1],10),l=parseInt(s[2],10);return n===a&&i===o&&r===l},this.restarWallet=async e=>{const t=Su(ju(qr),"users/"+e),n=await Au(t);if(n.exists()){const e=n.val();e.wallet=e.wallet-25,Tu(t,e).then((()=>{})).catch((e=>{alert("Error al actualizar los datos: "+e.message)}))}else alert("El usuario con la clave "+e+" no existe.")},this.email=e,this.password=t,this.setTextError=n,this.setDisplayError=i,this.history=r,this.userRole="",this.userData=[]}};const Rh=function(e){const[n,i]=(0,t.useState)(!1),[s,a]=(0,t.useState)(100);return(0,t.useEffect)((()=>{let t;return i(e.visible),e.visible?t=setInterval((()=>{a((e=>e<=0?(clearInterval(t),i(!1),0):e-1))}),60):a(100),()=>clearInterval(t)}),[e.visible]),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"animated-div ".concat(n?"visible":""),children:[(0,r.jsx)("div",{className:e.color?"texto-green":"texto-red",children:(0,r.jsx)("span",{children:e.text})}),n&&(0,r.jsx)("div",{className:"progress-container",children:(0,r.jsx)("div",{className:"progress-bar",style:{width:"".concat(s,"%")}})})]})})},Ph=()=>{const[e,n]=(0,t.useState)(!1),[i,s]=(0,t.useState)(""),[o,l]=(0,t.useState)(""),[c,u]=(0,t.useState)(""),[h,d]=(0,t.useState)(!1),p=(0,a.useHistory)(),f=new Ih(i,o,u,d,p);return(0,r.jsxs)("div",{className:"login-seccion",children:[(0,r.jsx)(Rh,{visible:h,text:c}),(0,r.jsxs)("div",{className:"login-main-box",children:[(0,r.jsxs)("div",{className:"login-box",children:[(0,r.jsx)("img",{alt:"logo"}),(0,r.jsxs)("div",{className:"lg",children:[(0,r.jsx)("hr",{}),(0,r.jsx)("span",{children:"sing in"}),(0,r.jsx)("hr",{})]}),(0,r.jsxs)("form",{children:[(0,r.jsx)("label",{htmlFor:"username",children:"Username"}),(0,r.jsx)("input",{type:"text",placeholder:"Enter Username",value:i,onChange:e=>s(e.target.value)}),(0,r.jsx)("label",{htmlFor:"password",children:"Password"}),(0,r.jsxs)("div",{className:"password",children:[(0,r.jsx)("input",{type:e?"text":"password",placeholder:"Enter Password",value:o,onChange:e=>l(e.target.value)}),(0,r.jsx)("button",{className:"show",onClick:t=>{t.preventDefault(),n(!e)},children:(0,r.jsx)("i",{className:e?"bi bi-eye-slash":"bi bi-eye"})})]}),(0,r.jsx)("input",{type:"submit",value:"LogIn",onClick:e=>(async e=>{f.functAutentication(e),h&&d(!1)})(e)}),(0,r.jsx)(Th,{to:"/recovery_password",children:(0,r.jsx)("p",{className:"fyp",children:"Forgot your password?"})})]})]}),(0,r.jsx)("img",{className:"imagen",alt:"img1"})]})]})};const Dh=class{constructor(e,t,n,i,r,s,a,o,l,c,u,h,d,p,f,m,g,v,y,_,w,x,b,S,N,M){this.firstName=n,this.lastName=t,this.country=a,this.phoneNumber=o,this.admissionDate=u,this.firebaseKey=d,this.rol=p,this.userName=e,this.email=i,this.password=r,this.referredBy=s,this.validity=l,this.usdtAddress=h,this.rank=c,this.request=N,this.walletDiv=f,this.walletCom=m,this.bonoRefDirect=g,this.bonoFastTrack=v,this.bonoIgualacion=y,this.bonoIgualacionSem=_,this.bonoIngresoRes=w,this.bonoRangoRes=x,this.firtsAdd=b,this.activo=S,this.userPermisos=M}setDefaultValues(){this.userName="",this.lastName="",this.firstName="",this.email="",this.password="",this.referredBy="",this.rank=0,this.country="",this.phoneNumber="",this.usdtAddress="",this.admissionDate="",this.firebaseKey="",this.rol="u",this.validity="",this.request=0,this.userPermisos="11111111",this.walletDiv=0,this.walletCom=0,this.bonoRefDirect=0,this.bonoFastTrack=0,this.bonoIgualacion=0,this.bonoIgualacionSem=0,this.bonoIngresoRes=0,this.bonoRangoRes=0,this.firtsAdd=!1,this.activo=!1}};class kh{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Network Error";this.status=e,this.text=t}}const Lh={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:(()=>{if("undefined"!==typeof localStorage)return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,t)=>Promise.resolve(localStorage.setItem(e,t)),remove:e=>Promise.resolve(localStorage.removeItem(e))}})()},Oh=e=>e?"string"===typeof e?{publicKey:e}:"[object Object]"===e.toString()?e:{}:{},Bh=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=await fetch(Lh.origin+e,{method:"POST",headers:n,body:t}),r=await i.text(),s=new kh(i.status,r);if(i.ok)return s;throw s},Uh=(e,t,n)=>{if(!e||"string"!==typeof e)throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!t||"string"!==typeof t)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!n||"string"!==typeof n)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},zh=e=>e.webdriver||!e.languages||0===e.languages.length,Vh=()=>new kh(451,"Unavailable For Headless Browser"),Fh=(e,t)=>{if((e=>{var t;return!(null!==(t=e.list)&&void 0!==t&&t.length)||!e.watchVariable})(e))return!1;((e,t)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if("string"!==typeof t)throw"The BlockList watchVariable has to be a string"})(e.list,e.watchVariable);const n=(i=t,r=e.watchVariable,i instanceof FormData?i.get(r):i[r]);var i,r;return"string"===typeof n&&e.list.includes(n)},jh=()=>new kh(403,"Forbidden"),Hh=async(e,t,n)=>{if(!t.throttle||!n)return!1;((e,t)=>{if("number"!==typeof e||e<0)throw"The LimitRate throttle has to be a positive number";if(t&&"string"!==typeof t)throw"The LimitRate ID has to be a string"})(t.throttle,t.id);const i=t.id||e,r=await(async(e,t,n)=>{const i=Number(await n.get(e)||0);return t-Date.now()+i})(i,t.throttle,n);return r>0||(await n.set(i,Date.now().toString()),!1)},Gh=()=>new kh(429,"Too Many Requests"),Wh=async(e,t,n,i)=>{const r=Oh(i),s=r.publicKey||Lh.publicKey,a=r.blockHeadless||Lh.blockHeadless,o=Lh.storageProvider||r.storageProvider,l={...Lh.blockList,...r.blockList},c={...Lh.limitRate,...r.limitRate};if(a&&zh(navigator))return Promise.reject(Vh());if(Uh(s,e,t),(e=>{if(e&&"[object Object]"!==e.toString())throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"})(n),n&&Fh(l,n))return Promise.reject(jh());if(await Hh(location.pathname,c,o))return Promise.reject(Gh());const u={lib_version:"4.3.3",user_id:s,service_id:e,template_id:t,template_params:n};return Bh("/api/v1.0/email/send",JSON.stringify(u),{"Content-type":"application/json"})},Yh=n.p+"static/media/Logo_1.aad1b99bbf59c450c9f4.png";const qh=class{constructor(e,t){this.sendEmail=e=>{this.userName,this.email;Wh("service_29h17gr","template_ci96cck",{from_name:this.email,to_name:this.userName,message:"'Hola, bienvenido a LegalCapital'"},{publicKey:"mfhKxadOmeTx0rXBs"}).then((()=>{console.log("SUCCESS!")}),(e=>{console.log("FAILED...",e.text)}))},this.email=t,this.userName=e}};const Xh=class{constructor(e,t,n,i,r,s,a,o,l){this.saveData=async()=>{const e=new Dh;e.setDefaultValues();const t=Mu(Su(ju(qr),"users/")),n=new Date,i=n.getDate(),r=n.getMonth()+1,s=n.getFullYear(),a="".concat(i,"-").concat(r,"-").concat(s);e.email=this.email,e.password=this.password,e.referredBy=this.referredBy,e.userName=this.userName,e.password=this.password,e.admissionDate=a,e.firebaseKey=t.key;try{await Tu(t,e)}catch(gs){console.log(gs)}},this.functRegister=async e=>{Gr(qr);e.preventDefault();try{await this.saveData()}catch(gs){switch(gs.code){case"auth/email-already-in-use":this.setTextError("The email address is already in use. Please choose another."),this.setMsjError(!0);break;case"auth/invalid-email":this.setTextError("The email address provided is invalid."),this.setMsjError(!0);break;case"auth/too-many-requests":this.setTextError("Too many unsuccessful login attempts. Please try again later."),this.setMsjError(!0);break;default:this.setTextError("An error occurred during registration. Please try again later."),this.setMsjError(!0)}}},this.userName=e,this.email=t,this.password=n,this.passwordConf=i,this.referredBy=r,this.textError=s,this.setbtnActive=l,this.setTextError=a,this.setMsjError=o,this.common=new Hu,this.welcomeEmail=new qh(e,t)}blurPass(){this.password.length<6&&!this.msjError?(this.setMsjError(!0),this.setTextError("Password should contain at least 6 characters.")):(this.setMsjError(!1),this.setTextError(""))}blurPassConf(){this.password===this.passwordConf||this.msjError?(this.setMsjError(!1),this.setTextError("")):(this.setMsjError(!0),this.setTextError("Passwords do not match."))}activateButton(){this.common.isNullOrEmpty(this.userName)||this.common.isNullOrEmpty(this.email)||this.common.isNullOrEmpty(this.password)||this.common.isNullOrEmpty(this.passwordConf)?this.setbtnActive(!1):this.setbtnActive(!0)}valid(e){""===this.textError&&this.functRegister(e)}},Kh=()=>{const[e,n]=(0,t.useState)(""),[i,s]=(0,t.useState)(""),[o,l]=(0,t.useState)(""),[c,u]=(0,t.useState)(""),[h,d]=(0,t.useState)(""),[p,f]=(0,t.useState)(""),[m,g]=(0,t.useState)(!1),[v,y]=(0,t.useState)(!1),_=new Xh(o,e,i,h,c,p,f,y,g),{r:w}=(0,a.useParams)();(0,t.useEffect)((()=>{u(w||"")}),[w]),(0,t.useEffect)((()=>{_.activateButton()}),[o,e,i,h]);return(0,r.jsxs)("div",{className:"register-seccion",children:[(0,r.jsx)(Rh,{visible:v,text:p}),(0,r.jsxs)("div",{className:"form-register",children:[(0,r.jsx)("img",{alt:"logo"}),(0,r.jsx)("h2",{children:"Sing up"}),(0,r.jsx)("h4",{children:"Enter your username, email and password to register"}),(0,r.jsx)("span",{children:"Username:"}),(0,r.jsx)("input",{type:"text",placeholder:"Enter your Username",value:o,onChange:e=>l(e.target.value)}),(0,r.jsx)("span",{children:"Email:"}),(0,r.jsx)("input",{type:"email",placeholder:"Enter your E-mail",value:e,onChange:e=>n(e.target.value)}),(0,r.jsx)("span",{children:"Password"}),(0,r.jsx)("input",{type:"password",onBlur:()=>{_.blurPass()},placeholder:"Enter your password",value:i,onChange:e=>s(e.target.value)}),(0,r.jsx)("span",{children:"Confirm your password"}),(0,r.jsx)("input",{type:"password",onBlur:()=>{_.blurPassConf()},placeholder:"confirm your password",value:h,onChange:e=>d(e.target.value)}),(0,r.jsx)("label",{htmlFor:"reference",children:"Referred by:"}),(0,r.jsx)("input",{type:"text",name:"referred",id:"referred",readOnly:!0,value:c,onChange:e=>u(e.target.value)}),(0,r.jsx)("h5",{className:"tac",children:'"By registering, you agree to all terms and conditions."'}),(0,r.jsx)("input",{className:m?"botons":"botonsE",type:"submit",value:"Register",onClick:e=>(e=>{_.valid(e)})(e)})]}),(0,r.jsxs)("div",{className:"msj-seccion",children:[(0,r.jsx)("img",{className:"img1",alt:"img1"}),(0,r.jsx)("img",{className:"img2",alt:"img2"}),(0,r.jsx)("span",{children:"Sign up now and start investing in your future!"})]})]})};const Jh=class{constructor(e,t,n,i,r){this.userName=e,this.email=t,this.firebaseKey=n,this.request=i,this.dateRequest=r}setDefaultValues(){this.userName="",this.email="",this.firebaseKey="",this.request=0,this.dateRequest=""}};const $h=class{constructor(e){this.fetchData=async()=>{const e=Su(ju(qr),"users"),t=await Au(e);if(t.exists()){const e=Object.values(t.val()).filter((e=>0!==e.request));this.setUserModels(e)}else alert("error")},this.findData=async e=>{const t=Su(ju(qr),"users"),n=await Au(t);if(n.exists()){const t=Object.values(n.val()).filter((t=>!(!t.email||!t.membership)&&(t.email.includes(e)&&0!==t.request)));this.setUserModels(t)}else alert("error")},this.aprobar=async e=>{const t=new Jh;t.setDefaultValues();const n=Su(ju(qr),"users/"+e),i=await Au(n);if(i.exists()){const e=i.val();""===e.validity&&(e.validity=this.obtenerFechaVencimiento()),e.walletDiv=e.walletDiv+e.request,t.request=e.request,e.request=0,e.firstAdd||(this.bonoReferenciaDirecta(e.referredBy,e.walletDiv),e.firstAdd=!0),Tu(n,e).then((()=>{this.fetchData(),t.userName=e.userName,t.email=e.email,this.saveHistoryRequest(t)})).catch((e=>{alert("Error al actualizar los datos: "+e.message)}))}else alert("El usuario con la clave "+e+" no existe.")},this.denegar=async e=>{const t=Su(ju(qr),"users/"+e),n=await Au(t);if(n.exists()){const e=n.val();e.request=0,Tu(t,e).then((()=>{this.fetchData()})).catch((e=>{alert("Error al actualizar los datos: "+e.message)}))}else alert("El usuario con la clave "+e+" no existe.")},this.saveHistoryRequest=async e=>{const t=Mu(Su(ju(qr),"historyRequest/")),n=new Date;e.dateRequest=n.toISOString(),e.firebaseKey=t.key;try{await Tu(t,e)}catch(gs){console.log(gs)}},this.bonoReferenciaDirecta=async(e,t)=>{const n=new Hu;try{const i=Su(ju(qr),"users"),r=await Au(i);if(r.exists()){const i=Object.values(r.val()).find((t=>t.userName===e));if(i){const e=i.userName,r=this.determinarBono(t);alert(e),n.addToWallet(e,r)}else console.log("Usuario no encontrado")}}catch(gs){return console.error("Error finding user by username:",gs),null}},this.determinarBono=e=>{let t=0;switch(!0){case e>=100&&e<=499:t=10;break;case e>500&&e<=2499:t=50;break;case e>2500&&e<=4999:t=125;break;case e>5e3&&e<=9999:t=250;break;case e>1e4&&e<=24999:t=500;break;case e>25e3&&e<=99999:t=1250;break;default:t=5e3}return t},this.setUserModels=e}obtenerFechaVencimiento(){const e=new Date,t=new Date(e);t.setDate(e.getDate()+30);const n=t.getDate().toString().padStart(2,"0"),i=(t.getMonth()+1).toString().padStart(2,"0"),r=t.getFullYear().toString();return"".concat(n,"/").concat(i,"/").concat(r)}},Qh=e=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"nameA",children:e.titulo}),(0,r.jsx)("input",{type:"text",className:"valor",value:e.value,onChange:t=>{e.setValue(t.target.value)}})]}),Zh="vertex",ed="none",td="frame",nd="render",id="object",rd=["x","y","z","w"],sd="163",ad=0,od=1,ld=100,cd=0,ud=0,hd=1,dd=2,pd=3,fd=4,md=6,gd=1e3,vd=1001,yd=1002,_d=1003,wd=1006,xd=1008,bd=1009,Sd=1014,Nd=1015,Md=1016,Td=1020,Ad=1023,Ed=1026,Cd=1027,Id=2300,Rd=2301,Pd=2302,Dd=2400,kd=2401,Ld=2402,Od="",Bd="srgb",Ud="srgb-linear",zd="display-p3",Vd="display-p3-linear",Fd="linear",jd="srgb",Hd="rec709",Gd="p3",Wd=7680,Yd=35044,qd=35048,Xd=2e3,Kd=2001;class Jd{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,i=n.length;t<i;t++)n[t].call(this,e);e.target=null}}}const $d=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Qd=1234567;const Zd=Math.PI/180,ep=180/Math.PI;function tp(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return($d[255&e]+$d[e>>8&255]+$d[e>>16&255]+$d[e>>24&255]+"-"+$d[255&t]+$d[t>>8&255]+"-"+$d[t>>16&15|64]+$d[t>>24&255]+"-"+$d[63&n|128]+$d[n>>8&255]+"-"+$d[n>>16&255]+$d[n>>24&255]+$d[255&i]+$d[i>>8&255]+$d[i>>16&255]+$d[i>>24&255]).toLowerCase()}function np(e,t,n){return Math.max(t,Math.min(n,e))}function ip(e,t){return(e%t+t)%t}function rp(e,t,n){return(1-n)*e+n*t}function sp(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function ap(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const op={DEG2RAD:Zd,RAD2DEG:ep,generateUUID:tp,clamp:np,euclideanModulo:ip,mapLinear:function(e,t,n,i,r){return i+(e-t)*(r-i)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:rp,damp:function(e,t,n,i){return rp(e,t,1-Math.exp(-n*i))},pingpong:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(ip(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(Qd=e);let t=Qd+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*Zd},radToDeg:function(e){return e*ep},isPowerOfTwo:function(e){return 0===(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,i,r){const s=Math.cos,a=Math.sin,o=s(n/2),l=a(n/2),c=s((t+i)/2),u=a((t+i)/2),h=s((t-i)/2),d=a((t-i)/2),p=s((i-t)/2),f=a((i-t)/2);switch(r){case"XYX":e.set(o*u,l*h,l*d,o*c);break;case"YZY":e.set(l*d,o*u,l*h,o*c);break;case"ZXZ":e.set(l*h,l*d,o*u,o*c);break;case"XZX":e.set(o*u,l*f,l*p,o*c);break;case"YXY":e.set(l*p,o*u,l*f,o*c);break;case"ZYZ":e.set(l*f,l*p,o*u,o*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:ap,denormalize:sp};class lp{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;lp.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(np(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),r=this.x-e.x,s=this.y-e.y;return this.x=r*n-s*i+e.x,this.y=r*i+s*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class cp{constructor(e,t,n,i,r,s,a,o,l){cp.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,i,r,s,a,o,l)}set(e,t,n,i,r,s,a,o,l){const c=this.elements;return c[0]=e,c[1]=i,c[2]=a,c[3]=t,c[4]=r,c[5]=o,c[6]=n,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,s=n[0],a=n[3],o=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],p=n[8],f=i[0],m=i[3],g=i[6],v=i[1],y=i[4],_=i[7],w=i[2],x=i[5],b=i[8];return r[0]=s*f+a*v+o*w,r[3]=s*m+a*y+o*x,r[6]=s*g+a*_+o*b,r[1]=l*f+c*v+u*w,r[4]=l*m+c*y+u*x,r[7]=l*g+c*_+u*b,r[2]=h*f+d*v+p*w,r[5]=h*m+d*y+p*x,r[8]=h*g+d*_+p*b,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8];return t*s*c-t*a*l-n*r*c+n*a*o+i*r*l-i*s*o}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],u=c*s-a*l,h=a*o-c*r,d=l*r-s*o,p=t*u+n*h+i*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return e[0]=u*f,e[1]=(i*l-c*n)*f,e[2]=(a*n-i*s)*f,e[3]=h*f,e[4]=(c*t-i*o)*f,e[5]=(i*r-a*t)*f,e[6]=d*f,e[7]=(n*o-l*t)*f,e[8]=(s*t-n*r)*f,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,r,s,a){const o=Math.cos(r),l=Math.sin(r);return this.set(n*o,n*l,-n*(o*s+l*a)+s+e,-i*l,i*o,-i*(-l*s+o*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(up.makeScale(e,t)),this}rotate(e){return this.premultiply(up.makeRotation(-e)),this}translate(e,t){return this.premultiply(up.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const up=new cp;function hp(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function dp(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}const pp={};function fp(e){e in pp||(pp[e]=!0,console.warn(e))}const mp=(new cp).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),gp=(new cp).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),vp={[Ud]:{transfer:Fd,primaries:Hd,toReference:e=>e,fromReference:e=>e},[Bd]:{transfer:jd,primaries:Hd,toReference:e=>e.convertSRGBToLinear(),fromReference:e=>e.convertLinearToSRGB()},[Vd]:{transfer:Fd,primaries:Gd,toReference:e=>e.applyMatrix3(gp),fromReference:e=>e.applyMatrix3(mp)},[zd]:{transfer:jd,primaries:Gd,toReference:e=>e.convertSRGBToLinear().applyMatrix3(gp),fromReference:e=>e.applyMatrix3(mp).convertLinearToSRGB()}},yp=new Set([Ud,Vd]),_p={enabled:!0,_workingColorSpace:Ud,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(e){if(!yp.has(e))throw new Error('Unsupported working color space, "'.concat(e,'".'));this._workingColorSpace=e},convert:function(e,t,n){if(!1===this.enabled||t===n||!t||!n)return e;const i=vp[t].toReference;return(0,vp[n].fromReference)(i(e))},fromWorkingColorSpace:function(e,t){return this.convert(e,this._workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this._workingColorSpace)},getPrimaries:function(e){return vp[e].primaries},getTransfer:function(e){return e===Od?Fd:vp[e].transfer}};function wp(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function xp(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}let bp;class Sp{static getDataURL(e){if(/^data:/i.test(e.src))return e.src;if("undefined"===typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===bp&&(bp=dp("canvas")),bp.width=e.width,bp.height=e.height;const n=bp.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=bp}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){const t=dp("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const i=n.getImageData(0,0,e.width,e.height),r=i.data;for(let e=0;e<r.length;e++)r[e]=255*wp(r[e]/255);return n.putImageData(i,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*wp(t[e]/255)):t[e]=wp(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Np=0;class Mp{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isSource=!0,Object.defineProperty(this,"id",{value:Np++}),this.uuid=tp(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(null!==i){let e;if(Array.isArray(i)){e=[];for(let t=0,n=i.length;t<n;t++)i[t].isDataTexture?e.push(Tp(i[t].image)):e.push(Tp(i[t]))}else e=Tp(i);n.url=e}return t||(e.images[this.uuid]=n),n}}function Tp(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?Sp.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Ap=0;class Ep extends Jd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ep.DEFAULT_IMAGE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ep.DEFAULT_MAPPING,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vd,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:vd,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:wd,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:xd,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Ad,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:bd,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Ep.DEFAULT_ANISOTROPY,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:Od;super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Ap++}),this.uuid=tp(),this.name="",this.source=new Mp(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new lp(0,0),this.repeat=new lp(1,1),this.center=new lp(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new cp,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e){void 0===e&&(e=null),this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case gd:e.x=e.x-Math.floor(e.x);break;case vd:e.x=e.x<0?0:1;break;case yd:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case gd:e.y=e.y-Math.floor(e.y);break;case vd:e.y=e.y<0?0:1;break;case yd:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){!0===e&&this.pmremVersion++}}Ep.DEFAULT_IMAGE=null,Ep.DEFAULT_MAPPING=300,Ep.DEFAULT_ANISOTROPY=1;class Cp{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Cp.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=this.w,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*i+s[12]*r,this.y=s[1]*t+s[5]*n+s[9]*i+s[13]*r,this.z=s[2]*t+s[6]*n+s[10]*i+s[14]*r,this.w=s[3]*t+s[7]*n+s[11]*i+s[15]*r,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,r;const s=.01,a=.1,o=e.elements,l=o[0],c=o[4],u=o[8],h=o[1],d=o[5],p=o[9],f=o[2],m=o[6],g=o[10];if(Math.abs(c-h)<s&&Math.abs(u-f)<s&&Math.abs(p-m)<s){if(Math.abs(c+h)<a&&Math.abs(u+f)<a&&Math.abs(p+m)<a&&Math.abs(l+d+g-3)<a)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,o=(d+1)/2,v=(g+1)/2,y=(c+h)/4,_=(u+f)/4,w=(p+m)/4;return e>o&&e>v?e<s?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(e),i=y/n,r=_/n):o>v?o<s?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(o),n=y/i,r=w/i):v<s?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(v),n=_/r,i=w/r),this.set(n,i,r,t),this}let v=Math.sqrt((m-p)*(m-p)+(u-f)*(u-f)+(h-c)*(h-c));return Math.abs(v)<.001&&(v=1),this.x=(m-p)/v,this.y=(u-f)/v,this.z=(h-c)/v,this.w=Math.acos((l+d+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Ip extends Jd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Cp(0,0,e,t),this.scissorTest=!1,this.viewport=new Cp(0,0,e,t);const i={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:wd,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0,count:1},n);const r=new Ep(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);r.flipY=!1,r.generateMipmaps=n.generateMipmaps,r.internalFormat=n.internalFormat,this.textures=[];const s=n.count;for(let a=0;a<s;a++)this.textures[a]=r.clone(),this.textures[a].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,r=this.textures.length;i<r;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,i=e.textures.length;n<i;n++)this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Mp(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Rp extends Ep{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=_d,this.minFilter=_d,this.wrapR=vd,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Pp{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,r,s,a){let o=n[i+0],l=n[i+1],c=n[i+2],u=n[i+3];const h=r[s+0],d=r[s+1],p=r[s+2],f=r[s+3];if(0===a)return e[t+0]=o,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(1===a)return e[t+0]=h,e[t+1]=d,e[t+2]=p,void(e[t+3]=f);if(u!==f||o!==h||l!==d||c!==p){let e=1-a;const t=o*h+l*d+c*p+u*f,n=t>=0?1:-1,i=1-t*t;if(i>Number.EPSILON){const r=Math.sqrt(i),s=Math.atan2(r,t*n);e=Math.sin(e*s)/r,a=Math.sin(a*s)/r}const r=a*n;if(o=o*e+h*r,l=l*e+d*r,c=c*e+p*r,u=u*e+f*r,e===1-a){const e=1/Math.sqrt(o*o+l*l+c*c+u*u);o*=e,l*=e,c*=e,u*=e}}e[t]=o,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,n,i,r,s){const a=n[i],o=n[i+1],l=n[i+2],c=n[i+3],u=r[s],h=r[s+1],d=r[s+2],p=r[s+3];return e[t]=a*p+c*u+o*d-l*h,e[t+1]=o*p+c*h+l*u-a*d,e[t+2]=l*p+c*d+a*h-o*u,e[t+3]=c*p-a*u-o*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=e._x,i=e._y,r=e._z,s=e._order,a=Math.cos,o=Math.sin,l=a(n/2),c=a(i/2),u=a(r/2),h=o(n/2),d=o(i/2),p=o(r/2);switch(s){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],r=t[8],s=t[1],a=t[5],o=t[9],l=t[2],c=t[6],u=t[10],h=n+a+u;if(h>0){const e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(c-o)*e,this._y=(r-l)*e,this._z=(s-i)*e}else if(n>a&&n>u){const e=2*Math.sqrt(1+n-a-u);this._w=(c-o)/e,this._x=.25*e,this._y=(i+s)/e,this._z=(r+l)/e}else if(a>u){const e=2*Math.sqrt(1+a-n-u);this._w=(r-l)/e,this._x=(i+s)/e,this._y=.25*e,this._z=(o+c)/e}else{const e=2*Math.sqrt(1+u-n-a);this._w=(s-i)/e,this._x=(r+l)/e,this._y=(o+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(np(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,r=e._z,s=e._w,a=t._x,o=t._y,l=t._z,c=t._w;return this._x=n*c+s*a+i*l-r*o,this._y=i*c+s*o+r*a-n*l,this._z=r*c+s*l+n*o-i*a,this._w=s*c-n*a-i*o-r*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,i=this._y,r=this._z,s=this._w;let a=s*e._w+n*e._x+i*e._y+r*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=s,this._x=n,this._y=i,this._z=r,this;const o=1-a*a;if(o<=Number.EPSILON){const e=1-t;return this._w=e*s+t*this._w,this._x=e*n+t*this._x,this._y=e*i+t*this._y,this._z=e*r+t*this._z,this.normalize(),this}const l=Math.sqrt(o),c=Math.atan2(l,a),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=s*u+this._w*h,this._x=n*u+this._x*h,this._y=i*u+this._y*h,this._z=r*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),i=Math.sqrt(1-n),r=Math.sqrt(n);return this.set(i*Math.sin(e),i*Math.cos(e),r*Math.sin(t),r*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Dp{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Dp.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Lp.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Lp.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=e.elements,s=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*s,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*s,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*s,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,r=e.x,s=e.y,a=e.z,o=e.w,l=2*(s*i-a*n),c=2*(a*t-r*i),u=2*(r*n-s*t);return this.x=t+o*l+s*u-a*c,this.y=n+o*c+a*l-r*u,this.z=i+o*u+r*c-s*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,r=e.z,s=t.x,a=t.y,o=t.z;return this.x=i*o-r*a,this.y=r*s-n*o,this.z=n*a-i*s,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return kp.copy(this).projectOnVector(e),this.sub(kp)}reflect(e){return this.sub(kp.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(np(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const kp=new Dp,Lp=new Pp;class Op{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dp(1/0,1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Dp(-1/0,-1/0,-1/0);this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Up.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Up.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Up.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n){const i=n.getAttribute("position");if(!0===t&&void 0!==i&&!0!==e.isInstancedMesh)for(let t=0,n=i.count;t<n;t++)!0===e.isMesh?e.getVertexPosition(t,Up):Up.fromBufferAttribute(i,t),Up.applyMatrix4(e.matrixWorld),this.expandByPoint(Up);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),zp.copy(e.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),zp.copy(n.boundingBox)),zp.applyMatrix4(e.matrixWorld),this.union(zp)}const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Up),Up.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Yp),qp.subVectors(this.max,Yp),Vp.subVectors(e.a,Yp),Fp.subVectors(e.b,Yp),jp.subVectors(e.c,Yp),Hp.subVectors(Fp,Vp),Gp.subVectors(jp,Fp),Wp.subVectors(Vp,jp);let t=[0,-Hp.z,Hp.y,0,-Gp.z,Gp.y,0,-Wp.z,Wp.y,Hp.z,0,-Hp.x,Gp.z,0,-Gp.x,Wp.z,0,-Wp.x,-Hp.y,Hp.x,0,-Gp.y,Gp.x,0,-Wp.y,Wp.x,0];return!!Jp(t,Vp,Fp,jp,qp)&&(t=[1,0,0,0,1,0,0,0,1],!!Jp(t,Vp,Fp,jp,qp)&&(Xp.crossVectors(Hp,Gp),t=[Xp.x,Xp.y,Xp.z],Jp(t,Vp,Fp,jp,qp)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Up).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Up).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Bp[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Bp[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Bp[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Bp[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Bp[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Bp[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Bp[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Bp[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Bp)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Bp=[new Dp,new Dp,new Dp,new Dp,new Dp,new Dp,new Dp,new Dp],Up=new Dp,zp=new Op,Vp=new Dp,Fp=new Dp,jp=new Dp,Hp=new Dp,Gp=new Dp,Wp=new Dp,Yp=new Dp,qp=new Dp,Xp=new Dp,Kp=new Dp;function Jp(e,t,n,i,r){for(let s=0,a=e.length-3;s<=a;s+=3){Kp.fromArray(e,s);const a=r.x*Math.abs(Kp.x)+r.y*Math.abs(Kp.y)+r.z*Math.abs(Kp.z),o=t.dot(Kp),l=n.dot(Kp),c=i.dot(Kp);if(Math.max(-Math.max(o,l,c),Math.min(o,l,c))>a)return!1}return!0}const $p=new Op,Qp=new Dp,Zp=new Dp;class ef{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dp,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):$p.setFromPoints(e).getCenter(n);let i=0;for(let r=0,s=e.length;r<s;r++)i=Math.max(i,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Qp.subVectors(e,this.center);const t=Qp.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.addScaledVector(Qp,n/e),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(Zp.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Qp.copy(e.center).add(Zp)),this.expandByPoint(Qp.copy(e.center).sub(Zp))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const tf=new Dp,nf=new Dp,rf=new Dp,sf=new Dp,af=new Dp,of=new Dp,lf=new Dp;class cf{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dp,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Dp(0,0,-1);this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,tf)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=tf.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(tf.copy(this.origin).addScaledVector(this.direction,t),tf.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){nf.copy(e).add(t).multiplyScalar(.5),rf.copy(t).sub(e).normalize(),sf.copy(this.origin).sub(nf);const r=.5*e.distanceTo(t),s=-this.direction.dot(rf),a=sf.dot(this.direction),o=-sf.dot(rf),l=sf.lengthSq(),c=Math.abs(1-s*s);let u,h,d,p;if(c>0)if(u=s*o-a,h=s*a-o,p=r*c,u>=0)if(h>=-p)if(h<=p){const e=1/c;u*=e,h*=e,d=u*(u+s*h+2*a)+h*(s*u+h+2*o)+l}else h=r,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;else h=-r,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;else h<=-p?(u=Math.max(0,-(-s*r+a)),h=u>0?-r:Math.min(Math.max(-r,-o),r),d=-u*u+h*(h+2*o)+l):h<=p?(u=0,h=Math.min(Math.max(-r,-o),r),d=h*(h+2*o)+l):(u=Math.max(0,-(s*r+a)),h=u>0?r:Math.min(Math.max(-r,-o),r),d=-u*u+h*(h+2*o)+l);else h=s>0?-r:r,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,u),i&&i.copy(nf).addScaledVector(rf,h),d}intersectSphere(e,t){tf.subVectors(e.center,this.origin);const n=tf.dot(this.direction),i=tf.dot(tf)-n*n,r=e.radius*e.radius;if(i>r)return null;const s=Math.sqrt(r-i),a=n-s,o=n+s;return o<0?null:a<0?this.at(o,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,r,s,a,o;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,i=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,i=(e.min.x-h.x)*l),c>=0?(r=(e.min.y-h.y)*c,s=(e.max.y-h.y)*c):(r=(e.max.y-h.y)*c,s=(e.min.y-h.y)*c),n>s||r>i?null:((r>n||isNaN(n))&&(n=r),(s<i||isNaN(i))&&(i=s),u>=0?(a=(e.min.z-h.z)*u,o=(e.max.z-h.z)*u):(a=(e.max.z-h.z)*u,o=(e.min.z-h.z)*u),n>o||a>i?null:((a>n||n!==n)&&(n=a),(o<i||i!==i)&&(i=o),i<0?null:this.at(n>=0?n:i,t)))}intersectsBox(e){return null!==this.intersectBox(e,tf)}intersectTriangle(e,t,n,i,r){af.subVectors(t,e),of.subVectors(n,e),lf.crossVectors(af,of);let s,a=this.direction.dot(lf);if(a>0){if(i)return null;s=1}else{if(!(a<0))return null;s=-1,a=-a}sf.subVectors(this.origin,e);const o=s*this.direction.dot(of.crossVectors(sf,of));if(o<0)return null;const l=s*this.direction.dot(af.cross(sf));if(l<0)return null;if(o+l>a)return null;const c=-s*sf.dot(lf);return c<0?null:this.at(c/a,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class uf{constructor(e,t,n,i,r,s,a,o,l,c,u,h,d,p,f,m){uf.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,n,i,r,s,a,o,l,c,u,h,d,p,f,m)}set(e,t,n,i,r,s,a,o,l,c,u,h,d,p,f,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=i,g[1]=r,g[5]=s,g[9]=a,g[13]=o,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new uf).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/hf.setFromMatrixColumn(e,0).length(),r=1/hf.setFromMatrixColumn(e,1).length(),s=1/hf.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*s,t[9]=n[9]*s,t[10]=n[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,i=e.y,r=e.z,s=Math.cos(n),a=Math.sin(n),o=Math.cos(i),l=Math.sin(i),c=Math.cos(r),u=Math.sin(r);if("XYZ"===e.order){const e=s*c,n=s*u,i=a*c,r=a*u;t[0]=o*c,t[4]=-o*u,t[8]=l,t[1]=n+i*l,t[5]=e-r*l,t[9]=-a*o,t[2]=r-e*l,t[6]=i+n*l,t[10]=s*o}else if("YXZ"===e.order){const e=o*c,n=o*u,i=l*c,r=l*u;t[0]=e+r*a,t[4]=i*a-n,t[8]=s*l,t[1]=s*u,t[5]=s*c,t[9]=-a,t[2]=n*a-i,t[6]=r+e*a,t[10]=s*o}else if("ZXY"===e.order){const e=o*c,n=o*u,i=l*c,r=l*u;t[0]=e-r*a,t[4]=-s*u,t[8]=i+n*a,t[1]=n+i*a,t[5]=s*c,t[9]=r-e*a,t[2]=-s*l,t[6]=a,t[10]=s*o}else if("ZYX"===e.order){const e=s*c,n=s*u,i=a*c,r=a*u;t[0]=o*c,t[4]=i*l-n,t[8]=e*l+r,t[1]=o*u,t[5]=r*l+e,t[9]=n*l-i,t[2]=-l,t[6]=a*o,t[10]=s*o}else if("YZX"===e.order){const e=s*o,n=s*l,i=a*o,r=a*l;t[0]=o*c,t[4]=r-e*u,t[8]=i*u+n,t[1]=u,t[5]=s*c,t[9]=-a*c,t[2]=-l*c,t[6]=n*u+i,t[10]=e-r*u}else if("XZY"===e.order){const e=s*o,n=s*l,i=a*o,r=a*l;t[0]=o*c,t[4]=-u,t[8]=l*c,t[1]=e*u+r,t[5]=s*c,t[9]=n*u-i,t[2]=i*u-n,t[6]=a*c,t[10]=r*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(pf,e,ff)}lookAt(e,t,n){const i=this.elements;return vf.subVectors(e,t),0===vf.lengthSq()&&(vf.z=1),vf.normalize(),mf.crossVectors(n,vf),0===mf.lengthSq()&&(1===Math.abs(n.z)?vf.x+=1e-4:vf.z+=1e-4,vf.normalize(),mf.crossVectors(n,vf)),mf.normalize(),gf.crossVectors(vf,mf),i[0]=mf.x,i[4]=gf.x,i[8]=vf.x,i[1]=mf.y,i[5]=gf.y,i[9]=vf.y,i[2]=mf.z,i[6]=gf.z,i[10]=vf.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,s=n[0],a=n[4],o=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],v=n[3],y=n[7],_=n[11],w=n[15],x=i[0],b=i[4],S=i[8],N=i[12],M=i[1],T=i[5],A=i[9],E=i[13],C=i[2],I=i[6],R=i[10],P=i[14],D=i[3],k=i[7],L=i[11],O=i[15];return r[0]=s*x+a*M+o*C+l*D,r[4]=s*b+a*T+o*I+l*k,r[8]=s*S+a*A+o*R+l*L,r[12]=s*N+a*E+o*P+l*O,r[1]=c*x+u*M+h*C+d*D,r[5]=c*b+u*T+h*I+d*k,r[9]=c*S+u*A+h*R+d*L,r[13]=c*N+u*E+h*P+d*O,r[2]=p*x+f*M+m*C+g*D,r[6]=p*b+f*T+m*I+g*k,r[10]=p*S+f*A+m*R+g*L,r[14]=p*N+f*E+m*P+g*O,r[3]=v*x+y*M+_*C+w*D,r[7]=v*b+y*T+_*I+w*k,r[11]=v*S+y*A+_*R+w*L,r[15]=v*N+y*E+_*P+w*O,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],s=e[1],a=e[5],o=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+r*o*u-i*l*u-r*a*h+n*l*h+i*a*d-n*o*d)+e[7]*(+t*o*d-t*l*h+r*s*h-i*s*d+i*l*c-r*o*c)+e[11]*(+t*l*u-t*a*d-r*s*u+n*s*d+r*a*c-n*l*c)+e[15]*(-i*a*c-t*o*u+t*a*h+i*s*u-n*s*h+n*o*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],f=e[13],m=e[14],g=e[15],v=u*m*l-f*h*l+f*o*d-a*m*d-u*o*g+a*h*g,y=p*h*l-c*m*l-p*o*d+s*m*d+c*o*g-s*h*g,_=c*f*l-p*u*l+p*a*d-s*f*d-c*a*g+s*u*g,w=p*u*o-c*f*o-p*a*h+s*f*h+c*a*m-s*u*m,x=t*v+n*y+i*_+r*w;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const b=1/x;return e[0]=v*b,e[1]=(f*h*r-u*m*r-f*i*d+n*m*d+u*i*g-n*h*g)*b,e[2]=(a*m*r-f*o*r+f*i*l-n*m*l-a*i*g+n*o*g)*b,e[3]=(u*o*r-a*h*r-u*i*l+n*h*l+a*i*d-n*o*d)*b,e[4]=y*b,e[5]=(c*m*r-p*h*r+p*i*d-t*m*d-c*i*g+t*h*g)*b,e[6]=(p*o*r-s*m*r-p*i*l+t*m*l+s*i*g-t*o*g)*b,e[7]=(s*h*r-c*o*r+c*i*l-t*h*l-s*i*d+t*o*d)*b,e[8]=_*b,e[9]=(p*u*r-c*f*r-p*n*d+t*f*d+c*n*g-t*u*g)*b,e[10]=(s*f*r-p*a*r+p*n*l-t*f*l-s*n*g+t*a*g)*b,e[11]=(c*a*r-s*u*r-c*n*l+t*u*l+s*n*d-t*a*d)*b,e[12]=w*b,e[13]=(c*f*i-p*u*i+p*n*h-t*f*h-c*n*m+t*u*m)*b,e[14]=(p*a*i-s*f*i-p*n*o+t*f*o+s*n*m-t*a*m)*b,e[15]=(s*u*i-c*a*i+c*n*o-t*u*o-s*n*h+t*a*h)*b,this}scale(e){const t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),r=1-n,s=e.x,a=e.y,o=e.z,l=r*s,c=r*a;return this.set(l*s+n,l*a-i*o,l*o+i*a,0,l*a+i*o,c*a+n,c*o-i*s,0,l*o-i*a,c*o+i*s,r*o*o+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,r,s){return this.set(1,n,r,0,e,1,s,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,r=t._x,s=t._y,a=t._z,o=t._w,l=r+r,c=s+s,u=a+a,h=r*l,d=r*c,p=r*u,f=s*c,m=s*u,g=a*u,v=o*l,y=o*c,_=o*u,w=n.x,x=n.y,b=n.z;return i[0]=(1-(f+g))*w,i[1]=(d+_)*w,i[2]=(p-y)*w,i[3]=0,i[4]=(d-_)*x,i[5]=(1-(h+g))*x,i[6]=(m+v)*x,i[7]=0,i[8]=(p+y)*b,i[9]=(m-v)*b,i[10]=(1-(h+f))*b,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let r=hf.set(i[0],i[1],i[2]).length();const s=hf.set(i[4],i[5],i[6]).length(),a=hf.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),e.x=i[12],e.y=i[13],e.z=i[14],df.copy(this);const o=1/r,l=1/s,c=1/a;return df.elements[0]*=o,df.elements[1]*=o,df.elements[2]*=o,df.elements[4]*=l,df.elements[5]*=l,df.elements[6]*=l,df.elements[8]*=c,df.elements[9]*=c,df.elements[10]*=c,t.setFromRotationMatrix(df),n.x=r,n.y=s,n.z=a,this}makePerspective(e,t,n,i,r,s){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Xd;const o=this.elements,l=2*r/(t-e),c=2*r/(n-i),u=(t+e)/(t-e),h=(n+i)/(n-i);let d,p;if(a===Xd)d=-(s+r)/(s-r),p=-2*s*r/(s-r);else{if(a!==Kd)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);d=-s/(s-r),p=-s*r/(s-r)}return o[0]=l,o[4]=0,o[8]=u,o[12]=0,o[1]=0,o[5]=c,o[9]=h,o[13]=0,o[2]=0,o[6]=0,o[10]=d,o[14]=p,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,t,n,i,r,s){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Xd;const o=this.elements,l=1/(t-e),c=1/(n-i),u=1/(s-r),h=(t+e)*l,d=(n+i)*c;let p,f;if(a===Xd)p=(s+r)*u,f=-2*u;else{if(a!==Kd)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);p=r*u,f=-1*u}return o[0]=2*l,o[4]=0,o[8]=0,o[12]=-h,o[1]=0,o[5]=2*c,o[9]=0,o[13]=-d,o[2]=0,o[6]=0,o[10]=f,o[14]=-p,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const hf=new Dp,df=new uf,pf=new Dp(0,0,0),ff=new Dp(1,1,1),mf=new Dp,gf=new Dp,vf=new Dp,yf=new uf,_f=new Pp;class wf{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:wf.DEFAULT_ORDER;this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=e.elements,r=i[0],s=i[4],a=i[8],o=i[1],l=i[5],c=i[9],u=i[2],h=i[6],d=i[10];switch(t){case"XYZ":this._y=Math.asin(np(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-np(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-u,r),this._z=0);break;case"ZXY":this._x=Math.asin(np(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,r));break;case"ZYX":this._y=Math.asin(-np(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(o,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(np(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,r)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-np(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return yf.makeRotationFromQuaternion(e),this.setFromRotationMatrix(yf,t,n)}setFromVector3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}reorder(e){return _f.setFromEuler(this),this.setFromQuaternion(_f,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}wf.DEFAULT_ORDER="XYZ";class xf{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return 0!==(this.mask&e.mask)}isEnabled(e){return 0!==(this.mask&1<<e)}}let bf=0;const Sf=new Dp,Nf=new Pp,Mf=new uf,Tf=new Dp,Af=new Dp,Ef=new Dp,Cf=new Pp,If=new Dp(1,0,0),Rf=new Dp(0,1,0),Pf=new Dp(0,0,1),Df={type:"added"},kf={type:"removed"},Lf={type:"childadded",child:null},Of={type:"childremoved",child:null};class Bf extends Jd{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:bf++}),this.uuid=tp(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Bf.DEFAULT_UP.clone();const e=new Dp,t=new wf,n=new Pp,i=new Dp(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new uf},normalMatrix:{value:new cp}}),this.matrix=new uf,this.matrixWorld=new uf,this.matrixAutoUpdate=Bf.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Bf.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new xf,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Nf.setFromAxisAngle(e,t),this.quaternion.multiply(Nf),this}rotateOnWorldAxis(e,t){return Nf.setFromAxisAngle(e,t),this.quaternion.premultiply(Nf),this}rotateX(e){return this.rotateOnAxis(If,e)}rotateY(e){return this.rotateOnAxis(Rf,e)}rotateZ(e){return this.rotateOnAxis(Pf,e)}translateOnAxis(e,t){return Sf.copy(e).applyQuaternion(this.quaternion),this.position.add(Sf.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(If,e)}translateY(e){return this.translateOnAxis(Rf,e)}translateZ(e){return this.translateOnAxis(Pf,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Mf.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Tf.copy(e):Tf.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Af.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Mf.lookAt(Af,Tf,this.up):Mf.lookAt(Tf,Af,this.up),this.quaternion.setFromRotationMatrix(Mf),i&&(Mf.extractRotation(i.matrixWorld),Nf.setFromRotationMatrix(Mf),this.quaternion.premultiply(Nf.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Df),Lf.child=e,this.dispatchEvent(Lf),Lf.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(kf),Of.child=e,this.dispatchEvent(Of),Of.child=null),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Mf.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Mf.multiply(e.parent.matrixWorld)),e.applyMatrix4(Mf),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Df),Lf.child=e,this.dispatchEvent(Lf),Lf.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}}getObjectsByProperty(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this[e]===t&&n.push(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Af,e,Ef),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Af,Cf,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++){const i=t[n];!0!==i.matrixWorldAutoUpdate&&!0!==e||i.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++){const n=e[t];!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};function r(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map((e=>({boxInitialized:e.boxInitialized,boxMin:e.box.min.toArray(),boxMax:e.box.max.toArray(),sphereInitialized:e.sphereInitialized,sphereRadius:e.sphere.radius,sphereCenter:e.sphere.center.toArray()}))),i.maxGeometryCount=this._maxGeometryCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),null!==this.boundingSphere&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),null!==this.boundingBox&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,i=n.length;t<i;t++){const i=n[t];r(e.shapes,i)}else r(e.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,i=this.material.length;n<i;n++)t.push(r(e.materials,this.material[n]));i.material=t}else i.material=r(e.materials,this.material);if(this.children.length>0){i.children=[];for(let t=0;t<this.children.length;t++)i.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];i.animations.push(r(e.animations,n))}}if(t){const t=s(e.geometries),i=s(e.materials),r=s(e.textures),a=s(e.images),o=s(e.shapes),l=s(e.skeletons),c=s(e.animations),u=s(e.nodes);t.length>0&&(n.geometries=t),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),a.length>0&&(n.images=a),o.length>0&&(n.shapes=o),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),u.length>0&&(n.nodes=u)}return n.object=i,n;function s(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++){const t=e.children[n];this.add(t.clone())}return this}}Bf.DEFAULT_UP=new Dp(0,1,0),Bf.DEFAULT_MATRIX_AUTO_UPDATE=!0,Bf.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Uf=new Dp,zf=new Dp,Vf=new Dp,Ff=new Dp,jf=new Dp,Hf=new Dp,Gf=new Dp,Wf=new Dp,Yf=new Dp,qf=new Dp;class Xf{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dp,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Dp,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Dp;this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),Uf.subVectors(e,t),i.cross(Uf);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(e,t,n,i,r){Uf.subVectors(i,t),zf.subVectors(n,t),Vf.subVectors(e,t);const s=Uf.dot(Uf),a=Uf.dot(zf),o=Uf.dot(Vf),l=zf.dot(zf),c=zf.dot(Vf),u=s*l-a*a;if(0===u)return r.set(0,0,0),null;const h=1/u,d=(l*o-a*c)*h,p=(s*c-a*o)*h;return r.set(1-d-p,p,d)}static containsPoint(e,t,n,i){return null!==this.getBarycoord(e,t,n,i,Ff)&&(Ff.x>=0&&Ff.y>=0&&Ff.x+Ff.y<=1)}static getInterpolation(e,t,n,i,r,s,a,o){return null===this.getBarycoord(e,t,n,i,Ff)?(o.x=0,o.y=0,"z"in o&&(o.z=0),"w"in o&&(o.w=0),null):(o.setScalar(0),o.addScaledVector(r,Ff.x),o.addScaledVector(s,Ff.y),o.addScaledVector(a,Ff.z),o)}static isFrontFacing(e,t,n,i){return Uf.subVectors(n,t),zf.subVectors(e,t),Uf.cross(zf).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Uf.subVectors(this.c,this.b),zf.subVectors(this.a,this.b),.5*Uf.cross(zf).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Xf.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Xf.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,i,r){return Xf.getInterpolation(e,this.a,this.b,this.c,t,n,i,r)}containsPoint(e){return Xf.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Xf.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,r=this.c;let s,a;jf.subVectors(i,n),Hf.subVectors(r,n),Wf.subVectors(e,n);const o=jf.dot(Wf),l=Hf.dot(Wf);if(o<=0&&l<=0)return t.copy(n);Yf.subVectors(e,i);const c=jf.dot(Yf),u=Hf.dot(Yf);if(c>=0&&u<=c)return t.copy(i);const h=o*u-c*l;if(h<=0&&o>=0&&c<=0)return s=o/(o-c),t.copy(n).addScaledVector(jf,s);qf.subVectors(e,r);const d=jf.dot(qf),p=Hf.dot(qf);if(p>=0&&d<=p)return t.copy(r);const f=d*l-o*p;if(f<=0&&l>=0&&p<=0)return a=l/(l-p),t.copy(n).addScaledVector(Hf,a);const m=c*p-d*u;if(m<=0&&u-c>=0&&d-p>=0)return Gf.subVectors(r,i),a=(u-c)/(u-c+(d-p)),t.copy(i).addScaledVector(Gf,a);const g=1/(m+f+h);return s=f*g,a=h*g,t.copy(n).addScaledVector(jf,s).addScaledVector(Hf,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Kf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Jf={h:0,s:0,l:0},$f={h:0,s:0,l:0};function Qf(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}class Zf{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(void 0===t&&void 0===n){const t=e;t&&t.isColor?this.copy(t):"number"===typeof t?this.setHex(t):"string"===typeof t&&this.setStyle(t)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Bd;return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,_p.toWorkingColorSpace(this,t),this}setRGB(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:_p.workingColorSpace;return this.r=e,this.g=t,this.b=n,_p.toWorkingColorSpace(this,i),this}setHSL(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:_p.workingColorSpace;if(e=ip(e,1),t=np(t,0,1),n=np(n,0,1),0===t)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,r=2*n-i;this.r=Qf(r,i,e+1/3),this.g=Qf(r,i,e),this.b=Qf(r,i,e-1/3)}return _p.toWorkingColorSpace(this,i),this}setStyle(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Bd;function i(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const s=t[1],a=t[2];switch(s){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,n);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,n);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=t[1],r=i.length;if(3===r)return this.setRGB(parseInt(i.charAt(0),16)/15,parseInt(i.charAt(1),16)/15,parseInt(i.charAt(2),16)/15,n);if(6===r)return this.setHex(parseInt(i,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Bd;const n=Kf[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=wp(e.r),this.g=wp(e.g),this.b=wp(e.b),this}copyLinearToSRGB(e){return this.r=xp(e.r),this.g=xp(e.g),this.b=xp(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bd;return _p.fromWorkingColorSpace(em.copy(this),e),65536*Math.round(np(255*em.r,0,255))+256*Math.round(np(255*em.g,0,255))+Math.round(np(255*em.b,0,255))}getHexString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bd;return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_p.workingColorSpace;_p.fromWorkingColorSpace(em.copy(this),t);const n=em.r,i=em.g,r=em.b,s=Math.max(n,i,r),a=Math.min(n,i,r);let o,l;const c=(a+s)/2;if(a===s)o=0,l=0;else{const e=s-a;switch(l=c<=.5?e/(s+a):e/(2-s-a),s){case n:o=(i-r)/e+(i<r?6:0);break;case i:o=(r-n)/e+2;break;case r:o=(n-i)/e+4}o/=6}return e.h=o,e.s=l,e.l=c,e}getRGB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_p.workingColorSpace;return _p.fromWorkingColorSpace(em.copy(this),t),e.r=em.r,e.g=em.g,e.b=em.b,e}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bd;_p.fromWorkingColorSpace(em.copy(this),e);const t=em.r,n=em.g,i=em.b;return e!==Bd?"color(".concat(e," ").concat(t.toFixed(3)," ").concat(n.toFixed(3)," ").concat(i.toFixed(3),")"):"rgb(".concat(Math.round(255*t),",").concat(Math.round(255*n),",").concat(Math.round(255*i),")")}offsetHSL(e,t,n){return this.getHSL(Jf),this.setHSL(Jf.h+e,Jf.s+t,Jf.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Jf),e.getHSL($f);const n=rp(Jf.h,$f.h,t),i=rp(Jf.s,$f.s,t),r=rp(Jf.l,$f.l,t);return this.setHSL(n,i,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,i=this.b,r=e.elements;return this.r=r[0]*t+r[3]*n+r[6]*i,this.g=r[1]*t+r[4]*n+r[7]*i,this.b=r[2]*t+r[5]*n+r[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const em=new Zf;Zf.NAMES=Kf;let tm=0;class nm extends Jd{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:tm++}),this.uuid=tp(),this.name="",this.type="Material",this.blending=1,this.side=ad,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=ld,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Zf(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Wd,this.stencilZFail=Wd,this.stencilZPass=Wd,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!==e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: parameter '".concat(t,"' has value of undefined."));continue}const i=this[t];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n:console.warn("THREE.Material: '".concat(t,"' is not a property of THREE.").concat(this.type,"."))}}toJSON(e){const t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function i(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapRotation&&(n.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),this.side!==ad&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),204!==this.blendSrc&&(n.blendSrc=this.blendSrc),205!==this.blendDst&&(n.blendDst=this.blendDst),this.blendEquation!==ld&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Wd&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Wd&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Wd&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const t=i(e.textures),r=i(e.images);t.length>0&&(n.textures=t),r.length>0&&(n.images=r)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let i=0;i!==e;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class im extends nm{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Zf(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new wf,this.combine=cd,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const rm=new Dp,sm=new lp;class am{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=Yd,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Nd,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return fp("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)sm.fromBufferAttribute(this,t),sm.applyMatrix3(e),this.setXY(t,sm.x,sm.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)rm.fromBufferAttribute(this,t),rm.applyMatrix3(e),this.setXYZ(t,rm.x,rm.y,rm.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)rm.fromBufferAttribute(this,t),rm.applyMatrix4(e),this.setXYZ(t,rm.x,rm.y,rm.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)rm.fromBufferAttribute(this,t),rm.applyNormalMatrix(e),this.setXYZ(t,rm.x,rm.y,rm.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)rm.fromBufferAttribute(this,t),rm.transformDirection(e),this.setXYZ(t,rm.x,rm.y,rm.z);return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=sp(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=ap(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=sp(t,this.array)),t}setX(e,t){return this.normalized&&(t=ap(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=sp(t,this.array)),t}setY(e,t){return this.normalized&&(t=ap(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=sp(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ap(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=sp(t,this.array)),t}setW(e,t){return this.normalized&&(t=ap(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=ap(t,this.array),n=ap(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=ap(t,this.array),n=ap(n,this.array),i=ap(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.normalized&&(t=ap(t,this.array),n=ap(n,this.array),i=ap(i,this.array),r=ap(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Yd&&(e.usage=this.usage),e}}class om extends am{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class lm extends am{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class cm extends am{constructor(e,t,n){super(new Float32Array(e),t,n)}}let um=0;const hm=new uf,dm=new Bf,pm=new Dp,fm=new Op,mm=new Op,gm=new Dp;class vm extends Jd{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:um++}),this.uuid=tp(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(hp(e)?lm:om)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new cp).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return hm.makeRotationFromQuaternion(e),this.applyMatrix4(hm),this}rotateX(e){return hm.makeRotationX(e),this.applyMatrix4(hm),this}rotateY(e){return hm.makeRotationY(e),this.applyMatrix4(hm),this}rotateZ(e){return hm.makeRotationZ(e),this.applyMatrix4(hm),this}translate(e,t,n){return hm.makeTranslation(e,t,n),this.applyMatrix4(hm),this}scale(e,t,n){return hm.makeScale(e,t,n),this.applyMatrix4(hm),this}lookAt(e){return dm.lookAt(e),dm.updateMatrix(),this.applyMatrix4(dm.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(pm).negate(),this.translate(pm.x,pm.y,pm.z),this}setFromPoints(e){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new cm(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Op);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new Dp(-1/0,-1/0,-1/0),new Dp(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){const e=t[n];fm.setFromBufferAttribute(e),this.morphTargetsRelative?(gm.addVectors(this.boundingBox.min,fm.min),this.boundingBox.expandByPoint(gm),gm.addVectors(this.boundingBox.max,fm.max),this.boundingBox.expandByPoint(gm)):(this.boundingBox.expandByPoint(fm.min),this.boundingBox.expandByPoint(fm.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new ef);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new Dp,1/0);if(e){const n=this.boundingSphere.center;if(fm.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){const n=t[e];mm.setFromBufferAttribute(n),this.morphTargetsRelative?(gm.addVectors(fm.min,mm.min),fm.expandByPoint(gm),gm.addVectors(fm.max,mm.max),fm.expandByPoint(gm)):(fm.expandByPoint(mm.min),fm.expandByPoint(mm.max))}fm.getCenter(n);let i=0;for(let t=0,r=e.count;t<r;t++)gm.fromBufferAttribute(e,t),i=Math.max(i,n.distanceToSquared(gm));if(t)for(let r=0,s=t.length;r<s;r++){const s=t[r],a=this.morphTargetsRelative;for(let t=0,r=s.count;t<r;t++)gm.fromBufferAttribute(s,t),a&&(pm.fromBufferAttribute(e,t),gm.add(pm)),i=Math.max(i,n.distanceToSquared(gm))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.position,i=t.normal,r=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new am(new Float32Array(4*n.count),4));const s=this.getAttribute("tangent"),a=[],o=[];for(let S=0;S<n.count;S++)a[S]=new Dp,o[S]=new Dp;const l=new Dp,c=new Dp,u=new Dp,h=new lp,d=new lp,p=new lp,f=new Dp,m=new Dp;function g(e,t,i){l.fromBufferAttribute(n,e),c.fromBufferAttribute(n,t),u.fromBufferAttribute(n,i),h.fromBufferAttribute(r,e),d.fromBufferAttribute(r,t),p.fromBufferAttribute(r,i),c.sub(l),u.sub(l),d.sub(h),p.sub(h);const s=1/(d.x*p.y-p.x*d.y);isFinite(s)&&(f.copy(c).multiplyScalar(p.y).addScaledVector(u,-d.y).multiplyScalar(s),m.copy(u).multiplyScalar(d.x).addScaledVector(c,-p.x).multiplyScalar(s),a[e].add(f),a[t].add(f),a[i].add(f),o[e].add(m),o[t].add(m),o[i].add(m))}let v=this.groups;0===v.length&&(v=[{start:0,count:e.count}]);for(let S=0,N=v.length;S<N;++S){const t=v[S],n=t.start;for(let i=n,r=n+t.count;i<r;i+=3)g(e.getX(i+0),e.getX(i+1),e.getX(i+2))}const y=new Dp,_=new Dp,w=new Dp,x=new Dp;function b(e){w.fromBufferAttribute(i,e),x.copy(w);const t=a[e];y.copy(t),y.sub(w.multiplyScalar(w.dot(t))).normalize(),_.crossVectors(x,t);const n=_.dot(o[e])<0?-1:1;s.setXYZW(e,y.x,y.y,y.z,n)}for(let S=0,N=v.length;S<N;++S){const t=v[S],n=t.start;for(let i=n,r=n+t.count;i<r;i+=3)b(e.getX(i+0)),b(e.getX(i+1)),b(e.getX(i+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new am(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const i=new Dp,r=new Dp,s=new Dp,a=new Dp,o=new Dp,l=new Dp,c=new Dp,u=new Dp;if(e)for(let h=0,d=e.count;h<d;h+=3){const d=e.getX(h+0),p=e.getX(h+1),f=e.getX(h+2);i.fromBufferAttribute(t,d),r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,f),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),a.fromBufferAttribute(n,d),o.fromBufferAttribute(n,p),l.fromBufferAttribute(n,f),a.add(c),o.add(c),l.add(c),n.setXYZ(d,a.x,a.y,a.z),n.setXYZ(p,o.x,o.y,o.z),n.setXYZ(f,l.x,l.y,l.z)}else for(let e=0,h=t.count;e<h;e+=3)i.fromBufferAttribute(t,e+0),r.fromBufferAttribute(t,e+1),s.fromBufferAttribute(t,e+2),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)gm.fromBufferAttribute(e,t),gm.normalize(),e.setXYZ(t,gm.x,gm.y,gm.z)}toNonIndexed(){function e(e,t){const n=e.array,i=e.itemSize,r=e.normalized,s=new n.constructor(t.length*i);let a=0,o=0;for(let l=0,c=t.length;l<c;l++){a=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*i;for(let e=0;e<i;e++)s[o++]=n[a++]}return new am(s,i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new vm,n=this.index.array,i=this.attributes;for(const a in i){const r=e(i[a],n);t.setAttribute(a,r)}const r=this.morphAttributes;for(const a in r){const i=[],s=r[a];for(let t=0,r=s.length;t<r;t++){const r=e(s[t],n);i.push(r)}t.morphAttributes[a]=i}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let a=0,o=s.length;a<o;a++){const e=s[a];t.addGroup(e.start,e.count,e.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const o in n){const t=n[o];e.data.attributes[o]=t.toJSON(e.data)}const i={};let r=!1;for(const o in this.morphAttributes){const t=this.morphAttributes[o],n=[];for(let i=0,r=t.length;i<r;i++){const r=t[i];n.push(r.toJSON(e.data))}n.length>0&&(i[o]=n,r=!0)}r&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const i=e.attributes;for(const l in i){const e=i[l];this.setAttribute(l,e.clone(t))}const r=e.morphAttributes;for(const l in r){const e=[],n=r[l];for(let i=0,r=n.length;i<r;i++)e.push(n[i].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let l=0,c=s.length;l<c;l++){const e=s[l];this.addGroup(e.start,e.count,e.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const o=e.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const ym=new uf,_m=new cf,wm=new ef,xm=new Dp,bm=new Dp,Sm=new Dp,Nm=new Dp,Mm=new Dp,Tm=new Dp,Am=new lp,Em=new lp,Cm=new lp,Im=new Dp,Rm=new Dp,Pm=new Dp,Dm=new Dp,km=new Dp;class Lm extends Bf{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new vm,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new im;super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){const n=this.geometry,i=n.attributes.position,r=n.morphAttributes.position,s=n.morphTargetsRelative;t.fromBufferAttribute(i,e);const a=this.morphTargetInfluences;if(r&&a){Tm.set(0,0,0);for(let n=0,i=r.length;n<i;n++){const i=a[n],o=r[n];0!==i&&(Mm.fromBufferAttribute(o,e),s?Tm.addScaledVector(Mm,i):Tm.addScaledVector(Mm.sub(t),i))}t.add(Tm)}return t}raycast(e,t){const n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0!==i){if(null===n.boundingSphere&&n.computeBoundingSphere(),wm.copy(n.boundingSphere),wm.applyMatrix4(r),_m.copy(e.ray).recast(e.near),!1===wm.containsPoint(_m.origin)){if(null===_m.intersectSphere(wm,xm))return;if(_m.origin.distanceToSquared(xm)>(e.far-e.near)**2)return}ym.copy(r).invert(),_m.copy(e.ray).applyMatrix4(ym),null!==n.boundingBox&&!1===_m.intersectsBox(n.boundingBox)||this._computeIntersections(e,t,_m)}}_computeIntersections(e,t,n){let i;const r=this.geometry,s=this.material,a=r.index,o=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv1,u=r.attributes.normal,h=r.groups,d=r.drawRange;if(null!==a)if(Array.isArray(s))for(let p=0,f=h.length;p<f;p++){const r=h[p],o=s[r.materialIndex];for(let s=Math.max(r.start,d.start),h=Math.min(a.count,Math.min(r.start+r.count,d.start+d.count));s<h;s+=3){i=Om(this,o,e,n,l,c,u,a.getX(s),a.getX(s+1),a.getX(s+2)),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,t.push(i))}}else{for(let r=Math.max(0,d.start),o=Math.min(a.count,d.start+d.count);r<o;r+=3){i=Om(this,s,e,n,l,c,u,a.getX(r),a.getX(r+1),a.getX(r+2)),i&&(i.faceIndex=Math.floor(r/3),t.push(i))}}else if(void 0!==o)if(Array.isArray(s))for(let p=0,f=h.length;p<f;p++){const r=h[p],a=s[r.materialIndex];for(let s=Math.max(r.start,d.start),h=Math.min(o.count,Math.min(r.start+r.count,d.start+d.count));s<h;s+=3){i=Om(this,a,e,n,l,c,u,s,s+1,s+2),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,t.push(i))}}else{for(let r=Math.max(0,d.start),a=Math.min(o.count,d.start+d.count);r<a;r+=3){i=Om(this,s,e,n,l,c,u,r,r+1,r+2),i&&(i.faceIndex=Math.floor(r/3),t.push(i))}}}}function Om(e,t,n,i,r,s,a,o,l,c){e.getVertexPosition(o,bm),e.getVertexPosition(l,Sm),e.getVertexPosition(c,Nm);const u=function(e,t,n,i,r,s,a,o){let l;if(l=t.side===od?i.intersectTriangle(a,s,r,!0,o):i.intersectTriangle(r,s,a,t.side===ad,o),null===l)return null;km.copy(o),km.applyMatrix4(e.matrixWorld);const c=n.ray.origin.distanceTo(km);return c<n.near||c>n.far?null:{distance:c,point:km.clone(),object:e}}(e,t,n,i,bm,Sm,Nm,Dm);if(u){r&&(Am.fromBufferAttribute(r,o),Em.fromBufferAttribute(r,l),Cm.fromBufferAttribute(r,c),u.uv=Xf.getInterpolation(Dm,bm,Sm,Nm,Am,Em,Cm,new lp)),s&&(Am.fromBufferAttribute(s,o),Em.fromBufferAttribute(s,l),Cm.fromBufferAttribute(s,c),u.uv1=Xf.getInterpolation(Dm,bm,Sm,Nm,Am,Em,Cm,new lp)),a&&(Im.fromBufferAttribute(a,o),Rm.fromBufferAttribute(a,l),Pm.fromBufferAttribute(a,c),u.normal=Xf.getInterpolation(Dm,bm,Sm,Nm,Im,Rm,Pm,new Dp),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const e={a:o,b:l,c:c,normal:new Dp,materialIndex:0};Xf.getNormal(bm,Sm,Nm,e.normal),u.face=e}return u}function Bm(e){const t={};for(const n in e){t[n]={};for(const i in e[n]){const r=e[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][i]=null):t[n][i]=r.clone():Array.isArray(r)?t[n][i]=r.slice():t[n][i]=r}}return t}function Um(e){const t={};for(let n=0;n<e.length;n++){const i=Bm(e[n]);for(const e in i)t[e]=i[e]}return t}class zm extends nm{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Bm(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const n=this.uniforms[i].value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const i in this.extensions)!0===this.extensions[i]&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Vm extends Bf{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new uf,this.projectionMatrix=new uf,this.projectionMatrixInverse=new uf,this.coordinateSystem=Xd}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const Fm=new Dp,jm=new lp,Hm=new lp;class Gm extends Vm{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*ep*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Zd*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*ep*Math.atan(Math.tan(.5*Zd*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Fm.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Fm.x,Fm.y).multiplyScalar(-e/Fm.z),Fm.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Fm.x,Fm.y).multiplyScalar(-e/Fm.z)}getViewSize(e,t){return this.getViewBounds(e,jm,Hm),t.subVectors(Hm,jm)}setViewOffset(e,t,n,i,r,s){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Zd*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i;const s=this.view;if(null!==this.view&&this.view.enabled){const e=s.fullWidth,a=s.fullHeight;r+=s.offsetX*i/e,t-=s.offsetY*n/a,i*=s.width/e,n*=s.height/a}const a=this.filmOffset;0!==a&&(r+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Wm=new Dp,Ym=new Dp,qm=new cp;class Xm{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dp(1,0,0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=Wm.subVectors(n,t).cross(Ym.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(Wm),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:t.copy(e.start).addScaledVector(n,r)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||qm.getNormalMatrix(e),i=this.coplanarPoint(Wm).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Km=new ef,Jm=new Dp;class $m{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Xm,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Xm,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Xm,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Xm,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Xm,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new Xm;this.planes=[e,t,n,i,r,s]}set(e,t,n,i,r,s){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(s),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Xd;const n=this.planes,i=e.elements,r=i[0],s=i[1],a=i[2],o=i[3],l=i[4],c=i[5],u=i[6],h=i[7],d=i[8],p=i[9],f=i[10],m=i[11],g=i[12],v=i[13],y=i[14],_=i[15];if(n[0].setComponents(o-r,h-l,m-d,_-g).normalize(),n[1].setComponents(o+r,h+l,m+d,_+g).normalize(),n[2].setComponents(o+s,h+c,m+p,_+v).normalize(),n[3].setComponents(o-s,h-c,m-p,_-v).normalize(),n[4].setComponents(o-a,h-u,m-f,_-y).normalize(),t===Xd)n[5].setComponents(o+a,h+u,m+f,_+y).normalize();else{if(t!==Kd)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);n[5].setComponents(a,u,f,y).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),Km.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),Km.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Km)}intersectsSprite(e){return Km.center.set(0,0,0),Km.radius=.7071067811865476,Km.applyMatrix4(e.matrixWorld),this.intersectsSphere(Km)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let r=0;r<6;r++){if(t[r].distanceToPoint(n)<i)return!1}return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(Jm.x=i.normal.x>0?e.max.x:e.min.x,Jm.y=i.normal.y>0?e.max.y:e.min.y,Jm.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(Jm)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}const Qm={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\tattribute float batchId;\n\tuniform highp sampler2D batchingTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( batchId );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[MORPHTARGETS_COUNT];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t#endif\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\t#ifndef USE_INSTANCING_MORPH\n\t\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\t#endif\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tfloat startCompression = 0.8 - 0.04;\n\tfloat desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min(color.r, min(color.g, color.b));\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max(color.r, max(color.g, color.b));\n\tif (peak < startCompression) return color;\n\tfloat d = 1. - startCompression;\n\tfloat newPeak = 1. - d * d / (peak + d - startCompression);\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / (desaturation * (peak - newPeak) + 1.);\n\treturn mix(color, newPeak * vec3(1, 1, 1), g);\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},Zm={common:{diffuse:{value:new Zf(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new cp},alphaMap:{value:null},alphaMapTransform:{value:new cp},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new cp}},envmap:{envMap:{value:null},envMapRotation:{value:new cp},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new cp}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new cp}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new cp},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new cp},normalScale:{value:new lp(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new cp},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new cp}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new cp}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new cp}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Zf(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Zf(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new cp},alphaTest:{value:0},uvTransform:{value:new cp}},sprite:{diffuse:{value:new Zf(16777215)},opacity:{value:1},center:{value:new lp(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new cp},alphaMap:{value:null},alphaMapTransform:{value:new cp},alphaTest:{value:0}}},eg={basic:{uniforms:Um([Zm.common,Zm.specularmap,Zm.envmap,Zm.aomap,Zm.lightmap,Zm.fog]),vertexShader:Qm.meshbasic_vert,fragmentShader:Qm.meshbasic_frag},lambert:{uniforms:Um([Zm.common,Zm.specularmap,Zm.envmap,Zm.aomap,Zm.lightmap,Zm.emissivemap,Zm.bumpmap,Zm.normalmap,Zm.displacementmap,Zm.fog,Zm.lights,{emissive:{value:new Zf(0)}}]),vertexShader:Qm.meshlambert_vert,fragmentShader:Qm.meshlambert_frag},phong:{uniforms:Um([Zm.common,Zm.specularmap,Zm.envmap,Zm.aomap,Zm.lightmap,Zm.emissivemap,Zm.bumpmap,Zm.normalmap,Zm.displacementmap,Zm.fog,Zm.lights,{emissive:{value:new Zf(0)},specular:{value:new Zf(1118481)},shininess:{value:30}}]),vertexShader:Qm.meshphong_vert,fragmentShader:Qm.meshphong_frag},standard:{uniforms:Um([Zm.common,Zm.envmap,Zm.aomap,Zm.lightmap,Zm.emissivemap,Zm.bumpmap,Zm.normalmap,Zm.displacementmap,Zm.roughnessmap,Zm.metalnessmap,Zm.fog,Zm.lights,{emissive:{value:new Zf(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Qm.meshphysical_vert,fragmentShader:Qm.meshphysical_frag},toon:{uniforms:Um([Zm.common,Zm.aomap,Zm.lightmap,Zm.emissivemap,Zm.bumpmap,Zm.normalmap,Zm.displacementmap,Zm.gradientmap,Zm.fog,Zm.lights,{emissive:{value:new Zf(0)}}]),vertexShader:Qm.meshtoon_vert,fragmentShader:Qm.meshtoon_frag},matcap:{uniforms:Um([Zm.common,Zm.bumpmap,Zm.normalmap,Zm.displacementmap,Zm.fog,{matcap:{value:null}}]),vertexShader:Qm.meshmatcap_vert,fragmentShader:Qm.meshmatcap_frag},points:{uniforms:Um([Zm.points,Zm.fog]),vertexShader:Qm.points_vert,fragmentShader:Qm.points_frag},dashed:{uniforms:Um([Zm.common,Zm.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Qm.linedashed_vert,fragmentShader:Qm.linedashed_frag},depth:{uniforms:Um([Zm.common,Zm.displacementmap]),vertexShader:Qm.depth_vert,fragmentShader:Qm.depth_frag},normal:{uniforms:Um([Zm.common,Zm.bumpmap,Zm.normalmap,Zm.displacementmap,{opacity:{value:1}}]),vertexShader:Qm.meshnormal_vert,fragmentShader:Qm.meshnormal_frag},sprite:{uniforms:Um([Zm.sprite,Zm.fog]),vertexShader:Qm.sprite_vert,fragmentShader:Qm.sprite_frag},background:{uniforms:{uvTransform:{value:new cp},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Qm.background_vert,fragmentShader:Qm.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new cp}},vertexShader:Qm.backgroundCube_vert,fragmentShader:Qm.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Qm.cube_vert,fragmentShader:Qm.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Qm.equirect_vert,fragmentShader:Qm.equirect_frag},distanceRGBA:{uniforms:Um([Zm.common,Zm.displacementmap,{referencePosition:{value:new Dp},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Qm.distanceRGBA_vert,fragmentShader:Qm.distanceRGBA_frag},shadow:{uniforms:Um([Zm.lights,Zm.fog,{color:{value:new Zf(0)},opacity:{value:1}}]),vertexShader:Qm.shadow_vert,fragmentShader:Qm.shadow_frag}};eg.physical={uniforms:Um([eg.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new cp},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new cp},clearcoatNormalScale:{value:new lp(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new cp},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new cp},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new cp},sheen:{value:0},sheenColor:{value:new Zf(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new cp},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new cp},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new cp},transmissionSamplerSize:{value:new lp},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new cp},attenuationDistance:{value:0},attenuationColor:{value:new Zf(0)},specularColor:{value:new Zf(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new cp},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new cp},anisotropyVector:{value:new lp},anisotropyMap:{value:null},anisotropyMapTransform:{value:new cp}}]),vertexShader:Qm.meshphysical_vert,fragmentShader:Qm.meshphysical_frag};class tg extends Vm{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,r,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-e,s=n+e,a=i+t,o=i-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=e*this.view.offsetX,s=r+e*this.view.width,a-=t*this.view.offsetY,o=a-t*this.view.height}this.projectionMatrix.makeOrthographic(r,s,a,o,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}Math.sqrt(5);class ng extends Ep{constructor(e,t,n,i,r,s,a,o,l,c){if((c=void 0!==c?c:Ed)!==Ed&&c!==Cd)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===Ed&&(n=Sd),void 0===n&&c===Cd&&(n=Td),super(null,i,r,s,a,o,c,n,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:_d,this.minFilter=void 0!==o?o:_d,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}const ig=new ng(1,1);ig.compareFunction=515;new Float32Array(16),new Float32Array(9),new Float32Array(4);new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);class rg extends nm{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class sg extends nm{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class ag{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Yd,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=tp()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return fp("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,r=this.stride;i<r;i++)this.array[e+i]=t.array[n+i];return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=tp()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=tp()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const og=new Dp;class lg{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)og.fromBufferAttribute(this,t),og.applyMatrix4(e),this.setXYZ(t,og.x,og.y,og.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)og.fromBufferAttribute(this,t),og.applyNormalMatrix(e),this.setXYZ(t,og.x,og.y,og.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)og.fromBufferAttribute(this,t),og.transformDirection(e),this.setXYZ(t,og.x,og.y,og.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=sp(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=ap(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=ap(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=ap(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=ap(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=ap(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=sp(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=sp(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=sp(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=sp(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=ap(t,this.array),n=ap(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=ap(t,this.array),n=ap(n,this.array),i=ap(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=ap(t,this.array),n=ap(n,this.array),i=ap(i,this.array),r=ap(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=r,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new am(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new lg(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class cg extends nm{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Zf(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}class ug extends am{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}class hg extends nm{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Zf(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}class dg extends nm{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Zf(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}class pg extends Ep{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=_d,this.minFilter=_d,this.generateMipmaps=!1,this.needsUpdate=!0}}class fg extends nm{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Zf(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class mg extends zm{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class gg extends nm{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Zf(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Zf(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new lp(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new wf,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class vg extends gg{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new lp(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return np(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Zf(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Zf(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Zf(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!==e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!==e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!==e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!==e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!==e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class yg extends nm{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Zf(16777215),this.specular=new Zf(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Zf(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new lp(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new wf,this.combine=cd,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class _g extends nm{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Zf(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Zf(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new lp(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class wg extends nm{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new lp(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class xg extends nm{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Zf(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Zf(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new lp(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new wf,this.combine=cd,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class bg extends nm{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Zf(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new lp(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Sg extends hg{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Ng(e,t,n){return!e||!n&&e.constructor===t?e:"number"===typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}function Mg(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}class Tg{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{let s;n:{i:if(!(e<i)){for(let s=n+2;;){if(void 0===i){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===s)break;if(r=i,i=t[++n],e<i)break t}s=t.length;break n}if(e>=r)break e;{const a=t[1];e<a&&(n=2,r=a);for(let s=n-2;;){if(void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(n===s)break;if(i=r,r=t[--n-1],e>=r)break t}s=n,n=0}}for(;n<s;){const i=n+s>>>1;e<t[i]?s=i:n=i+1}if(i=t[n],r=t[n-1],void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===i)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i;for(let s=0;s!==i;++s)t[s]=n[r+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Ag extends Tg{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Dd,endingEnd:Dd}}intervalChanged_(e,t,n){const i=this.parameterPositions;let r=e-2,s=e+1,a=i[r],o=i[s];if(void 0===a)switch(this.getSettings_().endingStart){case kd:r=e,a=2*t-n;break;case Ld:r=i.length-2,a=t+i[r]-i[r+1];break;default:r=e,a=n}if(void 0===o)switch(this.getSettings_().endingEnd){case kd:s=e,o=2*n-t;break;case Ld:s=1,o=n+i[1]-i[0];break;default:s=e-1,o=t}const l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(o-n),this._offsetPrev=r*c,this._offsetNext=s*c}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-t)/(i-t),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,v=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,_=d*m-d*f;for(let w=0;w!==a;++w)r[w]=g*s[c+w]+v*s[l+w]+y*s[o+w]+_*s[u+w];return r}}class Eg extends Tg{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=(n-t)/(i-t),u=1-c;for(let h=0;h!==a;++h)r[h]=s[l+h]*u+s[o+h]*c;return r}}class Cg extends Tg{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class Ig{constructor(e,t,n,i){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ng(t,this.TimeBufferType),this.values=Ng(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Ng(e.times,Array),values:Ng(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Cg(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Eg(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Ag(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Id:t=this.InterpolantFactoryMethodDiscrete;break;case Rd:t=this.InterpolantFactoryMethodLinear;break;case Pd:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Id;case this.InterpolantFactoryMethodLinear:return Rd;case this.InterpolantFactoryMethodSmooth:return Pd}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let r=0,s=i-1;for(;r!==i&&n[r]<e;)++r;for(;-1!==s&&n[s]>t;)--s;if(++s,0!==r||s!==i){r>=s&&(s=Math.max(s,1),r=s-1);const e=this.getValueSize();this.times=n.slice(r,s),this.values=this.values.slice(r*e,s*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==r;a++){const t=n[a];if("number"===typeof t&&isNaN(t)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,t),e=!1;break}if(null!==s&&s>t){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,t,s),e=!1;break}s=t}if(void 0!==i&&Mg(i))for(let a=0,o=i.length;a!==o;++a){const t=i[a];if(isNaN(t)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,t),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),i=this.getInterpolation()===Pd,r=e.length-1;let s=1;for(let a=1;a<r;++a){let r=!1;const o=e[a];if(o!==e[a+1]&&(1!==a||o!==e[0]))if(i)r=!0;else{const e=a*n,i=e-n,s=e+n;for(let a=0;a!==n;++a){const n=t[e+a];if(n!==t[i+a]||n!==t[s+a]){r=!0;break}}}if(r){if(a!==s){e[s]=e[a];const i=a*n,r=s*n;for(let e=0;e!==n;++e)t[r+e]=t[i+e]}++s}}if(r>0){e[s]=e[r];for(let e=r*n,i=s*n,a=0;a!==n;++a)t[i+a]=t[e+a];++s}return s!==e.length?(this.times=e.slice(0,s),this.values=t.slice(0,s*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}Ig.prototype.TimeBufferType=Float32Array,Ig.prototype.ValueBufferType=Float32Array,Ig.prototype.DefaultInterpolation=Rd;class Rg extends Ig{}Rg.prototype.ValueTypeName="bool",Rg.prototype.ValueBufferType=Array,Rg.prototype.DefaultInterpolation=Id,Rg.prototype.InterpolantFactoryMethodLinear=void 0,Rg.prototype.InterpolantFactoryMethodSmooth=void 0;class Pg extends Ig{}Pg.prototype.ValueTypeName="color";class Dg extends Ig{}Dg.prototype.ValueTypeName="number";class kg extends Tg{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(n-t)/(i-t);let l=e*a;for(let c=l+a;l!==c;l+=4)Pp.slerpFlat(r,0,s,l-a,s,l,o);return r}}class Lg extends Ig{InterpolantFactoryMethodLinear(e){return new kg(this.times,this.values,this.getValueSize(),e)}}Lg.prototype.ValueTypeName="quaternion",Lg.prototype.DefaultInterpolation=Rd,Lg.prototype.InterpolantFactoryMethodSmooth=void 0;class Og extends Ig{}Og.prototype.ValueTypeName="string",Og.prototype.ValueBufferType=Array,Og.prototype.DefaultInterpolation=Id,Og.prototype.InterpolantFactoryMethodLinear=void 0,Og.prototype.InterpolantFactoryMethodSmooth=void 0;class Bg extends Ig{}Bg.prototype.ValueTypeName="vector";const Ug={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class zg{constructor(e,t,n){const i=this;let r,s=!1,a=0,o=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){o++,!1===s&&void 0!==i.onStart&&i.onStart(e,a,o),s=!0},this.itemEnd=function(e){a++,void 0!==i.onProgress&&i.onProgress(e,a,o),a===o&&(s=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return r?r(e):e},this.setURLModifier=function(e){return r=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){const n=l[t],i=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return i}return null}}}const Vg=new zg;class Fg{constructor(e){this.manager=void 0!==e?e:Vg,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise((function(i,r){n.load(e,i,t,r)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Fg.DEFAULT_MATERIAL_NAME="__DEFAULT";const jg={};class Hg extends Error{constructor(e,t){super(e),this.response=t}}class Gg extends Fg{constructor(e){super(e)}load(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=Ug.get(e);if(void 0!==r)return this.manager.itemStart(e),setTimeout((()=>{t&&t(r),this.manager.itemEnd(e)}),0),r;if(void 0!==jg[e])return void jg[e].push({onLoad:t,onProgress:n,onError:i});jg[e]=[],jg[e].push({onLoad:t,onProgress:n,onError:i});const s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,o=this.responseType;fetch(s).then((t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"===typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;const n=jg[e],i=t.body.getReader(),r=t.headers.get("Content-Length")||t.headers.get("X-File-Size"),s=r?parseInt(r):0,a=0!==s;let o=0;const l=new ReadableStream({start(e){!function t(){i.read().then((i=>{let{done:r,value:l}=i;if(r)e.close();else{o+=l.byteLength;const i=new ProgressEvent("progress",{lengthComputable:a,loaded:o,total:s});for(let e=0,t=n.length;e<t;e++){const t=n[e];t.onProgress&&t.onProgress(i)}e.enqueue(l),t()}}))}()}});return new Response(l)}throw new Hg('fetch for "'.concat(t.url,'" responded with ').concat(t.status,": ").concat(t.statusText),t)})).then((e=>{switch(o){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((e=>(new DOMParser).parseFromString(e,a)));case"json":return e.json();default:if(void 0===a)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(a),n=t&&t[1]?t[1].toLowerCase():void 0,i=new TextDecoder(n);return e.arrayBuffer().then((e=>i.decode(e)))}}})).then((t=>{Ug.add(e,t);const n=jg[e];delete jg[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onLoad&&i.onLoad(t)}})).catch((t=>{const n=jg[e];if(void 0===n)throw this.manager.itemError(e),t;delete jg[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onError&&i.onError(t)}this.manager.itemError(e)})).finally((()=>{this.manager.itemEnd(e)})),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Wg extends Bf{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this.isLight=!0,this.type="Light",this.color=new Zf(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class Yg extends Wg{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Bf.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Zf(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const qg=new uf,Xg=new Dp,Kg=new Dp;class Jg{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new lp(512,512),this.map=null,this.mapPass=null,this.matrix=new uf,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new $m,this._frameExtents=new lp(1,1),this._viewportCount=1,this._viewports=[new Cp(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Xg.setFromMatrixPosition(e.matrixWorld),t.position.copy(Xg),Kg.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Kg),t.updateMatrixWorld(),qg.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(qg),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(qg)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class $g extends Jg{constructor(){super(new Gm(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*ep*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;n===t.fov&&i===t.aspect&&r===t.far||(t.fov=n,t.aspect=i,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Qg extends Wg{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2;super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Bf.DEFAULT_UP),this.updateMatrix(),this.target=new Bf,this.distance=n,this.angle=i,this.penumbra=r,this.decay=s,this.map=null,this.shadow=new $g}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const Zg=new uf,ev=new Dp,tv=new Dp;class nv extends Jg{constructor(){super(new Gm(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new lp(4,2),this._viewportCount=6,this._viewports=[new Cp(2,1,1,1),new Cp(0,1,1,1),new Cp(3,1,1,1),new Cp(1,1,1,1),new Cp(3,0,1,1),new Cp(1,0,1,1)],this._cubeDirections=[new Dp(1,0,0),new Dp(-1,0,0),new Dp(0,0,1),new Dp(0,0,-1),new Dp(0,1,0),new Dp(0,-1,0)],this._cubeUps=[new Dp(0,1,0),new Dp(0,1,0),new Dp(0,1,0),new Dp(0,1,0),new Dp(0,0,1),new Dp(0,0,-1)]}updateMatrices(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.camera,i=this.matrix,r=e.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),ev.setFromMatrixPosition(e.matrixWorld),n.position.copy(ev),tv.copy(n.position),tv.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(tv),n.updateMatrixWorld(),i.makeTranslation(-ev.x,-ev.y,-ev.z),Zg.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Zg)}}class iv extends Wg{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new nv}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class rv extends Jg{constructor(){super(new tg(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class sv extends Wg{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Bf.DEFAULT_UP),this.updateMatrix(),this.target=new Bf,this.shadow=new rv}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class av extends Wg{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class ov extends Fg{constructor(e){super(e),this.textures={}}load(e,t,n,i){const r=this,s=new Gg(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(e,(function(n){try{t(r.parse(JSON.parse(n)))}catch(s){i?i(s):console.error(s),r.manager.itemError(e)}}),n,i)}parse(e){const t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}const i=ov.createMaterialFromType(e.type);if(void 0!==e.uuid&&(i.uuid=e.uuid),void 0!==e.name&&(i.name=e.name),void 0!==e.color&&void 0!==i.color&&i.color.setHex(e.color),void 0!==e.roughness&&(i.roughness=e.roughness),void 0!==e.metalness&&(i.metalness=e.metalness),void 0!==e.sheen&&(i.sheen=e.sheen),void 0!==e.sheenColor&&(i.sheenColor=(new Zf).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(i.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==i.emissive&&i.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==i.specular&&i.specular.setHex(e.specular),void 0!==e.specularIntensity&&(i.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==i.specularColor&&i.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(i.shininess=e.shininess),void 0!==e.clearcoat&&(i.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(i.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.iridescence&&(i.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(i.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(i.transmission=e.transmission),void 0!==e.thickness&&(i.thickness=e.thickness),void 0!==e.attenuationDistance&&(i.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==i.attenuationColor&&i.attenuationColor.setHex(e.attenuationColor),void 0!==e.anisotropy&&(i.anisotropy=e.anisotropy),void 0!==e.anisotropyRotation&&(i.anisotropyRotation=e.anisotropyRotation),void 0!==e.fog&&(i.fog=e.fog),void 0!==e.flatShading&&(i.flatShading=e.flatShading),void 0!==e.blending&&(i.blending=e.blending),void 0!==e.combine&&(i.combine=e.combine),void 0!==e.side&&(i.side=e.side),void 0!==e.shadowSide&&(i.shadowSide=e.shadowSide),void 0!==e.opacity&&(i.opacity=e.opacity),void 0!==e.transparent&&(i.transparent=e.transparent),void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest),void 0!==e.alphaHash&&(i.alphaHash=e.alphaHash),void 0!==e.depthFunc&&(i.depthFunc=e.depthFunc),void 0!==e.depthTest&&(i.depthTest=e.depthTest),void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite),void 0!==e.blendSrc&&(i.blendSrc=e.blendSrc),void 0!==e.blendDst&&(i.blendDst=e.blendDst),void 0!==e.blendEquation&&(i.blendEquation=e.blendEquation),void 0!==e.blendSrcAlpha&&(i.blendSrcAlpha=e.blendSrcAlpha),void 0!==e.blendDstAlpha&&(i.blendDstAlpha=e.blendDstAlpha),void 0!==e.blendEquationAlpha&&(i.blendEquationAlpha=e.blendEquationAlpha),void 0!==e.blendColor&&void 0!==i.blendColor&&i.blendColor.setHex(e.blendColor),void 0!==e.blendAlpha&&(i.blendAlpha=e.blendAlpha),void 0!==e.stencilWriteMask&&(i.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(i.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(i.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(i.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(i.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(i.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(i.stencilZPass=e.stencilZPass),void 0!==e.stencilWrite&&(i.stencilWrite=e.stencilWrite),void 0!==e.wireframe&&(i.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(i.rotation=e.rotation),void 0!==e.linewidth&&(i.linewidth=e.linewidth),void 0!==e.dashSize&&(i.dashSize=e.dashSize),void 0!==e.gapSize&&(i.gapSize=e.gapSize),void 0!==e.scale&&(i.scale=e.scale),void 0!==e.polygonOffset&&(i.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(i.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(i.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(i.dithering=e.dithering),void 0!==e.alphaToCoverage&&(i.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(i.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(i.forceSinglePass=e.forceSinglePass),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.toneMapped&&(i.toneMapped=e.toneMapped),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.vertexColors&&("number"===typeof e.vertexColors?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),void 0!==e.uniforms)for(const r in e.uniforms){const t=e.uniforms[r];switch(i.uniforms[r]={},t.type){case"t":i.uniforms[r].value=n(t.value);break;case"c":i.uniforms[r].value=(new Zf).setHex(t.value);break;case"v2":i.uniforms[r].value=(new lp).fromArray(t.value);break;case"v3":i.uniforms[r].value=(new Dp).fromArray(t.value);break;case"v4":i.uniforms[r].value=(new Cp).fromArray(t.value);break;case"m3":i.uniforms[r].value=(new cp).fromArray(t.value);break;case"m4":i.uniforms[r].value=(new uf).fromArray(t.value);break;default:i.uniforms[r].value=t.value}}if(void 0!==e.defines&&(i.defines=e.defines),void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(i.glslVersion=e.glslVersion),void 0!==e.extensions)for(const r in e.extensions)i.extensions[r]=e.extensions[r];if(void 0!==e.lights&&(i.lights=e.lights),void 0!==e.clipping&&(i.clipping=e.clipping),void 0!==e.size&&(i.size=e.size),void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(i.map=n(e.map)),void 0!==e.matcap&&(i.matcap=n(e.matcap)),void 0!==e.alphaMap&&(i.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(i.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale),void 0!==e.normalMap&&(i.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(i.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),i.normalScale=(new lp).fromArray(t)}return void 0!==e.displacementMap&&(i.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(i.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(i.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(i.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(i.specularMap=n(e.specularMap)),void 0!==e.specularIntensityMap&&(i.specularIntensityMap=n(e.specularIntensityMap)),void 0!==e.specularColorMap&&(i.specularColorMap=n(e.specularColorMap)),void 0!==e.envMap&&(i.envMap=n(e.envMap)),void 0!==e.envMapRotation&&i.envMapRotation.fromArray(e.envMapRotation),void 0!==e.envMapIntensity&&(i.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(i.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(i.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(i.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(i.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(i.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(i.clearcoatNormalScale=(new lp).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(i.iridescenceMap=n(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(i.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(i.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(i.thicknessMap=n(e.thicknessMap)),void 0!==e.anisotropyMap&&(i.anisotropyMap=n(e.anisotropyMap)),void 0!==e.sheenColorMap&&(i.sheenColorMap=n(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(i.sheenRoughnessMap=n(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){return new{ShadowMaterial:fg,SpriteMaterial:cg,RawShaderMaterial:mg,ShaderMaterial:zm,PointsMaterial:dg,MeshPhysicalMaterial:vg,MeshStandardMaterial:gg,MeshPhongMaterial:yg,MeshToonMaterial:_g,MeshNormalMaterial:wg,MeshLambertMaterial:xg,MeshDepthMaterial:rg,MeshDistanceMaterial:sg,MeshBasicMaterial:im,MeshMatcapMaterial:bg,LineDashedMaterial:Sg,LineBasicMaterial:hg,Material:nm}[e]}}const lv="\\[\\]\\.:\\/",cv=new RegExp("["+lv+"]","g"),uv="[^"+lv+"]",hv="[^"+lv.replace("\\.","")+"]",dv=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",uv)+/(WCOD+)?/.source.replace("WCOD",hv)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",uv)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",uv)+"$"),pv=["material","materials","bones","map"];class fv{constructor(e,t,n){this.path=t,this.parsedPath=n||fv.parseTrackName(t),this.node=fv.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new fv.Composite(e,t,n):new fv(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(cv,"")}static parseTrackName(e){const t=dv.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const e=n.nodeName.substring(i+1);-1!==pv.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let i=0;i<e.length;i++){const r=e[i];if(r.name===t||r.uuid===t)return r;const s=n(r.children);if(s)return s}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let r=t.propertyIndex;if(e||(e=fv.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(n){let i=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===i){i=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==i){if(void 0===e[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[i]}}const s=e[i];if(void 0===s){const n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+i+" but it wasn't found.",e)}let a=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?a=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(a=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[r]&&(r=e.morphTargetDictionary[r])}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}fv.Composite=class{constructor(e,t,n){const i=n||fv.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},fv.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},fv.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},fv.prototype.GetterByBindingType=[fv.prototype._getValue_direct,fv.prototype._getValue_array,fv.prototype._getValue_arrayElement,fv.prototype._getValue_toArray],fv.prototype.SetterByBindingTypeAndVersioning=[[fv.prototype._setValue_direct,fv.prototype._setValue_direct_setNeedsUpdate,fv.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[fv.prototype._setValue_array,fv.prototype._setValue_array_setNeedsUpdate,fv.prototype._setValue_array_setMatrixWorldNeedsUpdate],[fv.prototype._setValue_arrayElement,fv.prototype._setValue_arrayElement_setNeedsUpdate,fv.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[fv.prototype._setValue_fromArray,fv.prototype._setValue_fromArray_setNeedsUpdate,fv.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];new Float32Array(1);class mv extends ag{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}function gv(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="{";!0===e.isNode&&(n+=e.id);for(const{property:i,childNode:r}of vv(e))n+=","+i.slice(0,-4)+":"+r.getCacheKey(t);return n+="}",n}function vv(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function*(){for(const n in e){if(!0===n.startsWith("_"))continue;const i=e[n];if(!0===Array.isArray(i))for(let e=0;e<i.length;e++){const r=i[e];r&&(!0===r.isNode||t&&"function"===typeof r.toJSON)&&(yield{property:n,index:e,childNode:r})}else if(i&&!0===i.isNode)yield{property:n,childNode:i};else if("object"===typeof i)for(const e in i){const r=i[e];r&&(!0===r.isNode||t&&"function"===typeof r.toJSON)&&(yield{property:n,index:e,childNode:r})}}}()}function yv(e){if(void 0===e||null===e)return null;const t=typeof e;return!0===e.isNode?"node":"number"===t?"float":"boolean"===t?"bool":"string"===t?"string":"function"===t?"shader":!0===e.isVector2?"vec2":!0===e.isVector3?"vec3":!0===e.isVector4?"vec4":!0===e.isMatrix3?"mat3":!0===e.isMatrix4?"mat4":!0===e.isColor?"color":e instanceof ArrayBuffer?"ArrayBuffer":null}function _v(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=e?e.slice(-4):void 0;return 1===n.length&&("vec2"===r?n=[n[0],n[0]]:"vec3"===r?n=[n[0],n[0],n[0]]:"vec4"===r&&(n=[n[0],n[0],n[0],n[0]])),"color"===e?new Zf(...n):"vec2"===r?new lp(...n):"vec3"===r?new Dp(...n):"vec4"===r?new Cp(...n):"mat3"===r?new cp(...n):"mat4"===r?new uf(...n):"bool"===e?n[0]||!1:"float"===e||"int"===e||"uint"===e?n[0]||0:"string"===e?n[0]||"":"ArrayBuffer"===e?xv(n[0]):null}function wv(e){let t="";const n=new Uint8Array(e);for(let i=0;i<n.length;i++)t+=String.fromCharCode(n[i]);return btoa(t)}function xv(e){return Uint8Array.from(atob(e),(e=>e.charCodeAt(0))).buffer}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:sd}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=sd);const bv=new Map;let Sv=0;const Nv=class extends Jd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.nodeType=e,this.updateType=ed,this.updateBeforeType=ed,this.uuid=op.generateUUID(),this.version=0,this._cacheKey=null,this._cacheKeyVersion=0,this.isNode=!0,Object.defineProperty(this,"id",{value:Sv++})}set needsUpdate(e){!0===e&&this.version++}get type(){return this.constructor.type}onUpdate(e,t){return this.updateType=t,this.update=e.bind(this.getSelf()),this}onFrameUpdate(e){return this.onUpdate(e,td)}onRenderUpdate(e){return this.onUpdate(e,nd)}onObjectUpdate(e){return this.onUpdate(e,id)}getSelf(){return this.self||this}updateReference(){return this}isGlobal(){return!1}*getChildren(){for(const{childNode:e}of vv(this))yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const t of this.getChildren())t.traverse(e)}getCacheKey(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e=e||this.version!==this._cacheKeyVersion,!0!==e&&null!==this._cacheKey||(this._cacheKey=gv(this,e),this._cacheKeyVersion=this.version),this._cacheKey}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getNodeType(e){const t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}getShared(e){const t=this.getHash(e);return e.getNodeFromHash(t)||this}setup(e){const t=e.getNodeProperties(this);for(const n of this.getChildren())t["_node"+n.id]=n;return null}construct(e){return console.warn("THREE.Node: construct() is deprecated. Use setup() instead."),this.setup(e)}increaseUsage(e){const t=e.getDataFromNode(this);return t.usageCount=void 0===t.usageCount?1:t.usageCount+1,t.usageCount}analyze(e){if(1===this.increaseUsage(e)){const t=e.getNodeProperties(this);for(const n of Object.values(t))n&&!0===n.isNode&&n.build(e)}}generate(e,t){const{outputNode:n}=e.getNodeProperties(this);if(n&&!0===n.isNode)return n.build(e,t)}updateBefore(){console.warn("Abstract function.")}update(){console.warn("Abstract function.")}build(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.getShared(e);if(this!==n)return n.build(e,t);e.addNode(this),e.addChain(this);let i=null;const r=e.getBuildStage();if("setup"===r){this.updateReference(e);const t=e.getNodeProperties(this);if(!0!==t.initialized||!1===e.context.tempRead){const n=e.stack.nodes.length;t.initialized=!0,t.outputNode=this.setup(e),null!==t.outputNode&&e.stack.nodes.length!==n&&(t.outputNode=e.stack);for(const i of Object.values(t))i&&!0===i.isNode&&i.build(e)}}else if("analyze"===r)this.analyze(e);else if("generate"===r){if(1===this.generate.length){const n=this.getNodeType(e),r=e.getDataFromNode(this);i=r.snippet,void 0===i&&(i=this.generate(e)||"",r.snippet=i),i=e.format(i,n,t)}else i=this.generate(e,t)||""}return e.removeChain(this),i}getSerializeChildren(){return vv(this)}serialize(e){const t=this.getSerializeChildren(),n={};for(const{property:i,index:r,childNode:s}of t)void 0!==r?(void 0===n[i]&&(n[i]=Number.isInteger(r)?[]:{}),n[i][r]=s.toJSON(e.meta).uuid):n[i]=s.toJSON(e.meta).uuid;Object.keys(n).length>0&&(e.inputNodes=n)}deserialize(e){if(void 0!==e.inputNodes){const t=e.meta.nodes;for(const n in e.inputNodes)if(Array.isArray(e.inputNodes[n])){const i=[];for(const r of e.inputNodes[n])i.push(t[r]);this[n]=i}else if("object"===typeof e.inputNodes[n]){const i={};for(const r in e.inputNodes[n]){const s=e.inputNodes[n][r];i[r]=t[s]}this[n]=i}else{const i=e.inputNodes[n];this[n]=t[i]}}}toJSON(e){const{uuid:t,type:n}=this,i=void 0===e||"string"===typeof e;i&&(e={textures:{},images:{},nodes:{}});let r=e.nodes[t];function s(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}if(void 0===r&&(r={uuid:t,type:n,meta:e,metadata:{version:4.6,type:"Node",generator:"Node.toJSON"}},!0!==i&&(e.nodes[r.uuid]=r),this.serialize(r),delete r.meta),i){const t=s(e.textures),n=s(e.images),i=s(e.nodes);t.length>0&&(r.textures=t),n.length>0&&(r.images=n),i.length>0&&(r.nodes=i)}return r}};function Mv(e,t){if("function"!==typeof t||!e)throw new Error("Node class ".concat(e," is not a class"));bv.has(e)?console.warn("Redefinition of node class ".concat(e)):(bv.set(e,t),t.type=e)}class Tv extends Nv{constructor(e){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,t){if("generate"===e.getBuildStage()){const n=e.getVectorType(this.getNodeType(e,t)),i=e.getDataFromNode(this);if(!1!==e.context.tempRead&&void 0!==i.propertyName)return e.format(i.propertyName,n,t);if(!1!==e.context.tempWrite&&"void"!==n&&"void"!==t&&this.hasDependencies(e)){const r=super.build(e,n),s=e.getVarFromNode(this,null,n),a=e.getPropertyName(s);return e.addLineFlowCode("".concat(a," = ").concat(r)),i.snippet=r,i.propertyName=a,e.format(i.propertyName,n,t)}}return super.build(e,t)}}const Av=Tv;Mv("TempNode",Tv);class Ev extends Nv{constructor(e,t){super(),this.node=e,this.indexNode=t,this.isArrayElementNode=!0}getNodeType(e){return this.node.getNodeType(e)}generate(e){const t=this.node.build(e),n=this.indexNode.build(e,"uint");return"".concat(t,"[ ").concat(n," ]")}}const Cv=Ev;Mv("ArrayElementNode",Ev);class Iv extends Nv{constructor(e,t){super(),this.node=e,this.convertTo=t}getNodeType(e){const t=this.node.getNodeType(e);let n=null;for(const i of this.convertTo.split("|"))null!==n&&e.getTypeLength(t)!==e.getTypeLength(i)||(n=i);return n}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,t){const n=this.node,i=this.getNodeType(e),r=n.build(e,i);return e.format(r,i,t)}}const Rv=Iv;Mv("ConvertNode",Iv);class Pv extends Av{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null),this.nodes=e}getNodeType(e){return null!==this.nodeType?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce(((t,n)=>t+e.getTypeLength(n.getNodeType(e))),0))}generate(e,t){const n=this.getNodeType(e),i=this.nodes,r=e.getComponentType(n),s=[];for(const o of i){let t=o.build(e);const n=e.getComponentType(o.getNodeType(e));n!==r&&(t=e.format(t,n,r)),s.push(t)}const a="".concat(e.getType(n),"( ").concat(s.join(", ")," )");return e.format(a,n,t)}}const Dv=Pv;Mv("JoinNode",Pv);const kv=rd.join("");class Lv extends Nv{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x";super(),this.node=e,this.components=t,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const t of this.components)e=Math.max(rd.indexOf(t)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}generate(e,t){const n=this.node,i=e.getTypeLength(n.getNodeType(e));let r=null;if(i>1){let s=null;this.getVectorLength()>=i&&(s=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const a=n.build(e,s);r=this.components.length===i&&this.components===kv.slice(0,this.components.length)?e.format(a,s,t):e.format("".concat(a,".").concat(this.components),this.getNodeType(e),t)}else r=n.build(e,t);return r}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}const Ov=Lv;Mv("SplitNode",Lv);class Bv extends Av{constructor(e,t,n){super(),this.sourceNode=e,this.components=t,this.targetNode=n}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:t,components:n,targetNode:i}=this,r=this.getNodeType(e),s=e.getTypeFromLength(n.length),a=i.build(e,s),o=t.build(e,r),l=e.getTypeLength(r),c=[];for(let u=0;u<l;u++){const e=rd[u];e===n[0]?(c.push(a),u+=n.length-1):c.push(o+"."+e)}return"".concat(e.getType(r),"( ").concat(c.join(", ")," )")}}const Uv=Bv;Mv("SetNode",Bv);class zv extends Nv{constructor(e){super(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return null===this.nodeType?yv(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=yv(this.value),e.nodeType=this.nodeType,"ArrayBuffer"===e.valueType&&(e.value=wv(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?_v(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){console.warn("Abstract function.")}}const Vv=zv;Mv("InputNode",zv);class Fv extends Vv{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,t){const n=this.getNodeType(e);return e.format(this.generateConst(e),n,t)}}const jv=Fv;Mv("ConstNode",Fv);let Hv=null;const Gv=new Map;function Wv(e,t){if(Gv.has(e))console.warn("Redefinition of node element ".concat(e));else{if("function"!==typeof t)throw new Error("Node element ".concat(e," is not a function"));Gv.set(e,t)}}const Yv=e=>e.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),qv={setup(e,t){const n=t.shift();return e(gy(n),...t)},get(e,t,n){if("string"===typeof t&&void 0===e[t]){if(!0!==e.isStackNode&&"assign"===t)return function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return Hv.assign(n,...t),n};if(Gv.has(t)){const i=Gv.get(t);return e.isStackNode?function(){return n.add(i(...arguments))}:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return i(n,...t)}}if("self"===t)return e;if(t.endsWith("Assign")&&Gv.has(t.slice(0,t.length-6))){const i=Gv.get(t.slice(0,t.length-6));return e.isStackNode?function(){return n.assign(arguments.length<=0?void 0:arguments[0],i(...arguments))}:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.assign(i(n,...t))}}if(!0===/^[xyzwrgbastpq]{1,4}$/.test(t))return t=Yv(t),my(new Ov(n,t));if(!0===/^set[XYZWRGBASTPQ]{1,4}$/.test(t))return t=(t=Yv(t.slice(3).toLowerCase())).split("").sort().join(""),n=>my(new Uv(e,t,n));if("width"===t||"height"===t||"depth"===t)return"width"===t?t="x":"height"===t?t="y":"depth"===t&&(t="z"),my(new Ov(e,t));if(!0===/^\d+$/.test(t))return my(new Cv(n,new jv(Number(t),"uint")))}return Reflect.get(e,t,n)},set:(e,t,n,i)=>"string"!==typeof t||void 0!==e[t]||!0!==/^[xyzwrgbastpq]{1,4}$/.test(t)&&"width"!==t&&"height"!==t&&"depth"!==t&&!0!==/^\d+$/.test(t)?Reflect.set(e,t,n,i):(i[t].assign(n),!0)},Xv=new WeakMap,Kv=new WeakMap,Jv=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(const n in e)e[n]=my(e[n],t);return e},$v=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=e.length;for(let i=0;i<n;i++)e[i]=my(e[i],t);return e},Qv=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=e=>my(null!==i?Object.assign(e,i):e);return null===t?function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return r(new e(...vy(n)))}:null!==n?(n=my(n),function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return r(new e(t,...vy(s),n))}):function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return r(new e(t,...vy(i)))}},Zv=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return my(new e(...vy(n)))};class ey extends Nv{constructor(e,t){super(),this.shaderNode=e,this.inputNodes=t}getNodeType(e){const{outputNode:t}=e.getNodeProperties(this);return t?t.getNodeType(e):super.getNodeType(e)}call(e){const{shaderNode:t,inputNodes:n}=this;if(t.layout){let i=Kv.get(e.constructor);void 0===i&&(i=new WeakMap,Kv.set(e.constructor,i));let r=i.get(t);return void 0===r&&(r=my(e.buildFunctionNode(t)),i.set(t,r)),null!==e.currentFunctionNode&&e.currentFunctionNode.includes.push(r),my(r.call(n))}const i=t.jsFunc,r=null!==n?i(n,e.stack,e):i(e.stack,e);return my(r)}setup(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}generate(e,t){const{outputNode:n}=e.getNodeProperties(this);return null===n?this.call(e).build(e,t):super.generate(e,t)}}class ty extends Nv{constructor(e){super(),this.jsFunc=e,this.layout=null}get isArrayInput(){return/^\((\s+)?\[/.test(this.jsFunc.toString())}setLayout(e){return this.layout=e,this}call(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return gy(e),my(new ey(this,e))}setup(){return this.call()}}const ny=[!1,!0],iy=[0,1,2,3],ry=[-1,-2],sy=[.5,1.5,1/3,1e-6,1e6,Math.PI,2*Math.PI,1/Math.PI,2/Math.PI,1/(2*Math.PI),Math.PI/2],ay=new Map;for(const n of ny)ay.set(n,new jv(n));const oy=new Map;for(const n of iy)oy.set(n,new jv(n,"uint"));const ly=new Map([...oy].map((e=>new jv(e.value,"int"))));for(const n of ry)ly.set(n,new jv(n,"int"));const cy=new Map([...ly].map((e=>new jv(e.value))));for(const n of sy)cy.set(n,new jv(n));for(const n of sy)cy.set(-n,new jv(-n));const uy={bool:ay,uint:oy,ints:ly,float:cy},hy=new Map([...ay,...cy]),dy=(e,t)=>hy.has(e)?hy.get(e):!0===e.isNode?e:new jv(e,t),py=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];if((0===i.length||!["bool","float","int","uint"].includes(e)&&i.every((e=>"object"!==typeof e)))&&(i=[_v(e,...i)]),1===i.length&&null!==t&&t.has(i[0]))return my(t.get(i[0]));if(1===i.length){const t=dy(i[0],e);return(e=>{try{return e.getNodeType()}catch(t){return}})(t)===e?my(t):my(new Rv(t,e))}const s=i.map((e=>dy(e)));return my(new Dv(s,e))}};function fy(e){return new Proxy(new ty(e),qv)}const my=function(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=yv(e);if("node"===n){let t=Xv.get(e);return void 0===t&&(t=new Proxy(e,qv),Xv.set(e,t),Xv.set(t,t)),t}return null===t&&("float"===n||"boolean"===n)||n&&"shader"!==n&&"string"!==n?my(dy(e,t)):"shader"===n?wy(e):e}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)},gy=function(e){return new Jv(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)},vy=function(e){return new $v(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)},yy=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Qv(...t)},_y=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Zv(...t)},wy=e=>{const t=new fy(e),n=function(){let e;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gy(i),e=i[0]&&i[0].isNode?[...i]:i[0],t.call(e)};return n.shaderNode=t,n.setLayout=e=>(t.setLayout(e),n),n};Mv("ShaderNode",fy);const xy=e=>{Hv=e},by=function(){return Hv.if(...arguments)};Wv("append",(function(e){return Hv&&Hv.add(e),e}));const Sy=new py("color"),Ny=new py("float",uy.float),My=new py("int",uy.ints),Ty=new py("uint",uy.uint),Ay=new py("bool",uy.bool),Ey=new py("vec2"),Cy=new py("ivec2"),Iy=new py("uvec2"),Ry=new py("bvec2"),Py=new py("vec3"),Dy=new py("ivec3"),ky=new py("uvec3"),Ly=new py("bvec3"),Oy=new py("vec4"),By=new py("ivec4"),Uy=new py("uvec4"),zy=new py("bvec4"),Vy=new py("mat2"),Fy=new py("imat2"),jy=new py("umat2"),Hy=new py("bmat2"),Gy=new py("mat3"),Wy=new py("imat3"),Yy=new py("umat3"),qy=new py("bmat3"),Xy=new py("mat4"),Ky=new py("imat4"),Jy=new py("umat4"),$y=new py("bmat4");Wv("color",Sy),Wv("float",Ny),Wv("int",My),Wv("uint",Ty),Wv("bool",Ay),Wv("vec2",Ey),Wv("ivec2",Cy),Wv("uvec2",Iy),Wv("bvec2",Ry),Wv("vec3",Py),Wv("ivec3",Dy),Wv("uvec3",ky),Wv("bvec3",Ly),Wv("vec4",Oy),Wv("ivec4",By),Wv("uvec4",Uy),Wv("bvec4",zy),Wv("mat2",Vy),Wv("imat2",Fy),Wv("umat2",jy),Wv("bmat2",Hy),Wv("mat3",Gy),Wv("imat3",Wy),Wv("umat3",Yy),Wv("bmat3",qy),Wv("mat4",Xy),Wv("imat4",Ky),Wv("umat4",Jy),Wv("bmat4",$y),Wv("string",(function(){return my(new jv(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"","string"))})),Wv("arrayBuffer",(e=>my(new jv(e,"ArrayBuffer"))));Wv("element",yy(Cv)),Wv("convert",((e,t)=>my(new Rv(my(e),t))));class Qy extends Av{constructor(e,t){super(),this.targetNode=e,this.sourceNode=t}hasDependencies(){return!1}getNodeType(e,t){return"void"!==t?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){const{targetNode:t}=this;if(!1===e.isAvailable("swizzleAssign")&&t.isSplitNode&&t.components.length>1){const n=e.getTypeLength(t.node.getNodeType(e));return rd.join("").slice(0,n)!==t.components}return!1}generate(e,t){const{targetNode:n,sourceNode:i}=this,r=this.needsSplitAssign(e),s=n.getNodeType(e),a=n.context({assign:!0}).build(e),o=i.build(e,s),l=i.getNodeType(e),c=e.getDataFromNode(this);let u;if(!0===c.initialized)"void"!==t&&(u=a);else if(r){const i=e.getVarFromNode(this,null,s),r=e.getPropertyName(i);e.addLineFlowCode("".concat(r," = ").concat(o));const l=n.node.context({assign:!0}).build(e);for(let t=0;t<n.components.length;t++){const i=n.components[t];e.addLineFlowCode("".concat(l,".").concat(i," = ").concat(r,"[ ").concat(t," ]"))}"void"!==t&&(u=a)}else u="".concat(a," = ").concat(o),"void"!==t&&"void"!==l||(e.addLineFlowCode(u),"void"!==t&&(u=a));return c.initialized=!0,e.format(u,s,t)}}const Zy=yy(Qy);Mv("AssignNode",Qy),Wv("assign",Zy);class e_ extends Nv{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(),this.node=e,this.name=t,this.isVaryingNode=!0}isGlobal(){return!0}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}generate(e){const{name:t,node:n}=this,i=this.getNodeType(e),r=e.getVaryingFromNode(this,t,i);r.needsInterpolation||(r.needsInterpolation="fragment"===e.shaderStage);const s=e.getPropertyName(r,Zh);return e.flowNodeFromShaderStage(Zh,n,i,s),e.getPropertyName(r)}}const t_=yy(e_);Wv("varying",t_),Mv("VaryingNode",e_);class n_ extends Nv{constructor(e){super(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null),this._attributeName=e}isGlobal(){return!0}getHash(e){return this.getAttributeName(e)}getNodeType(e){let t=super.getNodeType(e);if(null===t){const n=this.getAttributeName(e);if(e.hasGeometryAttribute(n)){const i=e.geometry.getAttribute(n);t=e.getTypeFromAttribute(i)}else t="float"}return t}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){const t=this.getAttributeName(e),n=this.getNodeType(e);if(!0===e.hasGeometryAttribute(t)){const i=e.geometry.getAttribute(t),r=e.getTypeFromAttribute(i),s=e.getAttribute(t,r);if("vertex"===e.shaderStage)return e.format(s.name,r,n);return t_(this).build(e,n)}return console.warn('AttributeNode: Vertex attribute "'.concat(t,'" not found on geometry.')),e.generateConst(n)}}const i_=n_,r_=(e,t)=>my(new n_(e,t));Mv("AttributeNode",n_);class s_ extends Nv{constructor(e,t){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=t}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){const t=this.callNode.build(e,"void");return""!==t&&e.addLineFlowCode(t),this.outputNode.build(e)}}const a_=yy(s_);Wv("bypass",a_),Mv("BypassNode",s_);let o_=0;const l_=class{constructor(){this.id=o_++,this.nodesData=new WeakMap}getNodeData(e){return this.nodesData.get(e)}setNodeData(e,t){this.nodesData.set(e,t)}};class c_ extends Nv{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new l_;super(),this.isCacheNode=!0,this.node=e,this.cache=t}getNodeType(e){return this.node.getNodeType(e)}build(e){const t=e.getCache(),n=this.cache||e.globalCache;e.setCache(n);for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];const a=this.node.build(e,...r);return e.setCache(t),a}}const u_=yy(c_);Wv("cache",u_),Wv("globalCache",(e=>u_(e,null))),Mv("CacheNode",c_);class h_ extends Nv{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.isContextNode=!0,this.node=e,this.context=t}getNodeType(e){return this.node.getNodeType(e)}setup(e){const t=e.getContext();e.setContext({...e.context,...this.context});const n=this.node.build(e);return e.setContext(t),n}generate(e,t){const n=e.getContext();e.setContext({...e.context,...this.context});const i=this.node.build(e,t);return e.setContext(n),i}}const d_=h_,p_=yy(h_);Wv("context",p_),Wv("label",((e,t)=>p_(e,{label:t}))),Mv("ContextNode",h_);class f_ extends Nv{constructor(e){super("uint"),this.scope=e,this.isInstanceIndexNode=!0}generate(e){const t=this.getNodeType(e),n=this.scope;let i,r;if(n===f_.VERTEX)i=e.getVertexIndex();else{if(n!==f_.INSTANCE)throw new Error("THREE.IndexNode: Unknown scope: "+n);i=e.getInstanceIndex()}if("vertex"===e.shaderStage||"compute"===e.shaderStage)r=i;else{r=t_(this).build(e,t)}return r}}f_.VERTEX="vertex",f_.INSTANCE="instance";const m_=_y(f_,f_.VERTEX),g_=_y(f_,f_.INSTANCE);Mv("IndexNode",f_);const v_=class{start(){}finish(){}direct(){}indirectDiffuse(){}indirectSpecular(){}ambientOcclusion(){}};class y_ extends Nv{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(),this.node=e,this.name=t,this.isVarNode=!0}isGlobal(){return!0}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}generate(e){const{node:t,name:n}=this,i=e.getVarFromNode(this,n,e.getVectorType(this.getNodeType(e))),r=e.getPropertyName(i),s=t.build(e,i.type);return e.addLineFlowCode("".concat(r," = ").concat(s)),r}}const __=yy(y_);Wv("temp",__),Wv("toVar",(function(){return __(...arguments).append()})),Mv("VarNode",y_);class w_ extends Nv{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(e),this.name=t,this.varying=n,this.isPropertyNode=!0}getHash(e){return this.name||super.getHash(e)}isGlobal(){return!0}generate(e){let t;return!0===this.varying?(t=e.getVaryingFromNode(this,this.name),t.needsInterpolation=!0):t=e.getVarFromNode(this,this.name),e.getPropertyName(t)}}const x_=w_,b_=(e,t)=>my(new w_(e,t)),S_=(e,t)=>my(new w_(e,t,!0)),N_=_y(w_,"vec4","DiffuseColor"),M_=_y(w_,"float","Roughness"),T_=_y(w_,"float","Metalness"),A_=_y(w_,"float","Clearcoat"),E_=_y(w_,"float","ClearcoatRoughness"),C_=_y(w_,"vec3","Sheen"),I_=_y(w_,"float","SheenRoughness"),R_=_y(w_,"float","Iridescence"),P_=_y(w_,"float","IridescenceIOR"),D_=_y(w_,"float","IridescenceThickness"),k_=_y(w_,"color","SpecularColor"),L_=_y(w_,"float","Shininess"),O_=_y(w_,"vec4","Output"),B_=_y(w_,"float","dashSize"),U_=_y(w_,"float","gapSize");_y(w_,"float","pointWidth");Mv("PropertyNode",w_);class z_ extends x_{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null),this.isParameterNode=!0}getHash(){return this.uuid}generate(){return this.name}}Mv("ParameterNode",z_);class V_ extends Nv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";super("code"),this.isCodeNode=!0,this.code=e,this.language=n,this.includes=t}isGlobal(){return!0}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){const t=this.getIncludes(e);for(const i of t)i.build(e);const n=e.getCodeFromNode(this,this.getNodeType(e));return n.code=this.code,n.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}}const F_=V_;yy(V_);Mv("CodeNode",V_);class j_ extends F_{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],arguments.length>2&&void 0!==arguments[2]?arguments[2]:""),this.keywords={}}getNodeType(e){return this.getNodeFunction(e).type}getInputs(e){return this.getNodeFunction(e).inputs}getNodeFunction(e){const t=e.getDataFromNode(this);let n=t.nodeFunction;return void 0===n&&(n=e.parser.parseFunction(this.code),t.nodeFunction=n),n}generate(e,t){super.generate(e);const n=this.getNodeFunction(e),i=n.name,r=n.type,s=e.getCodeFromNode(this,r);""!==i&&(s.name=i);const a=e.getPropertyName(s);let o=this.getNodeFunction(e).getCode(a);const l=this.keywords,c=Object.keys(l);if(c.length>0)for(const u of c){const t=new RegExp("\\b".concat(u,"\\b"),"g"),n=l[u].build(e,"property");o=o.replace(t,n)}return s.code=o+"\n","property"===t?a:e.format("".concat(a,"()"),r,t)}}Mv("FunctionNode",j_);class H_ extends Nv{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super("string"),this.name=e,this.version=0,this.shared=t,this.isUniformGroup=!0}set needsUpdate(e){!0===e&&this.version++}}const G_=e=>new H_(e,!0),W_=(G_("frame"),G_("render"),new H_("object"));Mv("UniformGroupNode",H_);class Y_ extends Vv{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null),this.isUniformNode=!0,this.groupNode=W_}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,t){const n=this.getSelf();return e=e.bind(n),super.onUpdate((t=>{const i=e(t,n);void 0!==i&&(this.value=i)}),t)}generate(e,t){const n=this.getNodeType(e),i=this.getUniformHash(e);let r=e.getNodeFromHash(i);void 0===r&&(e.setHashNode(this,i),r=this);const s=r.getInputType(e),a=e.getUniformFromNode(r,s,e.shaderStage,e.context.label),o=e.getPropertyName(a);return void 0!==e.context.label&&delete e.context.label,e.format(o,n,t)}}const q_=Y_,X_=(e,t)=>{const n=(e=>void 0!==e&&null!==e?e.nodeType||e.convertTo||("string"===typeof e?e:null):null)(t||e),i=e&&!0===e.isNode?e.node&&e.node.value||e.value:e;return my(new Y_(i,n))};Mv("UniformNode",Y_);class K_ extends i_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;super(null,"vec2"),this.isUVNode=!0,this.index=e}getAttributeName(){const e=this.index;return"uv"+(e>0?e:"")}serialize(e){super.serialize(e),e.index=this.index}deserialize(e){super.deserialize(e),this.index=e.index}}const J_=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return my(new K_(...t))};Mv("UVNode",K_);class $_ extends Nv{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=t}generate(e,t){const n=this.textureNode.build(e,"property"),i=this.levelNode.build(e,"int");return e.format("".concat(e.getMethod("textureDimensions"),"( ").concat(n,", ").concat(i," )"),this.getNodeType(e),t)}}const Q_=yy($_);Wv("textureSize",Q_),Mv("TextureSizeNode",$_);class Z_ extends Av{constructor(e,t,n){if(super(),this.op=e,(arguments.length<=3?0:arguments.length-3)>0){let t=n;for(let n=0;n<(arguments.length<=3?0:arguments.length-3);n++)t=new Z_(e,t,n+3<3||arguments.length<=n+3?void 0:arguments[n+3]);n=t}this.aNode=t,this.bNode=n}getNodeType(e,t){const n=this.op,i=this.aNode,r=this.bNode,s=i.getNodeType(e),a="undefined"!==typeof r?r.getNodeType(e):null;if("void"===s||"void"===a)return"void";if("%"===n)return s;if("~"===n||"&"===n||"|"===n||"^"===n||">>"===n||"<<"===n)return e.getIntegerType(s);if("!"===n||"=="===n||"&&"===n||"||"===n||"^^"===n)return"bool";if("<"===n||">"===n||"<="===n||">="===n){const n=t?e.getTypeLength(t):Math.max(e.getTypeLength(s),e.getTypeLength(a));return n>1?"bvec".concat(n):"bool"}return"float"===s&&e.isMatrix(a)?a:e.isMatrix(s)&&e.isVector(a)?e.getVectorFromMatrix(s):e.isVector(s)&&e.isMatrix(a)?e.getVectorFromMatrix(a):e.getTypeLength(a)>e.getTypeLength(s)?a:s}generate(e,t){const n=this.op,i=this.aNode,r=this.bNode,s=this.getNodeType(e,t);let a=null,o=null;"void"!==s?(a=i.getNodeType(e),o="undefined"!==typeof r?r.getNodeType(e):null,"<"===n||">"===n||"<="===n||">="===n||"=="===n?e.isVector(a)?o=a:a=o="float":">>"===n||"<<"===n?(a=s,o=e.changeComponentType(o,"uint")):e.isMatrix(a)&&e.isVector(o)?o=e.getVectorFromMatrix(a):a=e.isVector(a)&&e.isMatrix(o)?e.getVectorFromMatrix(o):o=s):a=o=s;const l=i.build(e,a),c="undefined"!==typeof r?r.build(e,o):null,u=e.getTypeLength(t),h=e.getFunctionOperator(n);return"void"!==t?"<"===n&&u>1?e.format("".concat(e.getMethod("lessThan"),"( ").concat(l,", ").concat(c," )"),s,t):"<="===n&&u>1?e.format("".concat(e.getMethod("lessThanEqual"),"( ").concat(l,", ").concat(c," )"),s,t):">"===n&&u>1?e.format("".concat(e.getMethod("greaterThan"),"( ").concat(l,", ").concat(c," )"),s,t):">="===n&&u>1?e.format("".concat(e.getMethod("greaterThanEqual"),"( ").concat(l,", ").concat(c," )"),s,t):"!"===n||"~"===n?e.format("(".concat(n).concat(l,")"),a,t):h?e.format("".concat(h,"( ").concat(l,", ").concat(c," )"),s,t):e.format("( ".concat(l," ").concat(n," ").concat(c," )"),s,t):"void"!==a?h?e.format("".concat(h,"( ").concat(l,", ").concat(c," )"),s,t):e.format("".concat(l," ").concat(n," ").concat(c),s,t):void 0}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const ew=yy(Z_,"+"),tw=yy(Z_,"-"),nw=yy(Z_,"*"),iw=yy(Z_,"/"),rw=yy(Z_,"%"),sw=yy(Z_,"=="),aw=yy(Z_,"!="),ow=yy(Z_,"<"),lw=yy(Z_,">"),cw=yy(Z_,"<="),uw=yy(Z_,">="),hw=yy(Z_,"&&"),dw=yy(Z_,"||"),pw=yy(Z_,"!"),fw=yy(Z_,"^^"),mw=yy(Z_,"&"),gw=yy(Z_,"~"),vw=yy(Z_,"|"),yw=yy(Z_,"^"),_w=yy(Z_,"<<"),ww=yy(Z_,">>");Wv("add",ew),Wv("sub",tw),Wv("mul",nw),Wv("div",iw),Wv("remainder",rw),Wv("equal",sw),Wv("notEqual",aw),Wv("lessThan",ow),Wv("greaterThan",lw),Wv("lessThanEqual",cw),Wv("greaterThanEqual",uw),Wv("and",hw),Wv("or",dw),Wv("not",pw),Wv("xor",fw),Wv("bitAnd",mw),Wv("bitNot",gw),Wv("bitOr",vw),Wv("bitXor",yw),Wv("shiftLeft",_w),Wv("shiftRight",ww),Mv("OperatorNode",Z_);class xw extends Av{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(),this.method=e,this.aNode=t,this.bNode=n,this.cNode=i}getInputType(e){const t=this.aNode.getNodeType(e),n=this.bNode?this.bNode.getNodeType(e):null,i=this.cNode?this.cNode.getNodeType(e):null,r=e.isMatrix(t)?0:e.getTypeLength(t),s=e.isMatrix(n)?0:e.getTypeLength(n),a=e.isMatrix(i)?0:e.getTypeLength(i);return r>s&&r>a?t:s>a?n:a>r?i:t}getNodeType(e){const t=this.method;return t===xw.LENGTH||t===xw.DISTANCE||t===xw.DOT?"float":t===xw.CROSS?"vec3":t===xw.ALL?"bool":t===xw.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):t===xw.MOD?this.aNode.getNodeType(e):this.getInputType(e)}generate(e,t){const n=this.method,i=this.getNodeType(e),r=this.getInputType(e),s=this.aNode,a=this.bNode,o=this.cNode,l=!0===e.renderer.isWebGLRenderer;if(n===xw.TRANSFORM_DIRECTION){let n=s,i=a;e.isMatrix(n.getNodeType(e))?i=Oy(Py(i),0):n=Oy(Py(n),0);const r=nw(n,i).xyz;return Bw(r).build(e,t)}if(n===xw.NEGATE)return e.format("( - "+s.build(e,r)+" )",i,t);if(n===xw.ONE_MINUS)return tw(1,s).build(e,t);if(n===xw.RECIPROCAL)return iw(1,s).build(e,t);if(n===xw.DIFFERENCE)return Ww(tw(s,a)).build(e,t);{const c=[];return n===xw.CROSS||n===xw.MOD?c.push(s.build(e,i),a.build(e,i)):n===xw.STEP?c.push(s.build(e,1===e.getTypeLength(s.getNodeType(e))?"float":r),a.build(e,r)):l&&(n===xw.MIN||n===xw.MAX)||n===xw.MOD?c.push(s.build(e,r),a.build(e,1===e.getTypeLength(a.getNodeType(e))?"float":r)):n===xw.REFRACT?c.push(s.build(e,r),a.build(e,r),o.build(e,"float")):n===xw.MIX?c.push(s.build(e,r),a.build(e,r),o.build(e,1===e.getTypeLength(o.getNodeType(e))?"float":r)):(c.push(s.build(e,r)),null!==a&&c.push(a.build(e,r)),null!==o&&c.push(o.build(e,r))),e.format("".concat(e.getMethod(n,i),"( ").concat(c.join(", ")," )"),i,t)}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}xw.ALL="all",xw.ANY="any",xw.EQUALS="equals",xw.RADIANS="radians",xw.DEGREES="degrees",xw.EXP="exp",xw.EXP2="exp2",xw.LOG="log",xw.LOG2="log2",xw.SQRT="sqrt",xw.INVERSE_SQRT="inversesqrt",xw.FLOOR="floor",xw.CEIL="ceil",xw.NORMALIZE="normalize",xw.FRACT="fract",xw.SIN="sin",xw.COS="cos",xw.TAN="tan",xw.ASIN="asin",xw.ACOS="acos",xw.ATAN="atan",xw.ABS="abs",xw.SIGN="sign",xw.LENGTH="length",xw.NEGATE="negate",xw.ONE_MINUS="oneMinus",xw.DFDX="dFdx",xw.DFDY="dFdy",xw.ROUND="round",xw.RECIPROCAL="reciprocal",xw.TRUNC="trunc",xw.FWIDTH="fwidth",xw.BITCAST="bitcast",xw.ATAN2="atan2",xw.MIN="min",xw.MAX="max",xw.MOD="mod",xw.STEP="step",xw.REFLECT="reflect",xw.DISTANCE="distance",xw.DIFFERENCE="difference",xw.DOT="dot",xw.CROSS="cross",xw.POW="pow",xw.TRANSFORM_DIRECTION="transformDirection",xw.MIX="mix",xw.CLAMP="clamp",xw.REFRACT="refract",xw.SMOOTHSTEP="smoothstep",xw.FACEFORWARD="faceforward";const bw=Ny(1e-6),Sw=(Ny(1e6),Ny(Math.PI)),Nw=(Ny(2*Math.PI),yy(xw,xw.ALL)),Mw=yy(xw,xw.ANY),Tw=yy(xw,xw.EQUALS),Aw=yy(xw,xw.RADIANS),Ew=yy(xw,xw.DEGREES),Cw=yy(xw,xw.EXP),Iw=yy(xw,xw.EXP2),Rw=yy(xw,xw.LOG),Pw=yy(xw,xw.LOG2),Dw=yy(xw,xw.SQRT),kw=yy(xw,xw.INVERSE_SQRT),Lw=yy(xw,xw.FLOOR),Ow=yy(xw,xw.CEIL),Bw=yy(xw,xw.NORMALIZE),Uw=yy(xw,xw.FRACT),zw=yy(xw,xw.SIN),Vw=yy(xw,xw.COS),Fw=yy(xw,xw.TAN),jw=yy(xw,xw.ASIN),Hw=yy(xw,xw.ACOS),Gw=yy(xw,xw.ATAN),Ww=yy(xw,xw.ABS),Yw=yy(xw,xw.SIGN),qw=yy(xw,xw.LENGTH),Xw=yy(xw,xw.NEGATE),Kw=yy(xw,xw.ONE_MINUS),Jw=yy(xw,xw.DFDX),$w=yy(xw,xw.DFDY),Qw=yy(xw,xw.ROUND),Zw=yy(xw,xw.RECIPROCAL),ex=yy(xw,xw.TRUNC),tx=yy(xw,xw.FWIDTH),nx=(yy(xw,xw.BITCAST),yy(xw,xw.ATAN2)),ix=yy(xw,xw.MIN),rx=yy(xw,xw.MAX),sx=yy(xw,xw.MOD),ax=yy(xw,xw.STEP),ox=yy(xw,xw.REFLECT),lx=yy(xw,xw.DISTANCE),cx=yy(xw,xw.DIFFERENCE),ux=yy(xw,xw.DOT),hx=yy(xw,xw.CROSS),dx=yy(xw,xw.POW),px=yy(xw,xw.POW,2),fx=yy(xw,xw.POW,3),mx=yy(xw,xw.POW,4),gx=yy(xw,xw.TRANSFORM_DIRECTION),vx=yy(xw,xw.MIX),yx=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return my(new xw(xw.CLAMP,my(e),my(t),my(n)))},_x=yy(xw,xw.REFRACT),wx=yy(xw,xw.SMOOTHSTEP),xx=yy(xw,xw.FACEFORWARD);Wv("all",Nw),Wv("any",Mw),Wv("equals",Tw),Wv("radians",Aw),Wv("degrees",Ew),Wv("exp",Cw),Wv("exp2",Iw),Wv("log",Rw),Wv("log2",Pw),Wv("sqrt",Dw),Wv("inverseSqrt",kw),Wv("floor",Lw),Wv("ceil",Ow),Wv("normalize",Bw),Wv("fract",Uw),Wv("sin",zw),Wv("cos",Vw),Wv("tan",Fw),Wv("asin",jw),Wv("acos",Hw),Wv("atan",Gw),Wv("abs",Ww),Wv("sign",Yw),Wv("length",qw),Wv("lengthSq",(e=>ux(e,e))),Wv("negate",Xw),Wv("oneMinus",Kw),Wv("dFdx",Jw),Wv("dFdy",$w),Wv("round",Qw),Wv("reciprocal",Zw),Wv("trunc",ex),Wv("fwidth",tx),Wv("atan2",nx),Wv("min",ix),Wv("max",rx),Wv("mod",sx),Wv("step",ax),Wv("reflect",ox),Wv("distance",lx),Wv("dot",ux),Wv("cross",hx),Wv("pow",dx),Wv("pow2",px),Wv("pow3",fx),Wv("pow4",mx),Wv("transformDirection",gx),Wv("mix",((e,t,n)=>vx(t,n,e))),Wv("clamp",yx),Wv("refract",_x),Wv("smoothstep",((e,t,n)=>wx(t,n,e))),Wv("faceForward",xx),Wv("difference",cx),Wv("saturate",(e=>yx(e))),Wv("cbrt",(e=>nw(Yw(e),dx(Ww(e),1/3)))),Mv("MathNode",xw);const bx=wy((e=>{const{value:t}=e,{rgb:n}=t,i=n.mul(.9478672986).add(.0521327014).pow(2.4),r=n.mul(.0773993808),s=n.lessThanEqual(.04045),a=vx(i,r,s);return Oy(a,t.a)})),Sx=wy((e=>{const{value:t}=e,{rgb:n}=t,i=n.pow(.41666).mul(1.055).sub(.055),r=n.mul(12.92),s=n.lessThanEqual(.0031308),a=vx(i,r,s);return Oy(a,t.a)})),Nx=e=>{let t=null;return e===Ud?t="Linear":e===Bd&&(t="sRGB"),t},Mx=(e,t)=>Nx(e)+"To"+Nx(t);class Tx extends Av{constructor(e,t){super("vec4"),this.method=e,this.node=t}setup(){const{method:e,node:t}=this;return e===Tx.LINEAR_TO_LINEAR?t:Ax[e]({value:t})}}Tx.LINEAR_TO_LINEAR="LinearToLinear",Tx.LINEAR_TO_sRGB="LinearTosRGB",Tx.sRGB_TO_LINEAR="sRGBToLinear";const Ax={[Tx.LINEAR_TO_sRGB]:Sx,[Tx.sRGB_TO_LINEAR]:bx},Ex=(e,t)=>my(new Tx(Mx(t,Ud),my(e))),Cx=yy(Tx,Tx.LINEAR_TO_sRGB),Ix=yy(Tx,Tx.sRGB_TO_LINEAR);Wv("linearTosRGB",Cx),Wv("sRGBToLinear",Ix),Wv("linearToColorSpace",((e,t)=>my(new Tx(Mx(Ud,t),my(e))))),Wv("colorSpaceToLinear",Ex),Mv("ColorSpaceNode",Tx);class Rx extends Nv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";super(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"void"),this.snippet=e}generate(e,t){const n=this.getNodeType(e),i=this.snippet;if("void"!==n)return e.format("( ".concat(i," )"),n,t);e.addLineFlowCode(i)}}const Px=yy(Rx);Mv("ExpressionNode",Rx);class Dx extends q_{constructor(e){super(0),this.textureNode=e,this.updateType=td}get texture(){return this.textureNode.value}update(){const e=this.texture,t=e.images,n=t&&t.length>0?t[0]&&t[0].image||t[0]:e.image;if(n&&void 0!==n.width){const{width:e,height:t}=n;this.value=Math.log2(Math.max(e,t))}}}const kx=yy(Dx);Mv("MaxMipLevelNode",Dx);class Lx extends q_{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(e),this.isTextureNode=!0,this.uvNode=t,this.levelNode=n,this.compareNode=null,this.depthNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=ed,this.referenceNode=null,this._value=e,this.setUpdateMatrix(null===t)}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return!0===this.value.isDepthTexture?"float":"vec4"}getInputType(){return"texture"}getDefaultUV(){return J_(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){const t=this.value;return X_(t.matrix).mul(Py(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this.updateType=e?td:ed,this}setupUV(e,t){const n=this.value;return!e.isFlipY()||!0!==n.isRenderTargetTexture&&!0!==n.isFramebufferTexture&&!0!==n.isDepthTexture||(t=t.setY(t.y.oneMinus())),t}setup(e){const t=e.getNodeProperties(this);let n=this.uvNode;null!==n&&!0!==e.context.forceUVContext||!e.context.getUV||(n=e.context.getUV(this)),n||(n=this.getDefaultUV()),!0===this.updateMatrix&&(n=this.getTransformedUV(n)),n=this.setupUV(e,n);let i=this.levelNode;null===i&&e.context.getTextureLevel&&(i=e.context.getTextureLevel(this)),t.uvNode=n,t.levelNode=i,t.compareNode=this.compareNode,t.depthNode=this.depthNode}generateUV(e,t){return t.build(e,!0===this.sampler?"vec2":"ivec2")}generateSnippet(e,t,n,i,r,s){const a=this.value;let o;return o=i?e.generateTextureLevel(a,t,n,i,r):s?e.generateTextureCompare(a,t,n,s,r):!1===this.sampler?e.generateTextureLoad(a,t,n,r):e.generateTexture(a,t,n,r),o}generate(e,t){const n=e.getNodeProperties(this),i=this.value;if(!i||!0!==i.isTexture)throw new Error("TextureNode: Need a three.js texture.");const r=super.generate(e,"property");if("sampler"===t)return r+"_sampler";if(e.isReference(t))return r;{const s=e.getDataFromNode(this);let a=s.propertyName;if(void 0===a){const{uvNode:t,levelNode:i,compareNode:o,depthNode:l}=n,c=this.generateUV(e,t),u=i?i.build(e,"float"):null,h=l?l.build(e,"int"):null,d=o?o.build(e,"float"):null,p=e.getVarFromNode(this);a=e.getPropertyName(p);const f=this.generateSnippet(e,r,c,u,h,d);e.addLineFlowCode("".concat(a," = ").concat(f)),!1!==e.context.tempWrite&&(s.snippet=f,s.propertyName=a)}let o=a;const l=this.getNodeType(e);return e.needsColorSpaceToLinear(i)&&(o=Ex(Px(o,l),i.colorSpace).setup(e).build(e,l)),e.format(o,l,t)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}uv(e){const t=this.clone();return t.uvNode=e,t.referenceNode=this,my(t)}blur(e){const t=this.clone();return t.levelNode=e.mul(kx(t)),t.referenceNode=this,my(t)}level(e){const t=this.clone();return t.levelNode=e,t.referenceNode=this,t}size(e){return Q_(this,e)}compare(e){const t=this.clone();return t.compareNode=my(e),t.referenceNode=this,my(t)}depth(e){const t=this.clone();return t.depthNode=my(e),t.referenceNode=this,my(t)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value]}update(){const e=this.value;!0===e.matrixAutoUpdate&&e.updateMatrix()}clone(){const e=new this.constructor(this.value,this.uvNode,this.levelNode);return e.sampler=this.sampler,e}}const Ox=Lx,Bx=yy(Lx),Ux=function(){return Bx(...arguments).setSampler(!1)};Wv("texture",Bx),Mv("TextureNode",Lx);class zx extends q_{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferCount=n}getInputType(){return"buffer"}}const Vx=zx,Fx=(e,t,n)=>my(new zx(e,t,n));Mv("BufferNode",zx);class jx extends Cv{constructor(e,t){super(e,t),this.isArrayBufferElementNode=!0}getNodeType(e){return this.node.getElementType(e)}generate(e){const t=super.generate(e),n=this.getNodeType();return e.format(t,"vec4",n)}}class Hx extends Vx{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null,"vec4"),this.array=e,this.elementType=t,this._elementType=null,this._elementLength=0,this.updateType=nd,this.isArrayBufferNode=!0}getElementType(){return this.elementType||this._elementType}getElementLength(){return this._elementLength}update(){const{array:e,value:t}=this,n=this.getElementLength(),i=this.getElementType();if(1===n)for(let r=0;r<e.length;r++){t[4*r]=e[r]}else if("color"===i)for(let r=0;r<e.length;r++){const n=4*r,i=e[r];t[n]=i.r,t[n+1]=i.g,t[n+2]=i.b||0}else for(let r=0;r<e.length;r++){const n=4*r,i=e[r];t[n]=i.x,t[n+1]=i.y,t[n+2]=i.z||0,t[n+3]=i.w||0}}setup(e){const t=this.array.length;return this._elementType=null===this.elementType?yv(this.array[0]):this.elementType,this._elementLength=e.getTypeLength(this._elementType),this.value=new Float32Array(4*t),this.bufferCount=t,super.setup(e)}element(e){return my(new jx(this,my(e)))}}const Gx=(e,t)=>my(new Hx(e,t));Mv("UniformsNode",Hx);class Wx extends Cv{constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),n=this.referenceNode.getNodeType(),i=this.getNodeType();return e.format(t,n,i)}}class Yx extends Nv{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(),this.property=e,this.uniformType=t,this.object=n,this.count=i,this.properties=e.split("."),this.reference=null,this.node=null,this.updateType=id}element(e){return my(new Wx(this,my(e)))}setNodeType(e){let t=null;t=null!==this.count?Fx(null,e,this.count):Array.isArray(this.getValueFromReference())?Gx(null,e):"texture"===e?Bx(null):X_(null,e),this.node=t}getNodeType(e){return this.node.getNodeType(e)}getValueFromReference(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.reference;const{properties:t}=this;let n=e[t[0]];for(let i=1;i<t.length;i++)n=n[t[i]];return n}updateReference(e){return this.reference=null!==this.object?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){null===this.node&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const qx=Yx,Xx=(e,t,n)=>my(new Yx(e,t,n));Mv("ReferenceNode",Yx);class Kx extends qx{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(e,t,n),this.material=n}updateReference(e){return this.reference=null!==this.material?this.material:e.material,this.reference}}Mv("MaterialReferenceNode",Kx);class Jx extends Nv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jx.VIEW_MATRIX,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(),this.scope=e,this.object3d=t,this.updateType=id,this._uniformNode=new q_(null)}getNodeType(){const e=this.scope;return e===Jx.WORLD_MATRIX||e===Jx.VIEW_MATRIX?"mat4":e===Jx.NORMAL_MATRIX?"mat3":e===Jx.POSITION||e===Jx.VIEW_POSITION||e===Jx.DIRECTION||e===Jx.SCALE?"vec3":void 0}update(e){const t=this.object3d,n=this._uniformNode,i=this.scope;if(i===Jx.VIEW_MATRIX)n.value=t.modelViewMatrix;else if(i===Jx.NORMAL_MATRIX)n.value=t.normalMatrix;else if(i===Jx.WORLD_MATRIX)n.value=t.matrixWorld;else if(i===Jx.POSITION)n.value=n.value||new Dp,n.value.setFromMatrixPosition(t.matrixWorld);else if(i===Jx.SCALE)n.value=n.value||new Dp,n.value.setFromMatrixScale(t.matrixWorld);else if(i===Jx.DIRECTION)n.value=n.value||new Dp,t.getWorldDirection(n.value);else if(i===Jx.VIEW_POSITION){const i=e.camera;n.value=n.value||new Dp,n.value.setFromMatrixPosition(t.matrixWorld),n.value.applyMatrix4(i.matrixWorldInverse)}}generate(e){const t=this.scope;return t===Jx.WORLD_MATRIX||t===Jx.VIEW_MATRIX?this._uniformNode.nodeType="mat4":t===Jx.NORMAL_MATRIX?this._uniformNode.nodeType="mat3":t!==Jx.POSITION&&t!==Jx.VIEW_POSITION&&t!==Jx.DIRECTION&&t!==Jx.SCALE||(this._uniformNode.nodeType="vec3"),this._uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}Jx.VIEW_MATRIX="viewMatrix",Jx.NORMAL_MATRIX="normalMatrix",Jx.WORLD_MATRIX="worldMatrix",Jx.POSITION="position",Jx.SCALE="scale",Jx.VIEW_POSITION="viewPosition",Jx.DIRECTION="direction";const $x=Jx,Qx=(yy(Jx,Jx.DIRECTION),yy(Jx,Jx.VIEW_MATRIX),yy(Jx,Jx.NORMAL_MATRIX),yy(Jx,Jx.WORLD_MATRIX),yy(Jx,Jx.POSITION)),Zx=(yy(Jx,Jx.SCALE),yy(Jx,Jx.VIEW_POSITION));Mv("Object3DNode",Jx);class eb extends $x{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:eb.POSITION),this.updateType=nd}getNodeType(e){const t=this.scope;return t===eb.PROJECTION_MATRIX||t===eb.PROJECTION_MATRIX_INVERSE?"mat4":t===eb.NEAR||t===eb.FAR||t===eb.LOG_DEPTH?"float":super.getNodeType(e)}update(e){const t=e.camera,n=this._uniformNode,i=this.scope;i===eb.VIEW_MATRIX?n.value=t.matrixWorldInverse:i===eb.PROJECTION_MATRIX?n.value=t.projectionMatrix:i===eb.PROJECTION_MATRIX_INVERSE?n.value=t.projectionMatrixInverse:i===eb.NEAR?n.value=t.near:i===eb.FAR?n.value=t.far:i===eb.LOG_DEPTH?n.value=2/(Math.log(t.far+1)/Math.LN2):(this.object3d=t,super.update(e))}generate(e){const t=this.scope;return t===eb.PROJECTION_MATRIX||t===eb.PROJECTION_MATRIX_INVERSE?this._uniformNode.nodeType="mat4":t!==eb.NEAR&&t!==eb.FAR&&t!==eb.LOG_DEPTH||(this._uniformNode.nodeType="float"),super.generate(e)}}eb.PROJECTION_MATRIX="projectionMatrix",eb.PROJECTION_MATRIX_INVERSE="projectionMatrixInverse",eb.NEAR="near",eb.FAR="far",eb.LOG_DEPTH="logDepth";const tb=_y(eb,eb.PROJECTION_MATRIX),nb=(_y(eb,eb.PROJECTION_MATRIX_INVERSE),_y(eb,eb.NEAR)),ib=_y(eb,eb.FAR),rb=_y(eb,eb.LOG_DEPTH),sb=_y(eb,eb.VIEW_MATRIX);_y(eb,eb.NORMAL_MATRIX),_y(eb,eb.WORLD_MATRIX),_y(eb,eb.POSITION);Mv("CameraNode",eb);class ab extends $x{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:ab.VIEW_MATRIX)}update(e){this.object3d=e.object,super.update(e)}}_y(ab,ab.DIRECTION);const ob=_y(ab,ab.VIEW_MATRIX).label("modelViewMatrix").temp("ModelViewMatrix"),lb=_y(ab,ab.NORMAL_MATRIX),cb=_y(ab,ab.WORLD_MATRIX);_y(ab,ab.POSITION),_y(ab,ab.SCALE),_y(ab,ab.VIEW_POSITION);Mv("ModelNode",ab);class ub extends Nv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ub.LOCAL;super("vec3"),this.scope=e}isGlobal(){return!0}getHash(){return"normal-".concat(this.scope)}generate(e){const t=this.scope;let n=null;if(t===ub.GEOMETRY){n=!1===e.hasGeometryAttribute("normal")?Py(0,1,0):r_("normal","vec3")}else if(t===ub.LOCAL)n=t_(hb);else if(t===ub.VIEW){const e=lb.mul(db);n=Bw(t_(e))}else if(t===ub.WORLD){const e=pb.transformDirection(sb);n=Bw(t_(e))}return n.build(e,this.getNodeType(e))}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}ub.GEOMETRY="geometry",ub.LOCAL="local",ub.VIEW="view",ub.WORLD="world";const hb=_y(ub,ub.GEOMETRY),db=_y(ub,ub.LOCAL).temp("Normal"),pb=_y(ub,ub.VIEW),fb=_y(ub,ub.WORLD),mb=b_("vec3","TransformedNormalView"),gb=mb.transformDirection(sb).normalize(),vb=b_("vec3","TransformedClearcoatNormalView");Mv("NormalNode",ub);const yb=new Map;class _b extends Nv{constructor(e){super(),this.scope=e}getCache(e,t){let n=yb.get(e);return void 0===n&&(n=((e,t,n)=>my(new Kx(e,t,n)))(e,t),yb.set(e,n)),n}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache("map"===e?"map":e+"Map","texture")}setup(e){const t=e.context.material,n=this.scope;let i=null;if(n===_b.COLOR){const e=this.getColor(n);i=t.map&&!0===t.map.isTexture?e.mul(this.getTexture("map")):e}else if(n===_b.OPACITY){const e=this.getFloat(n);i=t.alphaMap&&!0===t.alphaMap.isTexture?e.mul(this.getTexture("alpha")):e}else if(n===_b.SPECULAR_STRENGTH)i=t.specularMap&&!0===t.specularMap.isTexture?this.getTexture(n).r:Ny(1);else if(n===_b.ROUGHNESS){const e=this.getFloat(n);i=t.roughnessMap&&!0===t.roughnessMap.isTexture?e.mul(this.getTexture(n).g):e}else if(n===_b.METALNESS){const e=this.getFloat(n);i=t.metalnessMap&&!0===t.metalnessMap.isTexture?e.mul(this.getTexture(n).b):e}else if(n===_b.EMISSIVE){const e=this.getColor(n);i=t.emissiveMap&&!0===t.emissiveMap.isTexture?e.mul(this.getTexture(n)):e}else if(n===_b.NORMAL)i=t.normalMap?this.getTexture("normal").normalMap(this.getCache("normalScale","vec2")):t.bumpMap?this.getTexture("bump").r.bumpMap(this.getFloat("bumpScale")):pb;else if(n===_b.CLEARCOAT){const e=this.getFloat(n);i=t.clearcoatMap&&!0===t.clearcoatMap.isTexture?e.mul(this.getTexture(n).r):e}else if(n===_b.CLEARCOAT_ROUGHNESS){const e=this.getFloat(n);i=t.clearcoatRoughnessMap&&!0===t.clearcoatRoughnessMap.isTexture?e.mul(this.getTexture(n).r):e}else if(n===_b.CLEARCOAT_NORMAL)i=t.clearcoatNormalMap?this.getTexture(n).normalMap(this.getCache(n+"Scale","vec2")):pb;else if(n===_b.SHEEN){const e=this.getColor("sheenColor").mul(this.getFloat("sheen"));i=t.sheenColorMap&&!0===t.sheenColorMap.isTexture?e.mul(this.getTexture("sheenColor").rgb):e}else if(n===_b.SHEEN_ROUGHNESS){const e=this.getFloat(n);i=t.sheenRoughnessMap&&!0===t.sheenRoughnessMap.isTexture?e.mul(this.getTexture(n).a):e,i=i.clamp(.07,1)}else if(n===_b.IRIDESCENCE_THICKNESS){const e=Xx("1","float",t.iridescenceThicknessRange);if(t.iridescenceThicknessMap){const r=Xx("0","float",t.iridescenceThicknessRange);i=e.sub(r).mul(this.getTexture(n).g).add(r)}else i=e}else{const t=this.getNodeType(e);i=this.getCache(n,t)}return i}}_b.ALPHA_TEST="alphaTest",_b.COLOR="color",_b.OPACITY="opacity",_b.SHININESS="shininess",_b.SPECULAR_COLOR="specular",_b.SPECULAR_STRENGTH="specularStrength",_b.REFLECTIVITY="reflectivity",_b.ROUGHNESS="roughness",_b.METALNESS="metalness",_b.NORMAL="normal",_b.CLEARCOAT="clearcoat",_b.CLEARCOAT_ROUGHNESS="clearcoatRoughness",_b.CLEARCOAT_NORMAL="clearcoatNormal",_b.EMISSIVE="emissive",_b.ROTATION="rotation",_b.SHEEN="sheen",_b.SHEEN_ROUGHNESS="sheenRoughness",_b.IRIDESCENCE="iridescence",_b.IRIDESCENCE_IOR="iridescenceIOR",_b.IRIDESCENCE_THICKNESS="iridescenceThickness",_b.LINE_SCALE="scale",_b.LINE_DASH_SIZE="dashSize",_b.LINE_GAP_SIZE="gapSize",_b.LINE_WIDTH="linewidth",_b.LINE_DASH_OFFSET="dashOffset",_b.POINT_WIDTH="pointWidth";const wb=_y(_b,_b.ALPHA_TEST),xb=_y(_b,_b.COLOR),bb=_y(_b,_b.SHININESS),Sb=_y(_b,_b.EMISSIVE),Nb=_y(_b,_b.OPACITY),Mb=_y(_b,_b.SPECULAR_COLOR),Tb=_y(_b,_b.SPECULAR_STRENGTH),Ab=(_y(_b,_b.REFLECTIVITY),_y(_b,_b.ROUGHNESS)),Eb=_y(_b,_b.METALNESS),Cb=_y(_b,_b.NORMAL),Ib=_y(_b,_b.CLEARCOAT),Rb=_y(_b,_b.CLEARCOAT_ROUGHNESS),Pb=_y(_b,_b.CLEARCOAT_NORMAL),Db=_y(_b,_b.ROTATION),kb=_y(_b,_b.SHEEN),Lb=_y(_b,_b.SHEEN_ROUGHNESS),Ob=_y(_b,_b.IRIDESCENCE),Bb=_y(_b,_b.IRIDESCENCE_IOR),Ub=_y(_b,_b.IRIDESCENCE_THICKNESS),zb=_y(_b,_b.LINE_SCALE),Vb=_y(_b,_b.LINE_DASH_SIZE),Fb=_y(_b,_b.LINE_GAP_SIZE),jb=_y(_b,_b.LINE_WIDTH),Hb=_y(_b,_b.LINE_DASH_OFFSET),Gb=_y(_b,_b.POINT_WIDTH);Mv("MaterialNode",_b);class Wb extends Nv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wb.LOCAL;super("vec3"),this.scope=e}isGlobal(){return!0}getHash(){return"position-".concat(this.scope)}generate(e){const t=this.scope;let n=null;if(t===Wb.GEOMETRY)n=r_("position","vec3");else if(t===Wb.LOCAL)n=t_(Yb);else if(t===Wb.WORLD){const e=cb.mul(qb);n=t_(e)}else if(t===Wb.VIEW){const e=ob.mul(qb);n=t_(e)}else if(t===Wb.VIEW_DIRECTION){const e=Jb.negate();n=Bw(t_(e))}else if(t===Wb.WORLD_DIRECTION){const e=qb.transformDirection(cb);n=Bw(t_(e))}return n.build(e,this.getNodeType(e))}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}Wb.GEOMETRY="geometry",Wb.LOCAL="local",Wb.WORLD="world",Wb.WORLD_DIRECTION="worldDirection",Wb.VIEW="view",Wb.VIEW_DIRECTION="viewDirection";const Yb=_y(Wb,Wb.GEOMETRY),qb=_y(Wb,Wb.LOCAL).temp("Position"),Xb=_y(Wb,Wb.WORLD),Kb=_y(Wb,Wb.WORLD_DIRECTION),Jb=_y(Wb,Wb.VIEW),$b=_y(Wb,Wb.VIEW_DIRECTION);Mv("PositionNode",Wb);class Qb extends Av{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super("vec4"),this.positionNode=e}setup(e){if("fragment"===e.shaderStage)return t_(e.context.mvp);const t=this.positionNode||qb;return tb.mul(ob).mul(t)}}const Zb=yy(Qb);Mv("ModelViewProjectionNode",Qb);class eS extends Vv{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferStride=n,this.bufferOffset=i,this.usage=Yd,this.instanced=!1,this.attribute=null,e&&!0===e.isBufferAttribute&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}getNodeType(e){return null===this.bufferType&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(null!==this.attribute)return;const t=this.getNodeType(e),n=this.value,i=e.getTypeLength(t),r=this.bufferStride||i,s=this.bufferOffset,a=!0===n.isInterleavedBuffer?n:new ag(n,r),o=new lg(a,i,s);a.setUsage(this.usage),this.attribute=o,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){const t=this.getNodeType(e),n=e.getBufferAttributeFromNode(this,t),i=e.getPropertyName(n);let r=null;if("vertex"===e.shaderStage||"compute"===e.shaderStage)this.name=i,r=i;else{r=t_(this).build(e,t)}return r}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this}setInstanced(e){return this.instanced=e,this}}const tS=(e,t,n,i)=>my(new eS(e,t,n,i)),nS=(e,t,n,i)=>tS(e,t,n,i).setInstanced(!0),iS=(e,t,n,i)=>((e,t,n,i)=>tS(e,t,n,i).setUsage(qd))(e,t,n,i).setInstanced(!0);Wv("toAttribute",(e=>tS(e.value))),Mv("BufferAttributeNode",eS);class rS extends Nv{constructor(e){super("void"),this.instanceMesh=e,this.instanceMatrixNode=null,this.instanceColorNode=null}setup(){let e=this.instanceMatrixNode;const t=this.instanceMesh;if(null===e){const n=t.instanceMatrix,i=new mv(n.array,16,1),r=n.usage===qd?iS:nS,s=[r(i,"vec4",16,0),r(i,"vec4",16,4),r(i,"vec4",16,8),r(i,"vec4",16,12)];e=Xy(...s),this.instanceMatrixNode=e}const n=t.instanceColor;if(n&&null===this.instanceColorNode){const e=new ug(n.array,3),t=n.usage===qd?iS:nS;this.instanceColorNode=Py(t(e,"vec3",3,0))}const i=e.mul(qb).xyz,r=Gy(e[0].xyz,e[1].xyz,e[2].xyz),s=db.div(Py(r[0].dot(r[0]),r[1].dot(r[1]),r[2].dot(r[2]))),a=r.mul(s).xyz;qb.assign(i),db.assign(a),null!==this.instanceColorNode&&S_("vec3","vInstanceColor").assign(this.instanceColorNode)}}const sS=yy(rS);Mv("InstanceNode",rS);class aS extends Nv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:aS.LOCAL;super(),this.scope=e}getHash(){return"tangent-".concat(this.scope)}getNodeType(){return this.scope===aS.GEOMETRY?"vec4":"vec3"}generate(e){const t=this.scope;let n=null;if(t===aS.GEOMETRY)n=r_("tangent","vec4"),!1===e.geometry.hasAttribute("tangent")&&e.geometry.computeTangents();else if(t===aS.LOCAL)n=t_(oS.xyz);else if(t===aS.VIEW){const e=ob.mul(Oy(lS,0)).xyz;n=Bw(t_(e))}else if(t===aS.WORLD){const e=cS.transformDirection(sb);n=Bw(t_(e))}return n.build(e,this.getNodeType(e))}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}aS.GEOMETRY="geometry",aS.LOCAL="local",aS.VIEW="view",aS.WORLD="world";const oS=_y(aS,aS.GEOMETRY),lS=_y(aS,aS.LOCAL),cS=_y(aS,aS.VIEW),uS=_y(aS,aS.WORLD),hS=__(cS,"TransformedTangentView");Bw(hS.transformDirection(sb));Mv("TangentNode",aS);class dS extends Nv{constructor(e){super("void"),this.batchMesh=e,this.instanceColorNode=null,this.batchingIdNode=null}setup(e){null===this.batchingIdNode&&(this.batchingIdNode=r_("batchId"));const t=this.batchMesh._matricesTexture,n=Q_(Ux(t),0),i=Ny(My(this.batchingIdNode)).mul(4).toVar(),r=My(i.mod(n)),s=My(i).div(My(n)),a=Xy(Ux(t,Cy(r,s)),Ux(t,Cy(r.add(1),s)),Ux(t,Cy(r.add(2),s)),Ux(t,Cy(r.add(3),s))),o=Gy(a[0].xyz,a[1].xyz,a[2].xyz);qb.assign(a.mul(qb));const l=db.div(Py(o[0].dot(o[0]),o[1].dot(o[1]),o[2].dot(o[2]))),c=o.mul(l).xyz;db.assign(c),e.hasGeometryAttribute("tangent")&&lS.mulAssign(o)}}const pS=yy(dS);Mv("batch",dS);class fS extends Nv{constructor(e){let t,n,i,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super("void"),this.skinnedMesh=e,this.useReference=r,this.updateType=id,this.skinIndexNode=r_("skinIndex","uvec4"),this.skinWeightNode=r_("skinWeight","vec4"),r?(t=Xx("bindMatrix","mat4"),n=Xx("bindMatrixInverse","mat4"),i=((e,t,n,i)=>my(new Yx(e,t,i,n)))("skeleton.boneMatrices","mat4",e.skeleton.bones.length)):(t=X_(e.bindMatrix,"mat4"),n=X_(e.bindMatrixInverse,"mat4"),i=Fx(e.skeleton.boneMatrices,"mat4",e.skeleton.bones.length)),this.bindMatrixNode=t,this.bindMatrixInverseNode=n,this.boneMatricesNode=i}setup(e){const{skinIndexNode:t,skinWeightNode:n,bindMatrixNode:i,bindMatrixInverseNode:r,boneMatricesNode:s}=this,a=s.element(t.x),o=s.element(t.y),l=s.element(t.z),c=s.element(t.w),u=i.mul(qb),h=ew(a.mul(n.x).mul(u),o.mul(n.y).mul(u),l.mul(n.z).mul(u),c.mul(n.w).mul(u)),d=r.mul(h).xyz;let p=ew(n.x.mul(a),n.y.mul(o),n.z.mul(l),n.w.mul(c));p=r.mul(p).mul(i);const f=p.transformDirection(db).xyz;qb.assign(d),db.assign(f),e.hasGeometryAttribute("tangent")&&lS.assign(f)}generate(e,t){if("void"!==t)return qb.build(e,t)}update(e){(this.useReference?e.object:this.skinnedMesh).skeleton.update()}}Mv("SkinningNode",fS);class mS extends Nv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.params=e}getVarName(e){return String.fromCharCode("i".charCodeAt()+e)}getProperties(e){const t=e.getNodeProperties(this);if(void 0!==t.stackNode)return t;const n={};for(let i=0,r=this.params.length-1;i<r;i++){const e=this.params[i],t=!0!==e.isNode&&e.name||this.getVarName(i),r=!0!==e.isNode&&e.type||"int";n[t]=Px(t,r)}return t.returnsNode=this.params[this.params.length-1](n,e.addStack(),e),t.stackNode=e.removeStack(),t}getNodeType(e){const{returnsNode:t}=this.getProperties(e);return t?t.getNodeType(e):"void"}setup(e){this.getProperties(e)}generate(e){const t=this.getProperties(e),n=this.params,i=t.stackNode;for(let a=0,o=n.length-1;a<o;a++){const t=n[a];let i=null,r=null,s=null,o=null,l=null,c=null;t.isNode?(o="int",s=this.getVarName(a),i="0",r=t.build(e,o),l="<"):(o=t.type||"int",s=t.name||this.getVarName(a),i=t.start,r=t.end,l=t.condition,c=t.update,"number"===typeof i?i=i.toString():i&&i.isNode&&(i=i.build(e,o)),"number"===typeof r?r=r.toString():r&&r.isNode&&(r=r.build(e,o)),void 0!==i&&void 0===r?(i+=" - 1",r="0",l=">="):void 0!==r&&void 0===i&&(i="0",l="<"),void 0===l&&(l=Number(i)>Number(r)?">=":"<"));const u={start:i,end:r,condition:l},h=u.start,d=u.end;let p="",f="",m="";c||(c="int"===o||"uint"===o?l.includes("<")?"++":"--":l.includes("<")?"+= 1.":"-= 1."),p+=e.getVar(o,s)+" = "+h,f+=s+" "+l+" "+d,m+=s+" "+c;const g="for ( ".concat(p,"; ").concat(f,"; ").concat(m," )");e.addFlowCode((0===a?"\n":"")+e.tab+g+" {\n\n").addFlowTab()}const r=p_(i,{tempWrite:!1}).build(e,"void"),s=t.returnsNode?t.returnsNode.build(e):"";e.removeFlowTab().addFlowCode("\n"+e.tab+r);for(let a=0,o=this.params.length-1;a<o;a++)e.addFlowCode((0===a?"":e.tab)+"}\n\n").removeFlowTab();return e.addFlowTab(),s}}const gS=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return my(new mS(vy(t,"int"))).append()};Wv("loop",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return a_(e,gS(...n))})),Mv("LoopNode",mS);const vS=new WeakMap,yS=new Cp,_S=wy((e=>{let{bufferMap:t,influence:n,stride:i,width:r,depth:s,offset:a}=e;const o=My(m_).mul(i).add(a),l=o.div(r),c=o.sub(l.mul(r));return Ux(t,Cy(c,l)).depth(s).mul(n)}));class wS extends Nv{constructor(e){super("void"),this.mesh=e,this.morphBaseInfluence=X_(1),this.updateType=id}setup(e){const{geometry:t}=e,n=void 0!==t.morphAttributes.position,i=void 0!==t.morphAttributes.normal,r=t.morphAttributes.position||t.morphAttributes.normal||t.morphAttributes.color,s=void 0!==r?r.length:0,{texture:a,stride:o,size:l}=function(e){const t=void 0!==e.morphAttributes.position,n=void 0!==e.morphAttributes.normal,i=void 0!==e.morphAttributes.color,r=e.morphAttributes.position||e.morphAttributes.normal||e.morphAttributes.color,s=void 0!==r?r.length:0;let a=vS.get(e);if(void 0===a||a.count!==s){void 0!==a&&a.texture.dispose();const o=e.morphAttributes.position||[],l=e.morphAttributes.normal||[],c=e.morphAttributes.color||[];let u=0;!0===t&&(u=1),!0===n&&(u=2),!0===i&&(u=3);let h=e.attributes.position.count*u,d=1;const p=4096;h>p&&(d=Math.ceil(h/p),h=p);const f=new Float32Array(h*d*4*s),m=new Rp(f,h,d,s);m.type=Nd,m.needsUpdate=!0;const g=4*u;for(let y=0;y<s;y++){const _=o[y],w=l[y],x=c[y],b=h*d*4*y;for(let S=0;S<_.count;S++){const N=S*g;!0===t&&(yS.fromBufferAttribute(_,S),f[b+N+0]=yS.x,f[b+N+1]=yS.y,f[b+N+2]=yS.z,f[b+N+3]=0),!0===n&&(yS.fromBufferAttribute(w,S),f[b+N+4]=yS.x,f[b+N+5]=yS.y,f[b+N+6]=yS.z,f[b+N+7]=0),!0===i&&(yS.fromBufferAttribute(x,S),f[b+N+8]=yS.x,f[b+N+9]=yS.y,f[b+N+10]=yS.z,f[b+N+11]=4===x.itemSize?yS.w:1)}}function v(){m.dispose(),vS.delete(e),e.removeEventListener("dispose",v)}a={count:s,texture:m,stride:u,size:new lp(h,d)},vS.set(e,a),e.addEventListener("dispose",v)}return a}(t);!0===n&&qb.mulAssign(this.morphBaseInfluence),!0===i&&db.mulAssign(this.morphBaseInfluence);const c=My(l.width);gS(s,(e=>{let{i:t}=e;const r=Ny(0).toVar();!0===this.mesh.isInstancedMesh&&null!==this.mesh.morphTexture&&void 0!==this.mesh.morphTexture?r.assign(Ux(this.mesh.morphTexture,Cy(My(t).add(1),My(g_))).r):r.assign(Xx("morphTargetInfluences","float").element(t).toVar()),!0===n&&qb.addAssign(_S({bufferMap:a,influence:r,stride:o,width:c,depth:t,offset:My(0)})),!0===i&&db.addAssign(_S({bufferMap:a,influence:r,stride:o,width:c,depth:t,offset:My(1)}))}))}update(){const e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce(((e,t)=>e+t),0)}}const xS=yy(wS);Mv("MorphNode",wS);class bS extends Nv{constructor(){super("vec3")}getHash(){return"reflectVector"}setup(){return $b.negate().reflect(mb).transformDirection(sb)}}const SS=_y(bS);Mv("ReflectVectorNode",bS);class NS extends Ox{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null),this.isCubeTextureNode=!0}getInputType(){return"cubeTexture"}getDefaultUV(){return SS}setUpdateMatrix(){}setupUV(e,t){const n=this.value;return e.renderer.coordinateSystem!==Kd&&n.isRenderTargetTexture?t:Py(t.x.negate(),t.yz)}generateUV(e,t){return t.build(e,"vec3")}}const MS=yy(NS);Wv("cubeTexture",MS),Mv("CubeTextureNode",NS);class TS extends Nv{constructor(){super("vec3")}generate(){console.warn("Abstract function.")}}const AS=TS;Mv("LightingNode",TS);let ES=null;class CS extends AS{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.updateType=td,this.light=e,this.rtt=null,this.shadowNode=null,this.color=new Zf,this._defaultColorNode=X_(this.color),this.colorNode=this._defaultColorNode,this.isAnalyticLightNode=!0}getCacheKey(){return super.getCacheKey()+"-"+this.light.id+"-"+(this.light.castShadow?"1":"0")}getHash(){return this.light.uuid}setupShadow(e){let t=this.shadowNode;if(null===t){null===ES&&(ES=e.createNodeMaterial(),ES.fragmentNode=Oy(0,0,0,1),ES.isShadowNodeMaterial=!0);const n=this.light.shadow,i=e.createRenderTarget(n.mapSize.width,n.mapSize.height),r=new ng;r.minFilter=_d,r.magFilter=_d,r.image.width=n.mapSize.width,r.image.height=n.mapSize.height,r.compareFunction=513,i.depthTexture=r,n.camera.updateProjectionMatrix();const s=Xx("bias","float",n),a=Xx("normalBias","float",n);let o=X_(n.matrix).mul(Xb.add(fb.mul(a)));o=o.xyz.div(o.w);const l=o.x.greaterThanEqual(0).and(o.x.lessThanEqual(1)).and(o.y.greaterThanEqual(0)).and(o.y.lessThanEqual(1)).and(o.z.lessThanEqual(1));let c=o.z.add(s);e.renderer.coordinateSystem===Kd&&(c=c.mul(2).sub(1)),o=Py(o.x,o.y.oneMinus(),c);const u=(e,t,n)=>Bx(e,t).compare(n);t=u(r,o.xy,o.z);const h=Bx(i.texture,o);this.rtt=i,this.colorNode=this.colorNode.mul(l.mix(1,t.mix(h.a.mix(1,h),1))),this.shadowNode=t,this.updateBeforeType=nd}}setup(e){this.light.castShadow?this.setupShadow(e):null!==this.shadowNode&&this.disposeShadow()}updateShadow(e){const{rtt:t,light:n}=this,{renderer:i,scene:r}=e,s=r.overrideMaterial;r.overrideMaterial=ES,t.setSize(n.shadow.mapSize.width,n.shadow.mapSize.height),n.shadow.updateMatrices(n);const a=i.getRenderTarget(),o=i.getRenderObjectFunction();i.setRenderObjectFunction((function(e){if(!0===e.castShadow){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];i.renderObject(e,...n)}})),i.setRenderTarget(t),i.render(r,n.shadow.camera),i.setRenderTarget(a),i.setRenderObjectFunction(o),r.overrideMaterial=s}disposeShadow(){this.rtt.dispose(),this.shadowNode=null,this.rtt=null,this.colorNode=this._defaultColorNode}updateBefore(e){const{light:t}=this;t.castShadow&&this.updateShadow(e)}update(){const{light:e}=this;this.color.copy(e.color).multiplyScalar(e.intensity)}}const IS=CS;Mv("AnalyticLightNode",CS);const RS=new WeakMap;class PS extends Nv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super("vec3"),this.totalDiffuseNode=Py().temp("totalDiffuse"),this.totalSpecularNode=Py().temp("totalSpecular"),this.outgoingLightNode=Py().temp("outgoingLight"),this.lightNodes=e,this._hash=null}get hasLight(){return this.lightNodes.length>0}getHash(){if(null===this._hash){const e=[];for(const t of this.lightNodes)e.push(t.getHash());this._hash="lights-"+e.join(",")}return this._hash}setup(e){const t=e.context,n=t.lightingModel;let i=this.outgoingLightNode;if(n){const{lightNodes:r,totalDiffuseNode:s,totalSpecularNode:a}=this;t.outgoingLight=i;const o=e.addStack();n.start(t,o,e);for(const t of r)t.build(e);n.indirectDiffuse(t,o,e),n.indirectSpecular(t,o,e),n.ambientOcclusion(t,o,e);const{backdrop:l,backdropAlpha:c}=t,{directDiffuse:u,directSpecular:h,indirectDiffuse:d,indirectSpecular:p}=t.reflectedLight;let f=u.add(d);null!==l&&(f=Py(null!==c?c.mix(f,l):l)),s.assign(f),a.assign(h.add(p)),i.assign(s.add(a)),n.finish(t,o,e),i=i.bypass(e.removeStack())}return i}_getLightNodeById(e){for(const t of this.lightNodes)if(t.isAnalyticLightNode&&t.light.id===e)return t;return null}fromLights(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=[];e=(e=>e.sort(((e,t)=>e.id-t.id)))(e);for(const n of e){let e=this._getLightNodeById(n.id);if(null===e){const t=n.constructor,i=RS.has(t)?RS.get(t):IS;e=my(new i(n))}t.push(e)}return this.lightNodes=t,this._hash=null,this}}const DS=yy(PS);function kS(e,t){if(RS.has(e))console.warn("Redefinition of light node ".concat(t.type));else{if("function"!==typeof e)throw new Error("Light ".concat(e.name," is not a class"));if("function"!==typeof t||!t.type)throw new Error("Light node ".concat(t.type," is not a class"));RS.set(e,t)}}class LS extends AS{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.aoNode=e}setup(e){const t=this.aoNode.x.sub(1).mul(1).add(1);e.context.ambientOcclusion.mulAssign(t)}}const OS=LS;Mv("AONode",LS);class BS extends d_{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(e),this.lightingModel=t,this.backdropNode=n,this.backdropAlphaNode=i,this._context=null}getContext(){const{backdropNode:e,backdropAlphaNode:t}=this,n={directDiffuse:Py().temp("directDiffuse"),directSpecular:Py().temp("directSpecular"),indirectDiffuse:Py().temp("indirectDiffuse"),indirectSpecular:Py().temp("indirectSpecular")};return{radiance:Py().temp("radiance"),irradiance:Py().temp("irradiance"),iblIrradiance:Py().temp("iblIrradiance"),ambientOcclusion:Ny(1).temp("ambientOcclusion"),reflectedLight:n,backdrop:e,backdropAlpha:t}}setup(e){return this.context=this._context||(this._context=this.getContext()),this.context.lightingModel=this.lightingModel||e.context.lightingModel,super.setup(e)}}const US=yy(BS);Wv("lightingContext",US),Mv("LightingContextNode",BS);class zS extends Nv{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(),this.condNode=e,this.ifNode=t,this.elseNode=n}getNodeType(e){const t=this.ifNode.getNodeType(e);if(null!==this.elseNode){const n=this.elseNode.getNodeType(e);if(e.getTypeLength(n)>e.getTypeLength(t))return n}return t}generate(e,t){const n=this.getNodeType(e),i={tempWrite:!1},r=e.getDataFromNode(this);if(void 0!==r.nodeProperty)return r.nodeProperty;const{ifNode:s,elseNode:a}=this,o="void"!==t,l=o?b_(n).build(e):"";r.nodeProperty=l;const c=p_(this.condNode).build(e,"bool");e.addFlowCode("\n".concat(e.tab,"if ( ").concat(c," ) {\n\n")).addFlowTab();let u=p_(s,i).build(e,n);if(u&&(u=o?l+" = "+u+";":"return "+u+";"),e.removeFlowTab().addFlowCode(e.tab+"\t"+u+"\n\n"+e.tab+"}"),null!==a){e.addFlowCode(" else {\n\n").addFlowTab();let t=p_(a,i).build(e,n);t&&(t=o?l+" = "+t+";":"return "+t+";"),e.removeFlowTab().addFlowCode(e.tab+"\t"+t+"\n\n"+e.tab+"}\n\n")}else e.addFlowCode("\n\n");return e.format(l,n,t)}}const VS=zS,FS=yy(zS);Wv("cond",FS),Mv("CondNode",zS);const jS=Ny(1),HS=Ny(-2),GS=Ny(.8),WS=Ny(-1),YS=Ny(.4),qS=Ny(2),XS=Ny(.305),KS=Ny(3),JS=Ny(.21),$S=Ny(4),QS=Ny(4),ZS=Ny(16),eN=wy((e=>{let[t]=e;const n=Py(Ww(t)).toVar(),i=Ny(-1).toVar();return by(n.x.greaterThan(n.z),(()=>{by(n.x.greaterThan(n.y),(()=>{i.assign(FS(t.x.greaterThan(0),0,3))})).else((()=>{i.assign(FS(t.y.greaterThan(0),1,4))}))})).else((()=>{by(n.z.greaterThan(n.y),(()=>{i.assign(FS(t.z.greaterThan(0),2,5))})).else((()=>{i.assign(FS(t.y.greaterThan(0),1,4))}))})),i})).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),tN=wy((e=>{let[t,n]=e;const i=Ey().toVar();return by(n.equal(0),(()=>{i.assign(Ey(t.z,t.y).div(Ww(t.x)))})).elseif(n.equal(1),(()=>{i.assign(Ey(t.x.negate(),t.z.negate()).div(Ww(t.y)))})).elseif(n.equal(2),(()=>{i.assign(Ey(t.x.negate(),t.y).div(Ww(t.z)))})).elseif(n.equal(3),(()=>{i.assign(Ey(t.z.negate(),t.y).div(Ww(t.x)))})).elseif(n.equal(4),(()=>{i.assign(Ey(t.x.negate(),t.z).div(Ww(t.y)))})).else((()=>{i.assign(Ey(t.x,t.y).div(Ww(t.z)))})),nw(.5,i.add(1))})).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),nN=wy((e=>{let[t]=e;const n=Ny(0).toVar();return by(t.greaterThanEqual(GS),(()=>{n.assign(jS.sub(t).mul(WS.sub(HS)).div(jS.sub(GS)).add(HS))})).elseif(t.greaterThanEqual(YS),(()=>{n.assign(GS.sub(t).mul(qS.sub(WS)).div(GS.sub(YS)).add(WS))})).elseif(t.greaterThanEqual(XS),(()=>{n.assign(YS.sub(t).mul(KS.sub(qS)).div(YS.sub(XS)).add(qS))})).elseif(t.greaterThanEqual(JS),(()=>{n.assign(XS.sub(t).mul($S.sub(KS)).div(XS.sub(JS)).add(KS))})).else((()=>{n.assign(Ny(-2).mul(Pw(nw(1.16,t))))})),n})).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),iN=(wy((e=>{let[t,n]=e;const i=t.toVar();i.assign(nw(2,i).sub(1));const r=Py(i,1).toVar();return by(n.equal(0),(()=>{r.assign(r.zyx)})).elseif(n.equal(1),(()=>{r.assign(r.xzy),r.xz.mulAssign(-1)})).elseif(n.equal(2),(()=>{r.x.mulAssign(-1)})).elseif(n.equal(3),(()=>{r.assign(r.zyx),r.xz.mulAssign(-1)})).elseif(n.equal(4),(()=>{r.assign(r.xzy),r.xy.mulAssign(-1)})).elseif(n.equal(5),(()=>{r.z.mulAssign(-1)})),r})).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),wy((e=>{let[t,n,i,r,s,a]=e;const o=Ny(i),l=Py(n),c=yx(nN(o),HS,a),u=Uw(c),h=Lw(c),d=Py(rN(t,l,h,r,s,a)).toVar();return by(u.notEqual(0),(()=>{const e=Py(rN(t,l,h.add(1),r,s,a)).toVar();d.assign(vx(d,e,u))})),d}))),rN=wy((e=>{let[t,n,i,r,s,a]=e;const o=Ny(i).toVar(),l=Py(n),c=Ny(eN(l)).toVar(),u=Ny(rx(QS.sub(o),0)).toVar();o.assign(rx(o,QS));const h=Ny(Iw(o)).toVar(),d=Ey(tN(l,c).mul(h.sub(2)).add(1)).toVar();return by(c.greaterThan(2),(()=>{d.y.addAssign(h),c.subAssign(3)})),d.x.addAssign(c.mul(h)),d.x.addAssign(u.mul(nw(3,ZS))),d.y.addAssign(nw(4,Iw(a).sub(h))),d.x.mulAssign(r),d.y.mulAssign(s),t.uv(d)})),sN=wy((e=>{let{envMap:t,mipInt:n,outputDirection:i,theta:r,axis:s,CUBEUV_TEXEL_WIDTH:a,CUBEUV_TEXEL_HEIGHT:o,CUBEUV_MAX_MIP:l}=e;const c=Vw(r),u=i.mul(c).add(s.cross(i).mul(zw(r))).add(s.mul(s.dot(i).mul(c.oneMinus())));return rN(t,u,n,a,o,l)}));wy((e=>{let{n:t,latitudinal:n,poleAxis:i,outputDirection:r,weights:s,samples:a,dTheta:o,mipInt:l,envMap:c,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:d}=e;const p=Py(FS(n,i,hx(i,r))).toVar();by(Nw(p.equals(Py(0))),(()=>{p.assign(Py(r.z,0,r.x.negate()))})),p.assign(Bw(p));const f=Py().toVar();return f.addAssign(s.element(My(0)).mul(sN({theta:0,axis:p,outputDirection:r,mipInt:l,envMap:c,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:d}))),gS({start:My(1),end:t},(e=>{let{i:t}=e;by(t.greaterThanEqual(a),(()=>{Px("break").append()}));const n=Ny(o.mul(Ny(t))).toVar();f.addAssign(s.element(t).mul(sN({theta:n.mul(-1),axis:p,outputDirection:r,mipInt:l,envMap:c,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:d}))),f.addAssign(s.element(t).mul(sN({theta:n,axis:p,outputDirection:r,mipInt:l,envMap:c,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:d})))})),Oy(f,1)}));let aN=null;const oN=new WeakMap;class lN extends Av{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super("vec3"),this._value=e,this._pmrem=null,this.uvNode=t,this.levelNode=n,this._generator=null,this._texture=Bx(null),this._width=X_(0),this._height=X_(0),this._maxMip=X_(0),this.updateBeforeType=nd}set value(e){this._value=e,this._pmrem=null}get value(){return this._value}updateFromTexture(e){const t=function(e){const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}(e.image.height);this._texture.value=e,this._width.value=t.texelWidth,this._height.value=t.texelHeight,this._maxMip.value=t.maxMip}updateBefore(){let e=this._pmrem;const t=e?e.pmremVersion:-1,n=this._value;t!==n.pmremVersion&&(e=!0===n.isPMREMTexture?n:function(e){let t=oN.get(e);if((void 0!==t?t.pmremVersion:-1)!==e.pmremVersion){if(e.isCubeTexture){if(e.source.data.some((e=>void 0===e)))throw new Error("PMREMNode: Undefined texture in CubeTexture. Use onLoad callback or async loader");t=aN.fromCubemap(e,t)}else{if(void 0===e.image)throw new Error("PMREMNode: Undefined image in Texture. Use onLoad callback or async loader");t=aN.fromEquirectangular(e,t)}t.pmremVersion=e.pmremVersion,oN.set(e,t)}return t.texture}(n),this._pmrem=e,this.updateFromTexture(e))}setup(e){null===aN&&(aN=e.createPMREMGenerator()),this.updateBefore(e);let t=this.uvNode;null===t&&e.context.getUV&&(t=e.context.getUV(this));const n=this.value;e.renderer.coordinateSystem===Xd&&!0!==n.isPMREMTexture&&!0===n.isRenderTargetTexture&&(t=Py(t.x.negate(),t.yz));let i=this.levelNode;return null===i&&e.context.getTextureLevel&&(i=e.context.getTextureLevel(this)),iN(this._texture,t,i,this._width,this._height,this._maxMip)}}const cN=yy(lN);Mv("PMREMNode",lN);const uN=new WeakMap;class hN extends AS{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.envNode=e}setup(e){let t=this.envNode;if(t.isTextureNode){let e=uN.get(t.value);void 0===e&&(e=cN(t.value),uN.set(t.value,e)),t=e}const n=e.material.envMap?Xx("envMapIntensity","float",e.material):Xx("environmentIntensity","float",e.scene),i=p_(t,dN(M_,mb)).mul(n),r=p_(t,pN(gb)).mul(Math.PI).mul(n),s=u_(i);e.context.radiance.addAssign(s),e.context.iblIrradiance.addAssign(r);const a=e.context.lightingModel.clearcoatRadiance;if(a){const e=p_(t,dN(E_,vb)).mul(n),i=u_(e);a.addAssign(i)}}}const dN=(e,t)=>{let n=null;return{getUV:()=>(null===n&&(n=$b.negate().reflect(t),n=e.mul(e).mix(n,t).normalize(),n=n.transformDirection(sb)),n),getTextureLevel:()=>e}},pN=e=>({getUV:()=>e,getTextureLevel:()=>Ny(1)}),fN=hN;let mN,gN;Mv("EnvironmentNode",hN);class vN extends Nv{constructor(e){super(),this.scope=e,this.isViewportNode=!0}getNodeType(){return this.scope===vN.VIEWPORT?"vec4":"vec2"}getUpdateType(){let e=ed;return this.scope!==vN.RESOLUTION&&this.scope!==vN.VIEWPORT||(e=td),this.updateType=e,e}update(e){let{renderer:t}=e;this.scope===vN.VIEWPORT?t.getViewport(gN):t.getDrawingBufferSize(mN)}setup(){const e=this.scope;let t=null;if(e===vN.RESOLUTION)t=X_(mN||(mN=new lp));else if(e===vN.VIEWPORT)t=X_(gN||(gN=new Cp));else{t=yN.div(_N);let n=t.x,i=t.y;/bottom/i.test(e)&&(i=i.oneMinus()),/right/i.test(e)&&(n=n.oneMinus()),t=Ey(n,i)}return t}generate(e){if(this.scope===vN.COORDINATE){let t=e.getFragCoord();if(e.isFlipY()){const n=e.getNodeProperties(_N).outputNode.build(e);t="".concat(e.getType("vec2"),"( ").concat(t,".x, ").concat(n,".y - ").concat(t,".y )")}return t}return super.generate(e)}}vN.COORDINATE="coordinate",vN.RESOLUTION="resolution",vN.VIEWPORT="viewport",vN.TOP_LEFT="topLeft",vN.BOTTOM_LEFT="bottomLeft",vN.TOP_RIGHT="topRight",vN.BOTTOM_RIGHT="bottomRight";const yN=_y(vN,vN.COORDINATE),_N=_y(vN,vN.RESOLUTION),wN=_y(vN,vN.VIEWPORT),xN=_y(vN,vN.TOP_LEFT);_y(vN,vN.BOTTOM_LEFT),_y(vN,vN.TOP_RIGHT),_y(vN,vN.BOTTOM_RIGHT);Mv("ViewportNode",vN);const bN=new lp;class SN extends Ox{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xN,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===n&&(n=new pg,n.minFilter=xd),super(n,e,t),this.generateMipmaps=!1,this.isOutputTextureNode=!0,this.updateBeforeType=td}updateBefore(e){const t=e.renderer;t.getDrawingBufferSize(bN);const n=this.value;n.image.width===bN.width&&n.image.height===bN.height||(n.image.width=bN.width,n.image.height=bN.height,n.needsUpdate=!0);const i=n.generateMipmaps;n.generateMipmaps=this.generateMipmaps,t.copyFramebufferToTexture(n),n.generateMipmaps=i}clone(){return new this.constructor(this.uvNode,this.levelNode,this.value)}}const NN=SN,MN=yy(SN),TN=yy(SN,null,null,{generateMipmaps:!0});Wv("viewportTexture",MN),Wv("viewportMipTexture",TN),Mv("ViewportTextureNode",SN);let AN=null;class EN extends NN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xN,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null===AN&&(AN=new ng),super(e,t,AN)}}const CN=yy(EN);Wv("viewportDepthTexture",CN),Mv("ViewportDepthTextureNode",EN);class IN extends Nv{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super("float"),this.scope=e,this.valueNode=t,this.isViewportDepthNode=!0}generate(e){const{scope:t}=this;return t===IN.DEPTH_PIXEL?e.getFragDepth():super.generate(e)}setup(){const{scope:e}=this;let t=null;if(e===IN.DEPTH)t=RN(Jb.z,nb,ib);else if(e===IN.DEPTH_TEXTURE){const e=this.valueNode||CN(),n=PN(e,nb,ib);t=RN(n,nb,ib)}else e===IN.DEPTH_PIXEL&&null!==this.valueNode&&(t=DN().assign(this.valueNode));return t}}const RN=(e,t,n)=>e.add(t).div(t.sub(n)),PN=(e,t,n)=>t.mul(n).div(n.sub(t).mul(e).sub(n));IN.DEPTH="depth",IN.DEPTH_TEXTURE="depthTexture",IN.DEPTH_PIXEL="depthPixel";const DN=yy(IN,IN.DEPTH_PIXEL),kN=(_y(IN,IN.DEPTH),yy(IN,IN.DEPTH_TEXTURE),_y(IN,IN.DEPTH_PIXEL));kN.assign=e=>DN(e),Mv("ViewportDepthNode",IN);class LN extends Nv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:LN.DEFAULT;super(),this.scope=e}setup(e){super.setup(e);const t=e.clippingContext,{localClipIntersection:n,localClippingCount:i,globalClippingCount:r}=t,s=r+i,a=n?s-i:s;return this.scope===LN.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(t.planes,s,a):this.setupDefault(t.planes,s,a)}setupAlphaToCoverage(e,t,n){return wy((()=>{const i=Gx(e),r=b_("float","distanceToPlane"),s=b_("float","distanceToGradient"),a=b_("float","clipOpacity");let o;if(a.assign(1),gS(n,(e=>{let{i:t}=e;o=i.element(t),r.assign(Jb.dot(o.xyz).negate().add(o.w)),s.assign(r.fwidth().div(2)),a.mulAssign(wx(s.negate(),s,r)),a.equal(0).discard()})),n<t){const e=b_("float","unionclipOpacity");e.assign(1),gS({start:n,end:t},(t=>{let{i:n}=t;o=i.element(n),r.assign(Jb.dot(o.xyz).negate().add(o.w)),s.assign(r.fwidth().div(2)),e.mulAssign(wx(s.negate(),s,r).oneMinus())})),a.mulAssign(e.oneMinus())}N_.a.mulAssign(a),N_.a.equal(0).discard()}))()}setupDefault(e,t,n){return wy((()=>{const i=Gx(e);let r;if(gS(n,(e=>{let{i:t}=e;r=i.element(t),Jb.dot(r.xyz).greaterThan(r.w).discard()})),n<t){const e=b_("bool","clipped");e.assign(!0),gS({start:n,end:t},(t=>{let{i:n}=t;r=i.element(n),e.assign(Jb.dot(r.xyz).greaterThan(r.w).and(e))})),e.discard()}}))()}}LN.ALPHA_TO_COVERAGE="alphaToCoverage",LN.DEFAULT="default";class ON extends Nv{constructor(){super("bool"),this.isFrontFacingNode=!0}generate(e){return e.getFrontFacing()}}const BN=_y(ON),UN=Ny(BN).mul(2).sub(1);Mv("FrontFacingNode",ON);const zN=new Map;class VN extends zm{constructor(){super(),this.isNodeMaterial=!0,this.type=this.constructor.type,this.forceSinglePass=!1,this.fog=!0,this.lights=!0,this.normals=!0,this.colorSpaced=!0,this.lightsNode=null,this.envNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.positionNode=null,this.depthNode=null,this.shadowNode=null,this.outputNode=null,this.fragmentNode=null,this.vertexNode=null}customProgramCacheKey(){return this.type+gv(this)}build(e){this.setup(e)}setup(e){let t;e.addStack(),e.stack.outputNode=this.vertexNode||this.setupPosition(e),e.addFlow("vertex",e.removeStack()),e.addStack();const n=this.setupClipping(e);if(null===this.fragmentNode){!0===this.depthWrite&&this.setupDepth(e),!0===this.normals&&this.setupNormal(e),this.setupDiffuseColor(e),this.setupVariants(e);const i=this.setupLighting(e);null!==n&&e.stack.add(n);const r=Oy(i,N_.a).max(0);t=this.setupOutput(e,r),O_.assign(t),null!==this.outputNode&&(t=this.outputNode)}else t=this.setupOutput(e,this.fragmentNode);e.stack.outputNode=t,e.addFlow("fragment",e.removeStack())}setupClipping(e){const{globalClippingCount:t,localClippingCount:n}=e.clippingContext;let i=null;return(t||n)&&(this.alphaToCoverage?i=my(new LN(LN.ALPHA_TO_COVERAGE)):e.stack.add(my(new LN))),i}setupDepth(e){const{renderer:t}=e;let n=this.depthNode;if(null===n&&!0===t.logarithmicDepthBuffer){n=Zb().w.add(1).log2().mul(rb).mul(.5)}null!==n&&kN.assign(n).append()}setupPosition(e){const{object:t}=e,n=t.geometry;var i;e.addStack(),(n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color)&&xS(t).append(),!0===t.isSkinnedMesh&&(i=t,my(new fS(i,!0))).append(),t.isBatchedMesh&&pS(t).append(),t.instanceMatrix&&!0===t.instanceMatrix.isInstancedBufferAttribute&&!0===e.isAvailable("instance")&&sS(t).append(),null!==this.positionNode&&qb.assign(this.positionNode);const r=Zb();return e.context.vertex=e.removeStack(),e.context.mvp=r,r}setupDiffuseColor(e){let{object:t,geometry:n}=e,i=this.colorNode?Oy(this.colorNode):xb;if(!0===this.vertexColors&&n.hasAttribute("color")&&(i=Oy(i.xyz.mul(r_("color","vec3")),i.a)),t.instanceColor){i=S_("vec3","vInstanceColor").mul(i)}N_.assign(i);const r=this.opacityNode?Ny(this.opacityNode):Nb;if(N_.a.assign(N_.a.mul(r)),null!==this.alphaTestNode||this.alphaTest>0){const e=null!==this.alphaTestNode?Ny(this.alphaTestNode):wb;N_.a.lessThanEqual(e).discard()}}setupVariants(){}setupNormal(){if(!0===this.flatShading){const e=Jb.dFdx().cross(Jb.dFdy()).normalize();mb.assign(e.mul(UN))}else{const e=this.normalNode?Py(this.normalNode):Cb;mb.assign(e.mul(UN))}}getEnvNode(e){let t=null;return this.envNode?t=this.envNode:this.envMap?t=this.envMap.isCubeTexture?MS(this.envMap):Bx(this.envMap):e.environmentNode&&(t=e.environmentNode),t}setupLights(e){const t=this.getEnvNode(e),n=[];t&&n.push(new fN(t)),e.material.aoMap&&n.push(new OS(Bx(e.material.aoMap)));let i=this.lightsNode||e.lightsNode;return n.length>0&&(i=DS([...i.lightNodes,...n])),i}setupLightingModel(){}setupLighting(e){const{material:t}=e,{backdropNode:n,backdropAlphaNode:i,emissiveNode:r}=this,s=!0===this.lights||null!==this.lightsNode?this.setupLights(e):null;let a=N_.rgb;if(s&&!1!==s.hasLight){const t=this.setupLightingModel(e);a=US(s,t,n,i)}else null!==n&&(a=Py(null!==i?vx(a,n,i):n));return(r&&!0===r.isNode||t.emissive&&!0===t.emissive.isColor)&&(a=a.add(Py(r||Sb))),a}setupOutput(e,t){const n=e.renderer;if(!0===this.fog){const n=e.fogNode;n&&(t=Oy(n.mix(t.rgb,n.colorNode),t.a))}const i=e.toneMappingNode;if(!0===this.toneMapped&&i&&(t=Oy(i.context({color:t.rgb}),t.a)),!0===this.colorSpaced){const e=n.currentColorSpace;e!==Ud&&e!==Od&&(t=t.linearToColorSpace(e))}return t}setDefaultValues(e){for(const n in e){const t=e[n];void 0===this[n]&&(this[n]=t,t&&t.clone&&(this[n]=t.clone()))}Object.assign(this.defines,e.defines);const t=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(const n in t)void 0===Object.getOwnPropertyDescriptor(this.constructor.prototype,n)&&void 0!==t[n].get&&Object.defineProperty(this.constructor.prototype,n,t[n])}toJSON(e){const t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{},nodes:{}});const n=nm.prototype.toJSON.call(this,e),i=vv(this);n.inputNodes={};for(const{property:s,childNode:a}of i)n.inputNodes[s]=a.toJSON(e).uuid;function r(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}if(t){const t=r(e.textures),i=r(e.images),s=r(e.nodes);t.length>0&&(n.textures=t),i.length>0&&(n.images=i),s.length>0&&(n.nodes=s)}return n}copy(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.positionNode=e.positionNode,this.depthNode=e.depthNode,this.shadowNode=e.shadowNode,this.outputNode=e.outputNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,super.copy(e)}static fromMaterial(e){if(!0===e.isNodeMaterial)return e;const t=HN(e.type.replace("Material","NodeMaterial"));if(void 0===t)throw new Error('NodeMaterial: Material "'.concat(e.type,'" is not compatible.'));for(const n in e)t[n]=e[n];return t}}const FN=VN;function jN(e,t){if("function"!==typeof t||!e)throw new Error("Node material ".concat(e," is not a class"));zN.has(e)?console.warn("Redefinition of node material ".concat(e)):(zN.set(e,t),t.type=e)}function HN(e){const t=zN.get(e);if(void 0!==t)return new t}jN("NodeMaterial",VN);class GN extends Nv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.nodes=[],this.outputNode=null,this.parent=e,this._currentCond=null,this.isStackNode=!0}getNodeType(e){return this.outputNode?this.outputNode.getNodeType(e):"void"}add(e){return this.nodes.push(e),this}if(e,t){const n=new fy(t);return this._currentCond=FS(e,n),this.add(this._currentCond)}elseif(e,t){const n=new fy(t),i=FS(e,n);return this._currentCond.elseNode=i,this._currentCond=i,this}else(e){return this._currentCond.elseNode=new fy(e),this}build(e){const t=Hv;xy(this);for(const s of this.nodes)s.build(e,"void");xy(t);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return this.outputNode?this.outputNode.build(e,...i):super.build(e,...i)}}yy(GN);Mv("StackNode",GN);new class{constructor(){this.weakMap=new WeakMap}get(e){if(Array.isArray(e)){let t=this.weakMap;for(let n=0;n<e.length;n++)if(t=t.get(e[n]),void 0===t)return;return t.get(e[e.length-1])}return super.get(e)}set(e,t){if(Array.isArray(e)){let n=this.weakMap;for(let t=0;t<e.length;t++){const i=e[t];!1===n.has(i)&&n.set(i,new WeakMap),n=n.get(i)}return n.set(e[e.length-1],t)}return super.set(e,t)}delete(e){if(Array.isArray(e)){let t=this.weakMap;for(let n=0;n<e.length;n++)if(t=t.get(e[n]),void 0===t)return!1;return t.delete(e[e.length-1])}return super.delete(e)}dispose(){this.weakMap.clear()}},new Map([[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]);class WN{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.type=e,this.name=t,this.count=n,this.qualifier=i,this.isConst=r}}WN.isNodeFunctionInput=!0;class YN extends Nv{constructor(e){super(),this.types=e,this.isStructTypeNode=!0}getMemberTypes(){return this.types}}const qN=YN;Mv("StructTypeNode",YN);class XN extends Nv{constructor(){super(),this.isOutputStructNode=!0;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.members=t}setup(e){super.setup(e);const t=this.members,n=[];for(let i=0;i<t.length;i++)n.push(t[i].getNodeType(e));this.nodeType=e.getStructTypeFromNode(new qN(n)).name}generate(e,t){const n=e.getVarFromNode(this);n.isOutputStructVar=!0;const i=e.getPropertyName(n),r=this.members,s=""!==i?i+".":"";for(let a=0;a<r.length;a++){const n=r[a].build(e,t);e.addLineFlowCode("".concat(s,"m").concat(a," = ").concat(n))}return i}}yy(XN);Mv("OutputStructNode",XN);class KN extends Nv{constructor(e){super(),this.seedNode=e}setup(){const e=this.seedNode.uint().mul(747796405).add(2891336453),t=e.shiftRight(e.shiftRight(28).add(4)).bitXor(e).mul(277803737);return t.shiftRight(22).bitXor(t).float().mul(1/2**32)}}Wv("hash",yy(KN)),Mv("HashNode",KN);const JN=(e,t)=>dx(nw(4,e.mul(tw(1,e))),t);Wv("parabola",JN),Wv("gain",((e,t)=>e.lessThan(.5)?JN(e.mul(2),t).div(2):tw(1,JN(nw(tw(1,e),2),t).div(2)))),Wv("pcurve",((e,t,n)=>dx(iw(dx(e,t),ew(dx(e,t),dx(tw(1,e),n))),1/t))),Wv("sinc",((e,t)=>zw(Sw.mul(t.mul(e).sub(1))).div(Sw.mul(t.mul(e).sub(1)))));const $N=wy((e=>{let[t]=e;return t.fract().sub(.5).abs()})),QN=wy((e=>{let[t]=e;return Py($N(t.z.add($N(t.y.mul(1)))),$N(t.z.add($N(t.x.mul(1)))),$N(t.y.add($N(t.x.mul(1)))))})),ZN=wy((e=>{let[t,n,i]=e;const r=Py(t).toVar(),s=Ny(1.4).toVar(),a=Ny(0).toVar(),o=Py(r).toVar();return gS({start:Ny(0),end:Ny(3),type:"float",condition:"<="},(()=>{const e=Py(QN(o.mul(2))).toVar();r.addAssign(e.add(i.mul(Ny(.1).mul(n)))),o.mulAssign(1.8),s.mulAssign(1.5),r.mulAssign(1.2);const t=Ny($N(r.z.add($N(r.x.add($N(r.y)))))).toVar();a.addAssign(t.div(s)),o.addAssign(.14)})),a}));let eM;$N.setLayout({name:"tri",type:"float",inputs:[{name:"x",type:"float"}]}),QN.setLayout({name:"tri3",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),ZN.setLayout({name:"triNoise3D",type:"float",inputs:[{name:"p",type:"vec3"},{name:"spd",type:"float"},{name:"time",type:"float"}]});class tM extends VS{constructor(e){eM=eM||Px("discard"),super(e,eM)}}const nM=yy(tM);Wv("discard",(e=>nM(e).append())),Mv("DiscardNode",tM);class iM extends Av{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kb;super("vec2"),this.dirNode=e}setup(){const e=this.dirNode,t=e.z.atan2(e.x).mul(1/(2*Math.PI)).add(.5),n=e.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return Ey(t,n)}}yy(iM);Mv("EquirectUVNode",iM);class rM extends Nv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.functionNodes=e;for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.parametersNodes=n,this._candidateFnCall=null}getNodeType(){return this.functionNodes[0].shaderNode.layout.type}setup(e){const t=this.parametersNodes;let n=this._candidateFnCall;if(null===n){let i=null,r=-1;for(const n of this.functionNodes){const s=n.shaderNode.layout;if(null===s)throw new Error("FunctionOverloadingNode: FunctionNode must be a layout.");const a=s.inputs;if(t.length===a.length){let s=0;for(let n=0;n<t.length;n++){const i=t[n],r=a[n];i.getNodeType(e)===r.type?s++:s=0}s>r&&(i=n,r=s)}}this._candidateFnCall=n=i(...t)}return n}}const sM=yy(rM),aM=e=>function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return sM(e,...n)};Mv("FunctionOverloadingNode",rM);class oM extends Av{constructor(){super("vec2")}setup(){const e=Py($b.z,0,$b.x.negate()).normalize(),t=$b.cross(e);return Ey(e.dot(mb),t.dot(mb)).mul(.495).add(.5)}}_y(oM);Mv("MatcapUVNode",oM);class lM extends q_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lM.LOCAL,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),this.scope=e,this.scale=t,this.updateType=td}update(e){const t=this.scope,n=this.scale;t===lM.LOCAL?this.value+=e.deltaTime*n:t===lM.DELTA?this.value=e.deltaTime*n:t===lM.FRAME?this.value=e.frameId:this.value=e.time*n}serialize(e){super.serialize(e),e.scope=this.scope,e.scale=this.scale}deserialize(e){super.deserialize(e),this.scope=e.scope,this.scale=e.scale}}lM.LOCAL="local",lM.GLOBAL="global",lM.DELTA="delta",lM.FRAME="frame";_y(lM,lM.FRAME).uint();Mv("TimerNode",lM);class cM extends Nv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cM.SINE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return my(new lM(lM.LOCAL,e,t))}();super(),this.method=e,this.timeNode=t}getNodeType(e){return this.timeNode.getNodeType(e)}setup(){const e=this.method,t=my(this.timeNode);let n=null;return e===cM.SINE?n=t.add(.75).mul(2*Math.PI).sin().mul(.5).add(.5):e===cM.SQUARE?n=t.fract().round():e===cM.TRIANGLE?n=t.add(.5).fract().mul(2).sub(1).abs():e===cM.SAWTOOTH&&(n=t.fract()),n}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}cM.SINE="sine",cM.SQUARE="square",cM.TRIANGLE="triangle",cM.SAWTOOTH="sawtooth";yy(cM,cM.SINE),yy(cM,cM.SQUARE),yy(cM,cM.TRIANGLE),yy(cM,cM.SAWTOOTH);Mv("OscNode",cM);class uM extends Av{constructor(e,t){super(),this.scope=e,this.node=t}getNodeType(e){return this.node.getNodeType(e)}setup(){const{scope:e,node:t}=this;let n=null;return e===uM.DIRECTION_TO_COLOR?n=t.mul(.5).add(.5):e===uM.COLOR_TO_DIRECTION&&(n=t.mul(2).sub(1)),n}}uM.DIRECTION_TO_COLOR="directionToColor",uM.COLOR_TO_DIRECTION="colorToDirection";const hM=yy(uM,uM.DIRECTION_TO_COLOR),dM=yy(uM,uM.COLOR_TO_DIRECTION);Wv("directionToColor",hM),Wv("colorToDirection",dM),Mv("PackingNode",uM);class pM extends Nv{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ny(0),r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ny(1);super(),this.node=e,this.inLowNode=t,this.inHighNode=n,this.outLowNode=i,this.outHighNode=r,this.doClamp=!0}setup(){const{node:e,inLowNode:t,inHighNode:n,outLowNode:i,outHighNode:r,doClamp:s}=this;let a=e.sub(t).div(n.sub(t));return!0===s&&(a=a.clamp()),a.mul(r.sub(i)).add(i)}}const fM=yy(pM,null,null,{doClamp:!1}),mM=yy(pM);Wv("remap",fM),Wv("remapClamp",mM),Mv("RemapNode",pM);class gM extends Av{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ey(.5);super("vec2"),this.uvNode=e,this.rotationNode=t,this.centerNode=n}setup(){const{uvNode:e,rotationNode:t,centerNode:n}=this;return e.sub(n).rotate(t).add(n)}}Wv("rotateUV",yy(gM)),Mv("RotateUVNode",gM);class vM extends Av{constructor(e,t){super(),this.positionNode=e,this.rotationNode=t}getNodeType(e){return this.positionNode.getNodeType(e)}setup(e){const{rotationNode:t,positionNode:n}=this;if("vec2"===this.getNodeType(e)){const e=t.cos(),i=t.sin();return Vy(e,i,i.negate(),e).mul(n)}{const e=t,i=Xy(Oy(1,0,0,0),Oy(0,Vw(e.x),zw(e.x).negate(),0),Oy(0,zw(e.x),Vw(e.x),0),Oy(0,0,0,1)),r=Xy(Oy(Vw(e.y),0,zw(e.y),0),Oy(0,1,0,0),Oy(zw(e.y).negate(),0,Vw(e.y),0),Oy(0,0,0,1)),s=Xy(Oy(Vw(e.z),zw(e.z).negate(),0,0),Oy(zw(e.z),Vw(e.z),0,0),Oy(0,0,1,0),Oy(0,0,0,1));return i.mul(r).mul(s).mul(Oy(n,1)).xyz}}}Wv("rotate",yy(vM)),Mv("RotateNode",vM);class yM extends Nv{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:J_(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ny(0);super("vec2"),this.countNode=e,this.uvNode=t,this.frameNode=n}setup(){const{frameNode:e,uvNode:t,countNode:n}=this,{width:i,height:r}=n,s=e.mod(i.mul(r)).floor(),a=s.mod(i),o=r.sub(s.add(1).div(i).ceil()),l=n.reciprocal(),c=Ey(a,o);return t.add(c).mul(l)}}yy(yM);Mv("SpriteSheetUVNode",yM);class _M extends Cv{constructor(e,t){super(e,t),this.isStorageArrayElementNode=!0}set storageBufferNode(e){this.node=e}get storageBufferNode(){return this.node}setup(e){return!1===e.isAvailable("storageBuffer")&&(this.node.instanceIndex||!0!==this.node.bufferObject||e.setupPBO(this.node)),super.setup(e)}generate(e,t){let n;const i=e.context.assign;if(!1===e.isAvailable("storageBuffer")){const{node:t}=this;n=t.instanceIndex||!0!==this.node.bufferObject||!0===i?t.build(e):e.generatePBO(this)}else n=super.generate(e);if(!0!==i){const i=this.getNodeType(e);n=e.format(n,i,t)}return n}}const wM=yy(_M);Wv("storageElement",wM),Mv("StorageArrayElementNode",_M);class xM extends Nv{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ny(1),r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:qb,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:db;super("vec4"),this.textureXNode=e,this.textureYNode=t,this.textureZNode=n,this.scaleNode=i,this.positionNode=r,this.normalNode=s}setup(){const{textureXNode:e,textureYNode:t,textureZNode:n,scaleNode:i,positionNode:r,normalNode:s}=this;let a=s.abs().normalize();a=a.div(a.dot(Py(1)));const o=r.yz.mul(i),l=r.zx.mul(i),c=r.xy.mul(i),u=e.value,h=null!==t?t.value:u,d=null!==n?n.value:u,p=Bx(u,o).mul(a.x),f=Bx(h,l).mul(a.y),m=Bx(d,c).mul(a.z);return ew(p,f,m)}}const bM=yy(xM);Wv("triplanarTexture",(function(){return bM(...arguments)})),Mv("TriplanarTexturesNode",xM);new Xm,new Dp,new Dp,new Dp,new uf,new Dp(0,0,-1),new Cp,new Dp,new Dp,new Cp,new lp,new Ip,Ey(xN.x.oneMinus(),xN.y);class SM extends Nv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:SM.LOCAL;super("vec3"),this.scope=e}getHash(){return"bitangent-".concat(this.scope)}generate(e){const t=this.scope;let n;t===SM.GEOMETRY?n=hb.cross(oS):t===SM.LOCAL?n=db.cross(lS):t===SM.VIEW?n=pb.cross(cS):t===SM.WORLD&&(n=fb.cross(uS));const i=n.mul(oS.w).xyz;return Bw(t_(i)).build(e,this.getNodeType(e))}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}SM.GEOMETRY="geometry",SM.LOCAL="local",SM.VIEW="view",SM.WORLD="world";_y(SM,SM.GEOMETRY),_y(SM,SM.LOCAL);const NM=_y(SM,SM.VIEW),MM=(_y(SM,SM.WORLD),Bw(mb.cross(hS).mul(oS.w)));Bw(MM.transformDirection(sb));Mv("BitangentNode",SM);const TM=Gy(cS,NM,pb);$b.mul(TM);class AM extends i_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;super(null,"vec4"),this.isVertexColorNode=!0,this.index=e}getAttributeName(){const e=this.index;return"color"+(e>0?e:"")}generate(e){const t=this.getAttributeName(e);let n;return n=!0===e.hasGeometryAttribute(t)?super.generate(e):e.generateConst(this.nodeType,new Cp(1,1,1,1)),n}serialize(e){super.serialize(e),e.index=this.index}deserialize(e){super.deserialize(e),this.index=e.index}}Mv("VertexColorNode",AM);class EM extends qx{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(e,t,n),this.renderer=n}updateReference(e){return this.reference=null!==this.renderer?this.renderer:e.renderer,this.reference}}Mv("RendererReferenceNode",EM);const CM=1/6,IM=e=>nw(CM,nw(e,nw(e,e.negate().add(3)).sub(3)).add(1)),RM=e=>nw(CM,nw(e,nw(e,nw(3,e).sub(6))).add(4)),PM=e=>nw(CM,nw(e,nw(e,nw(-3,e).add(3)).add(3)).add(1)),DM=e=>nw(CM,dx(e,3)),kM=e=>IM(e).add(RM(e)),LM=e=>PM(e).add(DM(e)),OM=e=>ew(-1,RM(e).div(IM(e).add(RM(e)))),BM=e=>ew(1,DM(e).div(PM(e).add(DM(e)))),UM=(e,t,n)=>{const i=e.uvNode,r=nw(i,t.zw).add(.5),s=Lw(r),a=Uw(r),o=kM(a.x),l=LM(a.x),c=OM(a.x),u=BM(a.x),h=OM(a.y),d=BM(a.y),p=Ey(s.x.add(c),s.y.add(h)).sub(.5).mul(t.xy),f=Ey(s.x.add(u),s.y.add(h)).sub(.5).mul(t.xy),m=Ey(s.x.add(c),s.y.add(d)).sub(.5).mul(t.xy),g=Ey(s.x.add(u),s.y.add(d)).sub(.5).mul(t.xy),v=kM(a.y).mul(ew(o.mul(e.uv(p).level(n)),l.mul(e.uv(f).level(n)))),y=LM(a.y).mul(ew(o.mul(e.uv(m).level(n)),l.mul(e.uv(g).level(n))));return v.add(y)};class zM extends Av{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ny(3);super("vec4"),this.textureNode=e,this.blurNode=t}setup(){return((e,t)=>{const n=Ey(e.size(My(t))),i=Ey(e.size(My(t.add(1)))),r=iw(1,n),s=iw(1,i),a=UM(e,Oy(r,n),Lw(t)),o=UM(e,Oy(s,i),Ow(t));return Uw(t).mix(a,o)})(this.textureNode,this.blurNode)}}Wv("bicubic",yy(zM)),Mv("TextureBicubicNode",zM);class VM extends Nv{constructor(){super("vec2"),this.isPointUVNode=!0}generate(){return"vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y )"}}_y(VM);Mv("PointUVNode",VM);class FM extends Nv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:FM.BACKGROUND_BLURRINESS,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(),this.scope=e,this.scene=t}setup(e){const t=this.scope,n=null!==this.scene?this.scene:e.scene;let i;return t===FM.BACKGROUND_BLURRINESS?i=Xx("backgroundBlurriness","float",n):t===FM.BACKGROUND_INTENSITY?i=Xx("backgroundIntensity","float",n):console.error("THREE.SceneNode: Unknown scope:",t),i}}FM.BACKGROUND_BLURRINESS="backgroundBlurriness",FM.BACKGROUND_INTENSITY="backgroundIntensity";_y(FM,FM.BACKGROUND_BLURRINESS),_y(FM,FM.BACKGROUND_INTENSITY);Mv("SceneNode",FM);class jM extends Vx{constructor(e,t){super(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),this.isStorageBufferNode=!0,this.bufferObject=!1,this._attribute=null,this._varying=null}getInputType(){return"storageBuffer"}element(e){return wM(this,e)}setBufferObject(e){return this.bufferObject=e,this}generate(e){if(e.isAvailable("storageBuffer"))return super.generate(e);const t=this.getNodeType(e);null===this._attribute&&(this._attribute=tS(this.value),this._varying=t_(this._attribute));const n=this._varying.build(e,t);return e.registerTransform(n,this._attribute),n}}Mv("StorageBufferNode",jM);class HM extends Ox{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(e,t),this.storeNode=n,this.isStoreTextureNode=!0}getInputType(){return"storageTexture"}setup(e){super.setup(e);e.getNodeProperties(this).storeNode=this.storeNode}generate(e,t){let n;return n=null!==this.storeNode?this.generateStore(e):super.generate(e,t),n}generateStore(e){const t=e.getNodeProperties(this),{uvNode:n,storeNode:i}=t,r=super.generate(e,"property"),s=n.build(e,"uvec2"),a=i.build(e,"vec4"),o=e.generateTextureStore(e,r,s,a);e.addLineFlowCode(o)}}yy(HM);Mv("TextureStoreNode",HM);class GM extends qx{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(e,t,n),this.userData=n}update(e){this.reference=null!==this.userData?this.userData:e.object.userData,super.update(e)}}Mv("UserDataNode",GM);const WM=wy((e=>{let{base:t,blend:n}=e;const i=e=>n[e].lessThan(bw).cond(n[e],t[e].oneMinus().div(n[e]).oneMinus().max(0));return Py(i("x"),i("y"),i("z"))})).setLayout({name:"burnColor",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),YM=wy((e=>{let{base:t,blend:n}=e;const i=e=>n[e].equal(1).cond(n[e],t[e].div(n[e].oneMinus()).max(0));return Py(i("x"),i("y"),i("z"))})).setLayout({name:"dodgeColor",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),qM=wy((e=>{let{base:t,blend:n}=e;const i=e=>t[e].oneMinus().mul(n[e].oneMinus()).oneMinus();return Py(i("x"),i("y"),i("z"))})).setLayout({name:"screenColor",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),XM=wy((e=>{let{base:t,blend:n}=e;const i=e=>t[e].lessThan(.5).cond(t[e].mul(n[e],2),t[e].oneMinus().mul(n[e].oneMinus()).oneMinus());return Py(i("x"),i("y"),i("z"))})).setLayout({name:"overlayColor",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]});class KM extends Av{constructor(e,t,n){super(),this.blendMode=e,this.baseNode=t,this.blendNode=n}setup(){const{blendMode:e,baseNode:t,blendNode:n}=this,i={base:t,blend:n};let r=null;return e===KM.BURN?r=WM(i):e===KM.DODGE?r=YM(i):e===KM.SCREEN?r=qM(i):e===KM.OVERLAY&&(r=XM(i)),r}}KM.BURN="burn",KM.DODGE="dodge",KM.SCREEN="screen",KM.OVERLAY="overlay";const JM=yy(KM,KM.BURN),$M=yy(KM,KM.DODGE),QM=yy(KM,KM.OVERLAY),ZM=yy(KM,KM.SCREEN);Wv("burn",JM),Wv("dodge",$M),Wv("overlay",QM),Wv("screen",ZM),Mv("BlendModeNode",KM);const eT=wy((e=>{let{textureNode:t,bumpScale:n}=e,i=t;if(!0!==i.isTextureNode&&i.traverse((e=>{!0===e.isTextureNode&&(i=e)})),!0!==i.isTextureNode)throw new Error("THREE.TSL: dHdxy_fwd() requires a TextureNode.");const r=Ny(t),s=i.uvNode||J_(),a=e=>t.cache().context({getUV:()=>e,forceUVContext:!0});return Ey(Ny(a(s.add(s.dFdx()))).sub(r),Ny(a(s.add(s.dFdy()))).sub(r)).mul(n)})),tT=wy((e=>{const{surf_pos:t,surf_norm:n,dHdxy:i}=e,r=t.dFdx().normalize(),s=n,a=t.dFdy().normalize().cross(s),o=s.cross(r),l=r.dot(a).mul(UN),c=l.sign().mul(i.x.mul(a).add(i.y.mul(o)));return l.abs().mul(n).sub(c).normalize()}));class nT extends Av{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super("vec3"),this.textureNode=e,this.scaleNode=t}setup(){const e=null!==this.scaleNode?this.scaleNode:1,t=eT({textureNode:this.textureNode,bumpScale:e});return tT({surf_pos:Jb,surf_norm:pb,dHdxy:t})}}Wv("bumpMap",yy(nT)),Mv("BumpMapNode",nT);const iT=wy((e=>{let{color:t,adjustment:n}=e;return n.mix(hT(t.rgb),t.rgb)})),rT=wy((e=>{let{color:t,adjustment:n}=e;const i=ew(t.r,t.g,t.b).div(3),r=t.r.max(t.g.max(t.b)),s=r.sub(i).mul(n).mul(-3);return vx(t.rgb,r,s)})),sT=wy((e=>{let{color:t,adjustment:n}=e;const i=Py(.57735,.57735,.57735),r=n.cos();return Py(t.rgb.mul(r).add(i.cross(t.rgb).mul(n.sin()).add(i.mul(ux(i,t.rgb).mul(r.oneMinus())))))}));class aT extends Av{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ny(1);super("vec3"),this.method=e,this.colorNode=t,this.adjustmentNode=n}setup(){const{method:e,colorNode:t,adjustmentNode:n}=this,i={color:t,adjustment:n};let r=null;return e===aT.SATURATION?r=iT(i):e===aT.VIBRANCE?r=rT(i):e===aT.HUE?r=sT(i):console.error("".concat(this.type,': Method "').concat(this.method,'" not supported!')),r}}aT.SATURATION="saturation",aT.VIBRANCE="vibrance",aT.HUE="hue";const oT=yy(aT,aT.SATURATION),lT=yy(aT,aT.VIBRANCE),cT=yy(aT,aT.HUE),uT=Py(.2125,.7154,.0721),hT=function(e){return ux(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:uT)},dT=(e,t)=>vx(Py(0),e,hT(e).sub(t).max(0));Wv("saturation",oT),Wv("vibrance",lT),Wv("hue",cT),Wv("threshold",dT),Mv("ColorAdjustmentNode",aT);const pT=wy((e=>{const{eye_pos:t,surf_norm:n,mapN:i,uv:r}=e,s=t.dFdx(),a=t.dFdy(),o=r.dFdx(),l=r.dFdy(),c=n,u=a.cross(c),h=c.cross(s),d=u.mul(o.x).add(h.mul(l.x)),p=u.mul(o.y).add(h.mul(l.y)),f=d.dot(d).max(p.dot(p)),m=UN.mul(f.inverseSqrt());return ew(d.mul(i.x,m),p.mul(i.y,m),c.mul(i.z)).normalize()}));class fT extends Av{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super("vec3"),this.node=e,this.scaleNode=t,this.normalMapType=0}setup(e){const{normalMapType:t,scaleNode:n}=this;let i=this.node.mul(2).sub(1);null!==n&&(i=Py(i.xy.mul(n),i.z));let r=null;if(1===t)r=lb.mul(i).normalize();else if(0===t){r=!0===e.hasGeometryAttribute("tangent")?TM.mul(i).normalize():pT({eye_pos:Jb,surf_norm:pb,mapN:i,uv:J_()})}return r}}Wv("normalMap",yy(fT)),Mv("NormalMapNode",fT);class mT extends Av{constructor(e,t){super(),this.sourceNode=e,this.stepsNode=t}setup(){const{sourceNode:e,stepsNode:t}=this;return e.mul(t).floor().div(t)}}Wv("posterize",yy(mT)),Mv("PosterizeNode",mT);const gT=wy((e=>{let{color:t,exposure:n}=e;return t.mul(n).clamp()})),vT=wy((e=>{let{color:t,exposure:n}=e;return t=t.mul(n),t.div(t.add(1)).clamp()})),yT=wy((e=>{let{color:t,exposure:n}=e;t=t.mul(n),t=t.sub(.004).max(0);const i=t.mul(t.mul(6.2).add(.5)),r=t.mul(t.mul(6.2).add(1.7)).add(.06);return i.div(r).pow(2.2)})),_T=wy((e=>{let{color:t}=e;const n=t.mul(t.add(.0245786)).sub(90537e-9),i=t.mul(t.add(.432951).mul(.983729)).add(.238081);return n.div(i)})),wT=wy((e=>{let{color:t,exposure:n}=e;const i=Gy(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),r=Gy(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return t=t.mul(n).div(.6),t=i.mul(t),t=_T({color:t}),t=r.mul(t),t.clamp()})),xT=Gy(Py(1.6605,-.1246,-.0182),Py(-.5876,1.1329,-.1006),Py(-.0728,-.0083,1.1187)),bT=Gy(Py(.6274,.0691,.0164),Py(.3293,.9195,.088),Py(.0433,.0113,.8956)),ST=wy((e=>{let[t]=e;const n=Py(t).toVar(),i=Py(n.mul(n)).toVar(),r=Py(i.mul(i)).toVar();return Ny(15.5).mul(r.mul(i)).sub(nw(40.14,r.mul(n))).add(nw(31.96,r).sub(nw(6.868,i.mul(n))).add(nw(.4298,i).add(nw(.1191,n).sub(.00232))))})),NT=wy((e=>{let{color:t,exposure:n}=e;const i=Py(t).toVar(),r=Gy(Py(.856627153315983,.137318972929847,.11189821299995),Py(.0951212405381588,.761241990602591,.0767994186031903),Py(.0482516061458583,.101439036467562,.811302368396859)),s=Gy(Py(1.1271005818144368,-.1413297634984383,-.14132976349843826),Py(-.11060664309660323,1.157823702216272,-.11060664309660294),Py(-.016493938717834573,-.016493938717834257,1.2519364065950405)),a=Ny(-12.47393),o=Ny(4.026069);return i.mulAssign(n),i.assign(bT.mul(i)),i.assign(r.mul(i)),i.assign(rx(i,1e-10)),i.assign(Pw(i)),i.assign(i.sub(a).div(o.sub(a))),i.assign(yx(i,0,1)),i.assign(ST(i)),i.assign(s.mul(i)),i.assign(dx(rx(Py(0),i),Py(2.2))),i.assign(xT.mul(i)),i.assign(yx(i,0,1)),i})),MT={[hd]:gT,[dd]:vT,[pd]:yT,[fd]:wT,[md]:NT};class TT extends Av{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ud,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:AT,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super("vec3"),this.toneMapping=e,this.exposureNode=t,this.colorNode=n}getCacheKey(){let e=super.getCacheKey();return e="{toneMapping:"+this.toneMapping+",nodes:"+e+"}",e}setup(e){const t=this.colorNode||e.context.color,n=this.toneMapping;if(n===ud)return t;const i={exposure:this.exposureNode,color:t},r=MT[n];let s=null;return r?s=r(i):(console.error("ToneMappingNode: Unsupported Tone Mapping configuration.",n),s=t),s}}const AT=((e,t,n)=>my(new EM(e,t,n)))("toneMappingExposure","float");Wv("toneMapping",((e,t,n)=>((e,t,n)=>my(new TT(e,my(t),my(n))))(t,n,e))),Mv("ToneMappingNode",TT);let ET=null;class CT extends NN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xN,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null===ET&&(ET=new pg),super(e,t,ET)}updateReference(){return this}}Wv("viewportSharedTexture",yy(CT)),Mv("ViewportSharedTextureNode",CT);class IT extends Ox{constructor(e,t){super(t),this.passNode=e,this.setUpdateMatrix(!1)}setup(e){return this.passNode.build(e),super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}}class RT extends Av{constructor(e,t,n){super("vec4"),this.scope=e,this.scene=t,this.camera=n,this._pixelRatio=1,this._width=1,this._height=1;const i=new ng;i.isRenderTargetTexture=!0,i.name="PostProcessingDepth";const r=new Ip(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:Md});r.texture.name="PostProcessing",r.depthTexture=i,this.renderTarget=r,this.updateBeforeType=td,this._textureNode=my(new IT(this,r.texture)),this._depthTextureNode=my(new IT(this,i)),this._depthNode=null,this._viewZNode=null,this._cameraNear=X_(0),this._cameraFar=X_(0),this.isPassNode=!0}isGlobal(){return!0}getTextureNode(){return this._textureNode}getTextureDepthNode(){return this._depthTextureNode}getViewZNode(){if(null===this._viewZNode){const e=this._cameraNear,t=this._cameraFar;this._viewZNode=PN(this._depthTextureNode,e,t)}return this._viewZNode}getDepthNode(){if(null===this._depthNode){const e=this._cameraNear,t=this._cameraFar;this._depthNode=RN(this.getViewZNode(),e,t)}return this._depthNode}setup(){return this.scope===RT.COLOR?this.getTextureNode():this.getDepthNode()}updateBefore(e){const{renderer:t}=e,{scene:n,camera:i}=this;this._pixelRatio=t.getPixelRatio();const r=t.getSize(new lp);this.setSize(r.width,r.height);const s=t.toneMapping,a=t.toneMappingNode,o=t.getRenderTarget();this._cameraNear.value=i.near,this._cameraFar.value=i.far,t.toneMapping=ud,t.toneMappingNode=null,t.setRenderTarget(this.renderTarget),t.render(n,i),t.toneMapping=s,t.toneMappingNode=a,t.setRenderTarget(o)}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this.renderTarget.setSize(n,i)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}RT.COLOR="color",RT.DEPTH="depth";const PT=(e,t)=>my(new IT(e,t));Mv("PassNode",RT);const DT=new tg(-1,1,1,-1,0,1);const kT=new class extends vm{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super();const t=!1===e?[0,-1,0,1,2,1]:[0,2,0,0,2,0];this.setAttribute("position",new cm([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new cm(t,2))}};const LT=class extends Lm{constructor(){super(kT,arguments.length>0&&void 0!==arguments[0]?arguments[0]:null),this.camera=DT}renderAsync(e){return e.renderAsync(this,DT)}render(e){e.render(this,DT)}},OT=new LT,BT=new LT;class UT extends Av{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;super("vec4"),this.textureNode=e,this.sigma=t,this.directionNode=Ey(1),this._invSize=X_(new lp),this._passDirection=X_(new lp),this._horizontalRT=new Ip,this._horizontalRT.texture.name="GaussianBlurNode.horizontal",this._verticalRT=new Ip,this._verticalRT.texture.name="GaussianBlurNode.vertical",this._textureNode=PT(this,this._verticalRT.texture),this.updateBeforeType=nd,this.resolution=new lp(1,1)}setSize(e,t){e=Math.max(Math.round(e*this.resolution.x),1),t=Math.max(Math.round(t*this.resolution.y),1),this._invSize.value.set(1/e,1/t),this._horizontalRT.setSize(e,t),this._verticalRT.setSize(e,t)}updateBefore(e){const{renderer:t}=e,n=this.textureNode,i=n.value,r=t.getRenderTarget(),s=n.value;OT.material=this._material,BT.material=this._material,this.setSize(i.image.width,i.image.height);const a=i.type;this._horizontalRT.texture.type=a,this._verticalRT.texture.type=a,t.setRenderTarget(this._horizontalRT),this._passDirection.value.set(1,0),OT.render(t),n.value=this._horizontalRT.texture,t.setRenderTarget(this._verticalRT),this._passDirection.value.set(0,1),BT.render(t),t.setRenderTarget(r),n.value=s}getTextureNode(){return this._textureNode}setup(e){const t=this.textureNode;if(!0!==t.isTextureNode)return console.error("GaussianBlurNode requires a TextureNode."),Oy();const n=t.uvNode||J_(),i=e=>t.cache().context({getUV:()=>e,forceUVContext:!0}),r=wy((()=>{const e=3+2*this.sigma,t=this._getCoefficients(e),r=this._invSize,s=Ey(this.directionNode).mul(this._passDirection),a=Ny(t[0]).toVar(),o=Oy(i(n).mul(a)).toVar();for(let l=1;l<e;l++){const e=Ny(l),c=Ny(t[l]),u=Ey(s.mul(r.mul(e))).toVar(),h=Oy(i(n.add(u))),d=Oy(i(n.sub(u)));o.addAssign(h.add(d).mul(c)),a.addAssign(nw(2,c))}return o.div(a)}));(this._material||(this._material=e.createNodeMaterial())).fragmentNode=r();return e.getNodeProperties(this).textureNode=t,this._textureNode}_getCoefficients(e){const t=[];for(let n=0;n<e;n++)t.push(.39894*Math.exp(-.5*n*n/(e*e))/e);return t}}Wv("gaussianBlur",((e,t)=>my(new UT(my(e),t))));const zT=new LT;class VT extends Av{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.96;super(e),this.textureNode=e,this.textureNodeOld=Bx(),this.damp=X_(t),this._compRT=new Ip,this._compRT.texture.name="AfterImageNode.comp",this._oldRT=new Ip,this._oldRT.texture.name="AfterImageNode.old",this._textureNode=PT(this,this._compRT.texture),this.updateBeforeType=nd}getTextureNode(){return this._textureNode}setSize(e,t){this._compRT.setSize(e,t),this._oldRT.setSize(e,t)}updateBefore(e){const{renderer:t}=e,n=this.textureNode,i=n.value,r=i.type;this._compRT.texture.type=r,this._oldRT.texture.type=r;const s=t.getRenderTarget(),a=n.value;this.textureNodeOld.value=this._oldRT.texture,t.setRenderTarget(this._compRT),zT.render(t);const o=this._oldRT;this._oldRT=this._compRT,this._compRT=o,this.setSize(i.image.width,i.image.height),t.setRenderTarget(s),n.value=a}setup(e){const t=this.textureNode,n=this.textureNodeOld;if(!0!==t.isTextureNode)return console.error("AfterImageNode requires a TextureNode."),Oy();const i=t.uvNode||J_();n.uvNode=i;const r=wy((e=>{let[t,n]=e;const i=Ny(n).toVar(),r=Oy(t).toVar();return rx(Yw(r.sub(i)),0)})),s=wy((()=>{const e=Oy(n),s=Oy((e=>t.cache().context({getUV:()=>e,forceUVContext:!0}))(i));return e.mulAssign(this.damp.mul(r(e,.1))),rx(s,e)})),a=this._materialComposed||(this._materialComposed=e.createNodeMaterial());a.fragmentNode=s(),zT.material=a;return e.getNodeProperties(this).textureNode=t,this._textureNode}}Wv("afterImage",((e,t)=>my(new VT(my(e),t))));const FT=new LT;class jT extends Av{constructor(e,t,n,i){super("vec4"),this.textureNode=e,this.tresholdNode=t,this.scaleNode=n,this.colorNode=Py(.1,0,1),this.samples=i,this.resolution=new lp(1,1),this._renderTarget=new Ip,this._renderTarget.texture.name="anamorphic",this._invSize=X_(new lp),this._textureNode=PT(this,this._renderTarget.texture),this.updateBeforeType=nd}getTextureNode(){return this._textureNode}setSize(e,t){this._invSize.value.set(1/e,1/t),e=Math.max(Math.round(e*this.resolution.x),1),t=Math.max(Math.round(t*this.resolution.y),1),this._renderTarget.setSize(e,t)}updateBefore(e){const{renderer:t}=e,n=this.textureNode,i=n.value;this._renderTarget.texture.type=i.type;const r=t.getRenderTarget(),s=n.value;FT.material=this._material,this.setSize(i.image.width,i.image.height),t.setRenderTarget(this._renderTarget),FT.render(t),t.setRenderTarget(r),n.value=s}setup(e){const t=this.textureNode;if(!0!==t.isTextureNode)return console.error("AnamorphNode requires a TextureNode."),Oy();const n=t.uvNode||J_(),i=wy((()=>{const e=this.samples,i=Math.floor(e/2),r=Py(0).toVar();return gS({start:-i,end:i},(e=>{let{i:s}=e;const a=Ny(s).abs().div(i).oneMinus(),o=(e=>t.cache().context({getUV:()=>e,forceUVContext:!0}))(Ey(n.x.add(this._invSize.x.mul(s).mul(this.scaleNode)),n.y)),l=dT(o,this.tresholdNode).mul(a);r.addAssign(l)})),r.mul(this.colorNode)}));(this._material||(this._material=e.createNodeMaterial())).fragmentNode=i();return e.getNodeProperties(this).textureNode=t,this._textureNode}}Wv("anamorphic",(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32;return my(new jT(my(e),my(t),my(n),i))}));class HT extends Av{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.functionNode=e,this.parameters=t}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}generate(e){const t=[],n=this.functionNode,i=n.getInputs(e),r=this.parameters;if(Array.isArray(r))for(let a=0;a<r.length;a++){const n=i[a],s=r[a];t.push(s.build(e,n.type))}else for(const a of i){const n=r[a.name];if(void 0===n)throw new Error("FunctionCallNode: Input '".concat(a.name,"' not found in FunctionNode."));t.push(n.build(e,a.type))}const s=n.build(e,"property");return"".concat(s,"( ").concat(t.join(", ")," )")}}Wv("call",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n=n.length>1||n[0]&&!0===n[0].isNode?vy(n):gy(n[0]),my(new HT(my(e),n))})),Mv("FunctionCallNode",HT);class GT extends Nv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this._value=e,this._cache=null,this.inputType=null,this.outpuType=null,this.events=new Jd,this.isScriptableValueNode=!0}get isScriptableOutputNode(){return null!==this.outputType}set value(e){this._value!==e&&(this._cache&&"URL"===this.inputType&&this.value.value instanceof ArrayBuffer&&(URL.revokeObjectURL(this._cache),this._cache=null),this._value=e,this.events.dispatchEvent({type:"change"}),this.refresh())}get value(){return this._value}refresh(){this.events.dispatchEvent({type:"refresh"})}getValue(){const e=this.value;if(e&&null===this._cache&&"URL"===this.inputType&&e.value instanceof ArrayBuffer)this._cache=URL.createObjectURL(new Blob([e.value]));else if(e&&null!==e.value&&void 0!==e.value&&(("URL"===this.inputType||"String"===this.inputType)&&"string"===typeof e.value||"Number"===this.inputType&&"number"===typeof e.value||"Vector2"===this.inputType&&e.value.isVector2||"Vector3"===this.inputType&&e.value.isVector3||"Vector4"===this.inputType&&e.value.isVector4||"Color"===this.inputType&&e.value.isColor||"Matrix3"===this.inputType&&e.value.isMatrix3||"Matrix4"===this.inputType&&e.value.isMatrix4))return e.value;return this._cache||e}getNodeType(e){return this.value&&this.value.isNode?this.value.getNodeType(e):"float"}setup(){return this.value&&this.value.isNode?this.value:Ny()}serialize(e){super.serialize(e),null!==this.value?"ArrayBuffer"===this.inputType?e.value=wv(this.value):e.value=this.value?this.value.toJSON(e.meta).uuid:null:e.value=null,e.inputType=this.inputType,e.outputType=this.outputType}deserialize(e){super.deserialize(e);let t=null;null!==e.value&&(t="ArrayBuffer"===e.inputType?xv(e.value):"Texture"===e.inputType?e.meta.textures[e.value]:e.meta.nodes[e.value]||null),this.value=t,this.inputType=e.inputType,this.outputType=e.outputType}}const WT=yy(GT);Wv("scriptableValue",WT),Mv("ScriptableValueNode",GT);class YT extends Map{get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.has(e))return super.get(e);if(null!==t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];const s=t(...i);return this.set(e,s),s}}}class qT{constructor(e){this.scriptableNode=e}get parameters(){return this.scriptableNode.parameters}get layout(){return this.scriptableNode.getLayout()}getInputLayout(e){return this.scriptableNode.getInputLayout(e)}get(e){const t=this.parameters[e];return t?t.getValue():null}}const XT=new YT;class KT extends Nv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.codeNode=e,this.parameters=t,this._local=new YT,this._output=WT(),this._outputs={},this._source=this.source,this._method=null,this._object=null,this._value=null,this._needsOutputUpdate=!0,this.onRefresh=this.onRefresh.bind(this),this.isScriptableNode=!0}get source(){return this.codeNode?this.codeNode.code:""}setLocal(e,t){return this._local.set(e,t)}getLocal(e){return this._local.get(e)}onRefresh(){this._refresh()}getInputLayout(e){for(const t of this.getLayout())if(t.inputType&&(t.id===e||t.name===e))return t}getOutputLayout(e){for(const t of this.getLayout())if(t.outputType&&(t.id===e||t.name===e))return t}setOutput(e,t){const n=this._outputs;return void 0===n[e]?n[e]=WT(t):n[e].value=t,this}getOutput(e){return this._outputs[e]}getParameter(e){return this.parameters[e]}setParameter(e,t){const n=this.parameters;return t&&t.isScriptableNode?(this.deleteParameter(e),n[e]=t,n[e].getDefaultOutput().events.addEventListener("refresh",this.onRefresh)):t&&t.isScriptableValueNode?(this.deleteParameter(e),n[e]=t,n[e].events.addEventListener("refresh",this.onRefresh)):void 0===n[e]?(n[e]=WT(t),n[e].events.addEventListener("refresh",this.onRefresh)):n[e].value=t,this}getValue(){return this.getDefaultOutput().getValue()}deleteParameter(e){let t=this.parameters[e];return t&&(t.isScriptableNode&&(t=t.getDefaultOutput()),t.events.removeEventListener("refresh",this.onRefresh)),this}clearParameters(){for(const e of Object.keys(this.parameters))this.deleteParameter(e);return this.needsUpdate=!0,this}call(e){const t=this.getObject()[e];if("function"===typeof t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return t(...i)}}async callAsync(e){const t=this.getObject()[e];if("function"===typeof t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return"AsyncFunction"===t.constructor.name?await t(...i):t(...i)}}getNodeType(e){return this.getDefaultOutputNode().getNodeType(e)}refresh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null!==e?this.getOutput(e).refresh():this._refresh()}getObject(){if(this.needsUpdate&&this.dispose(),null!==this._object)return this._object;const e=new qT(this),t=XT.get("THREE"),n=XT.get("TSL"),i=this.getMethod(this.codeNode),r=[e,this._local,XT,()=>this.refresh(),(e,t)=>this.setOutput(e,t),t,n];this._object=i(...r);const s=this._object.layout;if(s&&(!1===s.cache&&this._local.clear(),this._output.outputType=s.outputType||null,Array.isArray(s.elements)))for(const a of s.elements){const e=a.id||a.name;a.inputType&&(void 0===this.getParameter(e)&&this.setParameter(e,null),this.getParameter(e).inputType=a.inputType),a.outputType&&(void 0===this.getOutput(e)&&this.setOutput(e,null),this.getOutput(e).outputType=a.outputType)}return this._object}deserialize(e){super.deserialize(e);for(const t in this.parameters){let e=this.parameters[t];e.isScriptableNode&&(e=e.getDefaultOutput()),e.events.addEventListener("refresh",this.onRefresh)}}getLayout(){return this.getObject().layout}getDefaultOutputNode(){const e=this.getDefaultOutput().value;return e&&e.isNode?e:Ny()}getDefaultOutput(){return this._exec()._output}getMethod(){if(this.needsUpdate&&this.dispose(),null!==this._method)return this._method;const e=["layout","init","main","dispose"].join(", "),t="\nreturn { ...output, "+e+" };",n="var "+e+"; var output = {};\n"+this.codeNode.code+t;return this._method=new Function(...["parameters","local","global","refresh","setOutput","THREE","TSL"],n),this._method}dispose(){null!==this._method&&(this._object&&"function"===typeof this._object.dispose&&this._object.dispose(),this._method=null,this._object=null,this._source=null,this._value=null,this._needsOutputUpdate=!0,this._output.value=null,this._outputs={})}setup(){return this.getDefaultOutputNode()}set needsUpdate(e){!0===e&&this.dispose()}get needsUpdate(){return this.source!==this._source}_exec(){return null===this.codeNode||(!0===this._needsOutputUpdate&&(this._value=this.call("main"),this._needsOutputUpdate=!1),this._output.value=this._value),this}_refresh(){this.needsUpdate=!0,this._exec(),this._output.refresh()}}Wv("scriptable",yy(KT)),Mv("ScriptableNode",KT);class JT extends Nv{constructor(e,t){super("float"),this.isFogNode=!0,this.colorNode=e,this.factorNode=t}getViewZNode(e){let t;const n=e.context.getViewZ;return void 0!==n&&(t=n(this)),(t||Jb.z).negate()}setup(){return this.factorNode}}const $T=JT;Wv("fog",yy(JT)),Mv("FogNode",JT);class QT extends $T{constructor(e,t,n){super(e),this.isFogRangeNode=!0,this.nearNode=t,this.farNode=n}setup(e){const t=this.getViewZNode(e);return wx(this.nearNode,this.farNode,t)}}Wv("rangeFog",yy(QT)),Mv("FogRangeNode",QT);class ZT extends $T{constructor(e,t){super(e),this.isFogExp2Node=!0,this.densityNode=t}setup(e){const t=this.getViewZNode(e),n=this.densityNode;return n.mul(n,t,t).negate().exp().oneMinus()}}Wv("densityFog",yy(ZT)),Mv("FogExp2Node",ZT);let eA=null,tA=null;class nA extends Nv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ny(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ny();super(),this.minNode=e,this.maxNode=t}getVectorLength(e){const t=e.getTypeLength(yv(this.minNode.value)),n=e.getTypeLength(yv(this.maxNode.value));return t>n?t:n}getNodeType(e){return!0===e.object.isInstancedMesh?e.getTypeFromLength(this.getVectorLength(e)):"float"}setup(e){const t=e.object;let n=null;if(!0===t.isInstancedMesh){const i=this.minNode.value,r=this.maxNode.value,s=e.getTypeLength(yv(i)),a=e.getTypeLength(yv(r));eA=eA||new Cp,tA=tA||new Cp,eA.setScalar(0),tA.setScalar(0),1===s?eA.setScalar(i):i.isColor?eA.set(i.r,i.g,i.b):eA.set(i.x,i.y,i.z||0,i.w||0),1===a?tA.setScalar(r):r.isColor?tA.set(r.r,r.g,r.b):tA.set(r.x,r.y,r.z||0,r.w||0);const o=4,l=o*t.count,c=new Float32Array(l);for(let e=0;e<l;e++){const t=e%o,n=eA.getComponent(t),i=tA.getComponent(t);c[e]=op.lerp(n,i,Math.random())}const u=this.getNodeType(e);n=Fx(c,"vec4",t.count).element(g_).convert(u)}else n=Ny(0);return n}}yy(nA);Mv("RangeNode",nA);class iA extends Nv{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[64];super("void"),this.isComputeNode=!0,this.computeNode=e,this.count=t,this.workgroupSize=n,this.dispatchCount=0,this.version=1,this.updateBeforeType=id,this.updateDispatchCount()}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}updateDispatchCount(){const{count:e,workgroupSize:t}=this;let n=t[0];for(let i=1;i<t.length;i++)n*=t[i];this.dispatchCount=Math.ceil(e/n)}onInit(){}updateBefore(e){let{renderer:t}=e;t.compute(this)}generate(e){const{shaderStage:t}=e;if("compute"===t){const t=this.computeNode.build(e,"void");""!==t&&e.addLineFlowCode(t)}}}Wv("compute",((e,t,n)=>my(new iA(my(e),t,n)))),Mv("ComputeNode",iA);class rA extends Nv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rA.TARGET_DIRECTION,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(),this.scope=e,this.light=t}setup(){const{scope:e,light:t}=this;let n=null;return e===rA.TARGET_DIRECTION&&(n=sb.transformDirection(Qx(t).sub(Qx(t.target)))),n}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}rA.TARGET_DIRECTION="targetDirection";const sA=yy(rA,rA.TARGET_DIRECTION);Mv("LightNode",rA);const aA=wy((e=>{const{lightDistance:t,cutoffDistance:n,decayExponent:i}=e,r=t.pow(i).max(.01).reciprocal();return n.greaterThan(0).cond(r.mul(t.div(n).pow4().oneMinus().clamp().pow2()),r)}));class oA extends IS{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null),this.cutoffDistanceNode=X_(0),this.decayExponentNode=X_(0)}update(e){const{light:t}=this;super.update(e),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}setup(e){const{colorNode:t,cutoffDistanceNode:n,decayExponentNode:i,light:r}=this,s=e.context.lightingModel,a=Zx(r).sub(Jb),o=a.normalize(),l=a.length(),c=aA({lightDistance:l,cutoffDistance:n,decayExponent:i}),u=t.mul(c),h=e.context.reflectedLight;s.direct({lightDirection:o,lightColor:u,reflectedLight:h},e.stack,e)}}Mv("PointLightNode",oA),kS(iv,oA);class lA extends IS{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)}setup(e){super.setup(e);const t=e.context.lightingModel,n=this.colorNode,i=sA(this.light),r=e.context.reflectedLight;t.direct({lightDirection:i,lightColor:n,reflectedLight:r},e.stack,e)}}Mv("DirectionalLightNode",lA),kS(sv,lA);class cA extends IS{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null),this.coneCosNode=X_(0),this.penumbraCosNode=X_(0),this.cutoffDistanceNode=X_(0),this.decayExponentNode=X_(0)}update(e){super.update(e);const{light:t}=this;this.coneCosNode.value=Math.cos(t.angle),this.penumbraCosNode.value=Math.cos(t.angle*(1-t.penumbra)),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}getSpotAttenuation(e){const{coneCosNode:t,penumbraCosNode:n}=this;return wx(t,n,e)}setup(e){super.setup(e);const t=e.context.lightingModel,{colorNode:n,cutoffDistanceNode:i,decayExponentNode:r,light:s}=this,a=Zx(s).sub(Jb),o=a.normalize(),l=o.dot(sA(s)),c=this.getSpotAttenuation(l),u=a.length(),h=aA({lightDistance:u,cutoffDistance:i,decayExponent:r}),d=n.mul(c).mul(h),p=e.context.reflectedLight;t.direct({lightDirection:o,lightColor:d,reflectedLight:p},e.stack,e)}}const uA=cA;Mv("SpotLightNode",cA),kS(Qg,cA);const hA=class extends Qg{constructor(e,t,n,i,r,s){super(e,t,n,i,r,s),this.iesMap=null}copy(e,t){return super.copy(e,t),this.iesMap=e.iesMap,this}};class dA extends uA{getSpotAttenuation(e){const t=this.light.iesMap;let n=null;if(t&&!0===t.isTexture){const i=e.acos().mul(1/Math.PI);n=Bx(t,Ey(i,0),0).r}else n=super.getSpotAttenuation(e);return n}}Mv("IESSpotLightNode",dA),kS(hA,dA);class pA extends IS{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)}setup(e){let{context:t}=e;t.irradiance.addAssign(this.colorNode)}}Mv("AmbientLightNode",pA),kS(av,pA);class fA extends IS{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(e),this.lightPositionNode=Qx(e),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=X_(new Zf)}update(e){const{light:t}=this;super.update(e),this.lightPositionNode.object3d=t,this.groundColorNode.value.copy(t.groundColor).multiplyScalar(t.intensity)}setup(e){const{colorNode:t,groundColorNode:n,lightDirectionNode:i}=this,r=pb.dot(i).mul(.5).add(.5),s=vx(n,t,r);e.context.irradiance.addAssign(s)}}Mv("HemisphereLightNode",fA),kS(Yg,fA);const mA=wy((e=>{const t=e.uv.mul(2),n=t.x.floor(),i=t.y.floor();return n.add(i).mod(2).sign()}));class gA extends Av{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J_();super("float"),this.uvNode=e}setup(){return mA({uv:this.uvNode})}}Wv("checker",yy(gA)),Mv("CheckerNode",gA);const vA=new dg;class yA extends FN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.normals=!1,this.lights=!1,this.useAlphaToCoverage=!0,this.useColor=e.vertexColors,this.pointWidth=1,this.pointColorNode=null,this.setDefaultValues(vA),this.setupShaders(),this.setValues(e)}setupShaders(){const e=this.alphaToCoverage,t=this.useColor;this.vertexNode=wy((()=>{t_(Ey(),"vUv").assign(J_());const e=r_("instancePosition"),t=b_("vec4","mvPos");t.assign(ob.mul(Oy(e,1)));const n=wN.z.div(wN.w),i=tb.mul(t),r=b_("vec2","offset");return r.assign(Yb.xy),r.assign(r.mul(Gb)),r.assign(r.div(wN.z)),r.y.assign(r.y.mul(n)),r.assign(r.mul(i.w)),i.assign(i.add(Oy(r,0,0))),i}))(),this.fragmentNode=wy((()=>{const n=t_(Ey(),"vUv"),i=b_("float","alpha");i.assign(1);const r=n.x,s=n.y,a=r.mul(r).add(s.mul(s));if(e){const e=b_("float","dlen");e.assign(a.fwidth()),i.assign(wx(e.oneMinus(),e.add(1),a).oneMinus())}else a.greaterThan(1).discard();let o;if(this.pointColorNode)o=this.pointColorNode;else if(t){o=r_("instanceColor").mul(xb)}else o=xb;return Oy(o,i)}))(),this.needsUpdate=!0}get alphaToCoverage(){return this.useAlphaToCoverage}set alphaToCoverage(e){this.useAlphaToCoverage!==e&&(this.useAlphaToCoverage=e,this.setupShaders())}}jN("InstancedPointsNodeMaterial",yA);const _A=new hg;class wA extends FN{constructor(e){super(),this.isLineBasicNodeMaterial=!0,this.lights=!1,this.normals=!1,this.setDefaultValues(_A),this.setValues(e)}}jN("LineBasicNodeMaterial",wA);const xA=new Sg;class bA extends FN{constructor(e){super(),this.isLineDashedNodeMaterial=!0,this.lights=!1,this.normals=!1,this.setDefaultValues(xA),this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}setupVariants(){const e=this.offsetNode,t=this.dashScaleNode?Ny(this.dashScaleNode):zb,n=this.dashSizeNode?Ny(this.dashSizeNode):Vb,i=this.dashSizeNode?Ny(this.dashGapNode):Fb;B_.assign(n),U_.assign(i);const r=t_(r_("lineDistance").mul(t));(e?r.add(e):r).mod(B_.add(U_)).greaterThan(B_).discard()}}jN("LineDashedNodeMaterial",bA);const SA=new Sg;class NA extends FN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.normals=!1,this.lights=!1,this.setDefaultValues(SA),this.useAlphaToCoverage=!0,this.useColor=e.vertexColors,this.useDash=e.dashed,this.useWorldUnits=!1,this.dashOffset=0,this.lineWidth=1,this.lineColorNode=null,this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setupShaders(),this.setValues(e)}setupShaders(){const e=this.alphaToCoverage,t=this.useColor,n=this.dashed,i=this.worldUnits,r=wy((e=>{let{start:t,end:n}=e;const i=tb.element(2).element(2),r=tb.element(3).element(2).mul(-.5).div(i).sub(t.z).div(n.z.sub(t.z));return Oy(vx(t.xyz,n.xyz,r),n.w)}));this.vertexNode=wy((()=>{S_("vec2","vUv").assign(J_());const e=r_("instanceStart"),t=r_("instanceEnd"),s=b_("vec4","start"),a=b_("vec4","end");s.assign(ob.mul(Oy(e,1))),a.assign(ob.mul(Oy(t,1))),i&&(S_("vec3","worldStart").assign(s.xyz),S_("vec3","worldEnd").assign(a.xyz));const o=wN.z.div(wN.w),l=tb.element(2).element(3).equal(-1);by(l,(()=>{by(s.z.lessThan(0).and(a.z.greaterThan(0)),(()=>{a.assign(r({start:s,end:a}))})).elseif(a.z.lessThan(0).and(s.z.greaterThanEqual(0)),(()=>{s.assign(r({start:a,end:s}))}))}));const c=tb.mul(s),u=tb.mul(a),h=c.xyz.div(c.w),d=u.xyz.div(u.w),p=d.xy.sub(h.xy).temp();p.x.assign(p.x.mul(o)),p.assign(p.normalize());const f=__(Oy());if(i){const e=a.xyz.sub(s.xyz).normalize(),t=vx(s.xyz,a.xyz,.5).normalize(),i=e.cross(t).normalize(),r=e.cross(i),o=S_("vec4","worldPos");o.assign(Yb.y.lessThan(.5).cond(s,a));const l=jb.mul(.5);o.addAssign(Oy(Yb.x.lessThan(0).cond(i.mul(l),i.mul(l).negate()),0)),n||(o.addAssign(Oy(Yb.y.lessThan(.5).cond(e.mul(l).negate(),e.mul(l)),0)),o.addAssign(Oy(r.mul(l),0)),by(Yb.y.greaterThan(1).or(Yb.y.lessThan(0)),(()=>{o.subAssign(Oy(r.mul(2).mul(l),0))}))),f.assign(tb.mul(o));const c=__(Py());c.assign(Yb.y.lessThan(.5).cond(h,d)),f.z.assign(c.z.mul(f.w))}else{const e=b_("vec2","offset");e.assign(Ey(p.y,p.x.negate())),p.x.assign(p.x.div(o)),e.x.assign(e.x.div(o)),e.assign(Yb.x.lessThan(0).cond(e.negate(),e)),by(Yb.y.lessThan(0),(()=>{e.assign(e.sub(p))})).elseif(Yb.y.greaterThan(1),(()=>{e.assign(e.add(p))})),e.assign(e.mul(jb)),e.assign(e.div(wN.w)),f.assign(Yb.y.lessThan(.5).cond(c,u)),e.assign(e.mul(f.w)),f.assign(f.add(Oy(e,0,0)))}return f}))();const s=wy((e=>{let{p1:t,p2:n,p3:i,p4:r}=e;const s=t.sub(i),a=r.sub(i),o=n.sub(t),l=s.dot(a),c=a.dot(o),u=s.dot(o),h=a.dot(a),d=o.dot(o).mul(h).sub(c.mul(c)),p=l.mul(c).sub(u.mul(h)).div(d).clamp(),f=l.add(c.mul(p)).div(h).clamp();return Ey(p,f)}));this.fragmentNode=wy((()=>{const r=S_("vec2","vUv");if(n){const e=this.offsetNode?Ny(this.offsetNodeNode):Hb,t=this.dashScaleNode?Ny(this.dashScaleNode):zb,n=this.dashSizeNode?Ny(this.dashSizeNode):Vb,i=this.dashSizeNode?Ny(this.dashGapNode):Fb;B_.assign(n),U_.assign(i);const s=r_("instanceDistanceStart"),a=r_("instanceDistanceEnd"),o=Yb.y.lessThan(.5).cond(t.mul(s),zb.mul(a)),l=t_(o.add(Hb)),c=e?l.add(e):l;r.y.lessThan(-1).or(r.y.greaterThan(1)).discard(),c.mod(B_.add(U_)).greaterThan(B_).discard()}const a=b_("float","alpha");if(a.assign(1),i){const t=S_("vec3","worldStart"),i=S_("vec3","worldEnd"),r=S_("vec4","worldPos").xyz.normalize().mul(1e5),o=i.sub(t),l=s({p1:t,p2:i,p3:Py(0,0,0),p4:r}),c=t.add(o.mul(l.x)),u=r.mul(l.y),h=c.sub(u).length().div(jb);if(!n)if(e){const e=h.fwidth();a.assign(wx(e.negate().add(.5),e.add(.5),h).oneMinus())}else h.greaterThan(.5).discard()}else if(e){const e=r.x,t=r.y.greaterThan(0).cond(r.y.sub(1),r.y.add(1)),n=e.mul(e).add(t.mul(t)),i=b_("float","dlen");i.assign(n.fwidth()),by(r.y.abs().greaterThan(1),(()=>{a.assign(wx(i.oneMinus(),i.add(1),n).oneMinus())}))}else by(r.y.abs().greaterThan(1),(()=>{const e=r.x,t=r.y.greaterThan(0).cond(r.y.sub(1),r.y.add(1));e.mul(e).add(t.mul(t)).greaterThan(1).discard()}));let o;if(this.lineColorNode)o=this.lineColorNode;else if(t){const e=r_("instanceColorStart"),t=r_("instanceColorEnd");o=Yb.y.lessThan(.5).cond(e,t).mul(xb)}else o=xb;return Oy(o,a)}))(),this.needsUpdate=!0}get worldUnits(){return this.useWorldUnits}set worldUnits(e){this.useWorldUnits!==e&&(this.useWorldUnits=e,this.setupShaders())}get dashed(){return this.useDash}set dashed(e){this.useDash!==e&&(this.useDash=e,this.setupShaders())}get alphaToCoverage(){return this.useAlphaToCoverage}set alphaToCoverage(e){this.useAlphaToCoverage!==e&&(this.useAlphaToCoverage=e,this.setupShaders())}}jN("Line2NodeMaterial",NA);const MA=new wg;class TA extends FN{constructor(e){super(),this.isMeshNormalNodeMaterial=!0,this.colorSpaced=!1,this.setDefaultValues(MA),this.setValues(e)}setupDiffuseColor(){const e=this.opacityNode?Ny(this.opacityNode):Nb;N_.assign(Oy(hM(mb),e))}}jN("MeshNormalNodeMaterial",TA);const AA=new im;class EA extends FN{constructor(e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!1,this.setDefaultValues(AA),this.setValues(e)}}jN("MeshBasicNodeMaterial",EA);const CA=wy((e=>{let{f0:t,f90:n,dotVH:i}=e;const r=i.mul(-5.55473).sub(6.98316).mul(i).exp2();return t.mul(r.oneMinus()).add(n.mul(r))})),IA=wy((e=>e.diffuseColor.mul(1/Math.PI))),RA=wy((e=>{let{dotNH:t}=e;return L_.mul(.5/Math.PI).add(1).mul(t.pow(L_))})),PA=wy((e=>{let{lightDirection:t}=e;const n=t.add($b).normalize(),i=mb.dot(n).clamp(),r=$b.dot(n).clamp(),s=CA({f0:k_,f90:1,dotVH:r}),a=Ny(.25),o=RA({dotNH:i});return s.mul(a).mul(o)}));const DA=class extends v_{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];super(),this.specular=e}direct(e){let{lightDirection:t,lightColor:n,reflectedLight:i}=e;const r=mb.dot(t).clamp().mul(n);i.directDiffuse.addAssign(r.mul(IA({diffuseColor:N_.rgb}))),!0===this.specular&&i.directSpecular.addAssign(r.mul(PA({lightDirection:t})).mul(Tb))}indirectDiffuse(e){let{irradiance:t,reflectedLight:n}=e;n.indirectDiffuse.addAssign(t.mul(IA({diffuseColor:N_})))}},kA=new xg;class LA extends FN{constructor(e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues(kA),this.setValues(e)}setupLightingModel(){return new DA(!1)}}jN("MeshLambertNodeMaterial",LA);const OA=new yg;class BA extends FN{constructor(e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues(OA),this.setValues(e)}setupLightingModel(){return new DA}setupVariants(){const e=(this.shininessNode?Ny(this.shininessNode):bb).max(1e-4);L_.assign(e);const t=this.specularNode||Mb;k_.assign(t)}copy(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,super.copy(e)}}jN("MeshPhongNodeMaterial",BA);const UA=wy((()=>{const e=hb.dFdx().abs().max(hb.dFdy().abs());return e.x.max(e.y).max(e.z)})),zA=wy((e=>{const{roughness:t}=e,n=UA();let i=t.max(.0525);return i=i.add(n),i=i.min(1),i})),VA=zA,FA=wy((e=>{const{alpha:t,dotNL:n,dotNV:i}=e,r=t.pow2(),s=n.mul(r.add(r.oneMinus().mul(i.pow2())).sqrt()),a=i.mul(r.add(r.oneMinus().mul(n.pow2())).sqrt());return iw(.5,s.add(a).max(bw))})).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),jA=wy((e=>{let{alpha:t,dotNH:n}=e;const i=t.pow2(),r=n.pow2().mul(i.oneMinus()).oneMinus();return i.div(r.pow2()).mul(1/Math.PI)})).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),HA=wy((e=>{const{lightDirection:t,f0:n,f90:i,roughness:r,iridescenceFresnel:s}=e,a=e.normalView||mb,o=r.pow2(),l=t.add($b).normalize(),c=a.dot(t).clamp(),u=a.dot($b).clamp(),h=a.dot(l).clamp(),d=$b.dot(l).clamp();let p=CA({f0:n,f90:i,dotVH:d});s&&(p=R_.mix(p,s));const f=FA({alpha:o,dotNL:c,dotNV:u}),m=jA({alpha:o,dotNH:h});return p.mul(f).mul(m)})),GA=HA,WA=wy((e=>{let{roughness:t,dotNV:n}=e;const i=Oy(-1,-.0275,-.572,.022),r=Oy(1,.0425,1.04,-.04),s=t.mul(i).add(r),a=s.x.mul(s.x).min(n.mul(-9.28).exp2()).mul(s.x).add(s.y);return Ey(-1.04,1.04).mul(a).add(s.zw)})).setLayout({name:"DFGApprox",type:"vec2",inputs:[{name:"roughness",type:"float"},{name:"dotNV",type:"vec3"}]}),YA=WA,qA=wy((e=>{const{dotNV:t,specularColor:n,specularF90:i,roughness:r}=e,s=YA({dotNV:t,roughness:r});return n.mul(s.x).add(i.mul(s.y))})),XA=qA,KA=wy((e=>{let{f:t,f90:n,dotVH:i}=e;const r=i.oneMinus().saturate(),s=r.mul(r),a=r.mul(s,s).clamp(0,.9999);return t.sub(Py(n).mul(a)).div(a.oneMinus())})).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),JA=wy((e=>{let{roughness:t,dotNH:n}=e;const i=t.pow2(),r=Ny(1).div(i),s=n.pow2().oneMinus().max(.0078125);return Ny(2).add(r).mul(s.pow(r.mul(.5))).div(2*Math.PI)})).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),$A=wy((e=>{let{dotNV:t,dotNL:n}=e;return Ny(1).div(Ny(4).mul(n.add(t).sub(n.mul(t))))})).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),QA=wy((e=>{let{lightDirection:t}=e;const n=t.add($b).normalize(),i=mb.dot(t).clamp(),r=mb.dot($b).clamp(),s=mb.dot(n).clamp(),a=JA({roughness:I_,dotNH:s}),o=$A({dotNV:r,dotNL:i});return C_.mul(a).mul(o)})),ZA=Gy(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),eE=(e,t)=>e.sub(t).div(e.add(t)).pow2(),tE=(e,t)=>{const n=e.mul(2*Math.PI*1e-9),i=Py(54856e-17,44201e-17,52481e-17),r=Py(1681e3,1795300,2208400),s=Py(43278e5,93046e5,66121e5),a=Ny(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(n.mul(2239900).add(t.x).cos()).mul(n.pow2().mul(-45282e5).exp());let o=i.mul(s.mul(2*Math.PI).sqrt()).mul(r.mul(n).add(t).cos()).mul(n.pow2().negate().mul(s).exp());o=Py(o.x.add(a),o.y,o.z).div(1.0685e-7);return ZA.mul(o)},nE=wy((e=>{let{outsideIOR:t,eta2:n,cosTheta1:i,thinFilmThickness:r,baseF0:s}=e;const a=vx(t,n,wx(0,.03,r)),o=t.div(a).pow2().mul(Ny(1).sub(i.pow2())),l=Ny(1).sub(o).sqrt(),c=eE(a,t),u=CA({f0:c,f90:1,dotVH:i}),h=u.oneMinus(),d=a.lessThan(t).cond(Math.PI,0),p=Ny(Math.PI).sub(d),f=(e=>{const t=e.sqrt();return Py(1).add(t).div(Py(1).sub(t))})(s.clamp(0,.9999)),m=eE(f,a.vec3()),g=CA({f0:m,f90:1,dotVH:l}),v=Py(f.x.lessThan(a).cond(Math.PI,0),f.y.lessThan(a).cond(Math.PI,0),f.z.lessThan(a).cond(Math.PI,0)),y=a.mul(r,l,2),_=Py(p).add(v),w=u.mul(g).clamp(1e-5,.9999),x=w.sqrt(),b=h.pow2().mul(g).div(Py(1).sub(w));let S=u.add(b),N=b.sub(h);for(let M=1;M<=2;++M){N=N.mul(x);const e=tE(Ny(M).mul(y),Ny(M).mul(_)).mul(2);S=S.add(N.mul(e))}return S.max(Py(0))})).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),iE=wy((e=>{let{normal:t,viewDir:n,roughness:i}=e;const r=t.dot(n).saturate(),s=i.pow2(),a=FS(i.lessThan(.25),Ny(-339.2).mul(s).add(Ny(161.4).mul(i)).sub(25.9),Ny(-8.48).mul(s).add(Ny(14.3).mul(i)).sub(9.95)),o=FS(i.lessThan(.25),Ny(44).mul(s).sub(Ny(23.7).mul(i)).add(3.26),Ny(1.97).mul(s).sub(Ny(3.27).mul(i)).add(.72));return FS(i.lessThan(.25),0,Ny(.1).mul(i).sub(.025)).add(a.mul(r).add(o).exp()).mul(1/Math.PI).saturate()})),rE=Py(.04),sE=Py(1);const aE=class extends v_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(),this.clearcoat=e,this.sheen=t,this.iridescence=n,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null}start(){if(!0===this.clearcoat&&(this.clearcoatRadiance=Py().temp("clearcoatRadiance"),this.clearcoatSpecularDirect=Py().temp("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=Py().temp("clearcoatSpecularIndirect")),!0===this.sheen&&(this.sheenSpecularDirect=Py().temp("sheenSpecularDirect"),this.sheenSpecularIndirect=Py().temp("sheenSpecularIndirect")),!0===this.iridescence){const e=mb.dot($b).clamp();this.iridescenceFresnel=nE({outsideIOR:Ny(1),eta2:P_,cosTheta1:e,thinFilmThickness:D_,baseF0:k_}),this.iridescenceF0=KA({f:this.iridescenceFresnel,f90:1,dotVH:e})}}computeMultiscattering(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ny(1);const i=mb.dot($b).clamp(),r=YA({roughness:M_,dotNV:i}),s=(this.iridescenceF0?R_.mix(k_,this.iridescenceF0):k_).mul(r.x).add(n.mul(r.y)),a=r.x.add(r.y).oneMinus(),o=k_.add(k_.oneMinus().mul(.047619)),l=s.mul(o).div(a.mul(o).oneMinus());e.addAssign(s),t.addAssign(l.mul(a))}direct(e){let{lightDirection:t,lightColor:n,reflectedLight:i}=e;const r=mb.dot(t).clamp().mul(n);if(!0===this.sheen&&this.sheenSpecularDirect.addAssign(r.mul(QA({lightDirection:t}))),!0===this.clearcoat){const e=vb.dot(t).clamp().mul(n);this.clearcoatSpecularDirect.addAssign(e.mul(GA({lightDirection:t,f0:rE,f90:sE,roughness:E_,normalView:vb})))}i.directDiffuse.addAssign(r.mul(IA({diffuseColor:N_.rgb}))),i.directSpecular.addAssign(r.mul(GA({lightDirection:t,f0:k_,f90:1,roughness:M_,iridescence:this.iridescence,iridescenceFresnel:this.iridescenceFresnel})))}indirectDiffuse(e){let{irradiance:t,reflectedLight:n}=e;n.indirectDiffuse.addAssign(t.mul(IA({diffuseColor:N_})))}indirectSpecular(e){let{radiance:t,iblIrradiance:n,reflectedLight:i}=e;if(!0===this.sheen&&this.sheenSpecularIndirect.addAssign(n.mul(C_,iE({normal:mb,viewDir:$b,roughness:I_}))),!0===this.clearcoat){const e=vb.dot($b).clamp(),t=XA({dotNV:e,specularColor:rE,specularF90:sE,roughness:E_});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(t))}const r=Py().temp("singleScattering"),s=Py().temp("multiScattering"),a=n.mul(1/Math.PI);this.computeMultiscattering(r,s);const o=r.add(s),l=N_.mul(o.r.max(o.g).max(o.b).oneMinus());i.indirectSpecular.addAssign(t.mul(r)),i.indirectSpecular.addAssign(s.mul(a)),i.indirectDiffuse.addAssign(l.mul(a))}ambientOcclusion(e){let{ambientOcclusion:t,reflectedLight:n}=e;const i=mb.dot($b).clamp().add(t),r=M_.mul(-16).oneMinus().negate().exp2(),s=t.sub(i.pow(r).oneMinus()).clamp();!0===this.clearcoat&&this.clearcoatSpecularIndirect.mulAssign(t),!0===this.sheen&&this.sheenSpecularIndirect.mulAssign(t),n.indirectDiffuse.mulAssign(t),n.indirectSpecular.mulAssign(s)}finish(e){const{outgoingLight:t}=e;if(!0===this.clearcoat){const e=vb.dot($b).clamp(),n=CA({dotVH:e,f0:rE,f90:sE}),i=t.mul(A_.mul(n).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(A_));t.assign(i)}if(!0===this.sheen){const e=C_.r.max(C_.g).max(C_.b).mul(.157).oneMinus(),n=t.mul(e).add(this.sheenSpecularDirect,this.sheenSpecularIndirect);t.assign(n)}}},oE=new gg;class lE extends FN{constructor(e){super(),this.isMeshStandardNodeMaterial=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(oE),this.setValues(e)}setupLightingModel(){return new aE}setupVariants(){const e=this.metalnessNode?Ny(this.metalnessNode):Eb;T_.assign(e);let t=this.roughnessNode?Ny(this.roughnessNode):Ab;t=VA({roughness:t}),M_.assign(t);const n=vx(Py(.04),N_.rgb,e);k_.assign(n),N_.assign(Oy(N_.rgb.mul(e.oneMinus()),N_.a))}copy(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,super.copy(e)}}const cE=lE;jN("MeshStandardNodeMaterial",lE);const uE=new vg;class hE extends cE{constructor(e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.setDefaultValues(uE),this.setValues(e)}get useClearcoat(){return this.clearcoat>0||null!==this.clearcoatNode}get useIridescence(){return this.iridescence>0||null!==this.iridescenceNode}get useSheen(){return this.sheen>0||null!==this.sheenNode}setupLightingModel(){return new aE(this.useClearcoat,this.useSheen,this.useIridescence)}setupVariants(e){if(super.setupVariants(e),this.useClearcoat){const e=this.clearcoatNode?Ny(this.clearcoatNode):Ib,t=this.clearcoatRoughnessNode?Ny(this.clearcoatRoughnessNode):Rb;A_.assign(e),E_.assign(t)}if(this.useSheen){const e=this.sheenNode?Py(this.sheenNode):kb,t=this.sheenRoughnessNode?Ny(this.sheenRoughnessNode):Lb;C_.assign(e),I_.assign(t)}if(this.useIridescence){const e=this.iridescenceNode?Ny(this.iridescenceNode):Ob,t=this.iridescenceIORNode?Ny(this.iridescenceIORNode):Bb,n=this.iridescenceThicknessNode?Ny(this.iridescenceThicknessNode):Ub;R_.assign(e),P_.assign(t),D_.assign(n)}}setupNormal(e){super.setupNormal(e);const t=this.clearcoatNormalNode?Py(this.clearcoatNormalNode):Pb;vb.assign(t)}copy(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,super.copy(e)}}const dE=hE;jN("MeshPhysicalNodeMaterial",hE);class pE extends aE{constructor(e,t,n,i){super(e,t,n),this.useSSS=i}direct(e,t,n){let{lightDirection:i,lightColor:r,reflectedLight:s}=e;if(!0===this.useSSS){const e=n.material,{thicknessColorNode:t,thicknessDistortionNode:a,thicknessAmbientNode:o,thicknessAttenuationNode:l,thicknessPowerNode:c,thicknessScaleNode:u}=e,h=i.add(mb.mul(a)).normalize(),d=Ny($b.dot(h.negate()).saturate().pow(c).mul(u)),p=Py(d.add(o).mul(t));s.directDiffuse.addAssign(p.mul(l.mul(r)))}super.direct({lightDirection:i,lightColor:r,reflectedLight:s},t,n)}}class fE extends dE{constructor(e){super(e),this.thicknessColorNode=null,this.thicknessDistortionNode=Ny(.1),this.thicknessAmbientNode=Ny(0),this.thicknessAttenuationNode=Ny(.1),this.thicknessPowerNode=Ny(2),this.thicknessScaleNode=Ny(10)}get useSSS(){return null!==this.thicknessColorNode}setupLightingModel(){return new pE(this.useClearcoat,this.useSheen,this.useIridescence,this.useSSS)}copy(e){return this.thicknessColorNode=e.thicknessColorNode,this.thicknessDistortionNode=e.thicknessDistortionNode,this.thicknessAmbientNode=e.thicknessAmbientNode,this.thicknessAttenuationNode=e.thicknessAttenuationNode,this.thicknessPowerNode=e.thicknessPowerNode,this.thicknessScaleNode=e.thicknessScaleNode,super.copy(e)}}jN("MeshSSSNodeMaterial",fE);const mE=new dg;class gE extends FN{constructor(e){super(),this.isPointsNodeMaterial=!0,this.lights=!1,this.normals=!1,this.transparent=!0,this.sizeNode=null,this.setDefaultValues(mE),this.setValues(e)}copy(e){return this.sizeNode=e.sizeNode,super.copy(e)}}jN("PointsNodeMaterial",gE);const vE=new cg;class yE extends FN{constructor(e){super(),this.isSpriteNodeMaterial=!0,this.lights=!1,this.normals=!1,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.setDefaultValues(vE),this.setValues(e)}setupPosition(e){let{object:t,context:n}=e;const{positionNode:i,rotationNode:r,scaleNode:s}=this,a=qb;let o=ob.mul(Py(i||0)),l=Ey(cb[0].xyz.length(),cb[1].xyz.length());null!==s&&(l=l.mul(s));let c=a.xy;t.center&&!0===t.center.isVector2&&(c=c.sub(X_(t.center).sub(.5))),c=c.mul(l);const u=Ny(r||Db),h=c.rotate(u);o=Oy(o.xy.add(h),o.zw);const d=tb.mul(o);return n.vertex=a,d}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}}jN("SpriteNodeMaterial",yE);const _E=ov.createMaterialFromType;ov.createMaterialFromType=function(e){const t=HN(e);return void 0!==t?t:_E.call(this,e)};class wE{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this.type=e,this.inputs=t,this.name=n,this.presicion=i}getCode(){console.warn("Abstract function.")}}wE.isNodeFunction=!0;const xE=wy((e=>{let[t,n,i]=e;const r=Ny(i).toVar(),s=Ny(n).toVar(),a=Ay(t).toVar();return FS(a,s,r)})),bE=wy((e=>{let[t,n]=e;const i=Ay(n).toVar(),r=Ny(t).toVar();return FS(i,r.negate(),r)})),SE=wy((e=>{let[t]=e;const n=Ny(t).toVar();return My(Lw(n))})),NE=wy((e=>{let[t,n]=e;const i=Ny(t).toVar();return n.assign(SE(i)),i.sub(Ny(n))})),ME=wy((e=>{let[t,n,i,r,s,a]=e;const o=Ny(a).toVar(),l=Ny(s).toVar(),c=Ny(r).toVar(),u=Ny(i).toVar(),h=Ny(n).toVar(),d=Ny(t).toVar(),p=Ny(tw(1,l)).toVar();return tw(1,o).mul(d.mul(p).add(h.mul(l))).add(o.mul(u.mul(p).add(c.mul(l))))})),TE=wy((e=>{let[t,n,i,r,s,a]=e;const o=Ny(a).toVar(),l=Ny(s).toVar(),c=Py(r).toVar(),u=Py(i).toVar(),h=Py(n).toVar(),d=Py(t).toVar(),p=Ny(tw(1,l)).toVar();return tw(1,o).mul(d.mul(p).add(h.mul(l))).add(o.mul(u.mul(p).add(c.mul(l))))})),AE=aM([ME,TE]),EE=wy((e=>{let[t,n,i,r,s,a,o,l,c,u,h]=e;const d=Ny(h).toVar(),p=Ny(u).toVar(),f=Ny(c).toVar(),m=Ny(l).toVar(),g=Ny(o).toVar(),v=Ny(a).toVar(),y=Ny(s).toVar(),_=Ny(r).toVar(),w=Ny(i).toVar(),x=Ny(n).toVar(),b=Ny(t).toVar(),S=Ny(tw(1,f)).toVar(),N=Ny(tw(1,p)).toVar();return Ny(tw(1,d)).toVar().mul(N.mul(b.mul(S).add(x.mul(f))).add(p.mul(w.mul(S).add(_.mul(f))))).add(d.mul(N.mul(y.mul(S).add(v.mul(f))).add(p.mul(g.mul(S).add(m.mul(f))))))})),CE=wy((e=>{let[t,n,i,r,s,a,o,l,c,u,h]=e;const d=Ny(h).toVar(),p=Ny(u).toVar(),f=Ny(c).toVar(),m=Py(l).toVar(),g=Py(o).toVar(),v=Py(a).toVar(),y=Py(s).toVar(),_=Py(r).toVar(),w=Py(i).toVar(),x=Py(n).toVar(),b=Py(t).toVar(),S=Ny(tw(1,f)).toVar(),N=Ny(tw(1,p)).toVar();return Ny(tw(1,d)).toVar().mul(N.mul(b.mul(S).add(x.mul(f))).add(p.mul(w.mul(S).add(_.mul(f))))).add(d.mul(N.mul(y.mul(S).add(v.mul(f))).add(p.mul(g.mul(S).add(m.mul(f))))))})),IE=aM([EE,CE]),RE=wy((e=>{let[t,n,i]=e;const r=Ny(i).toVar(),s=Ny(n).toVar(),a=Ty(t).toVar(),o=Ty(a.bitAnd(Ty(7))).toVar(),l=Ny(xE(o.lessThan(Ty(4)),s,r)).toVar(),c=Ny(nw(2,xE(o.lessThan(Ty(4)),r,s))).toVar();return bE(l,Ay(o.bitAnd(Ty(1)))).add(bE(c,Ay(o.bitAnd(Ty(2)))))})),PE=wy((e=>{let[t,n,i,r]=e;const s=Ny(r).toVar(),a=Ny(i).toVar(),o=Ny(n).toVar(),l=Ty(t).toVar(),c=Ty(l.bitAnd(Ty(15))).toVar(),u=Ny(xE(c.lessThan(Ty(8)),o,a)).toVar(),h=Ny(xE(c.lessThan(Ty(4)),a,xE(c.equal(Ty(12)).or(c.equal(Ty(14))),o,s))).toVar();return bE(u,Ay(c.bitAnd(Ty(1)))).add(bE(h,Ay(c.bitAnd(Ty(2)))))})),DE=aM([RE,PE]),kE=wy((e=>{let[t,n,i]=e;const r=Ny(i).toVar(),s=Ny(n).toVar(),a=ky(t).toVar();return Py(DE(a.x,s,r),DE(a.y,s,r),DE(a.z,s,r))})),LE=wy((e=>{let[t,n,i,r]=e;const s=Ny(r).toVar(),a=Ny(i).toVar(),o=Ny(n).toVar(),l=ky(t).toVar();return Py(DE(l.x,o,a,s),DE(l.y,o,a,s),DE(l.z,o,a,s))})),OE=aM([kE,LE]),BE=wy((e=>{let[t]=e;const n=Ny(t).toVar();return nw(.6616,n)})),UE=wy((e=>{let[t]=e;const n=Ny(t).toVar();return nw(.982,n)})),zE=wy((e=>{let[t]=e;const n=Py(t).toVar();return nw(.6616,n)})),VE=aM([BE,zE]),FE=wy((e=>{let[t]=e;const n=Py(t).toVar();return nw(.982,n)})),jE=aM([UE,FE]),HE=wy((e=>{let[t,n]=e;const i=My(n).toVar(),r=Ty(t).toVar();return r.shiftLeft(i).bitOr(r.shiftRight(My(32).sub(i)))})),GE=wy((e=>{let[t,n,i]=e;t.subAssign(i),t.bitXorAssign(HE(i,My(4))),i.addAssign(n),n.subAssign(t),n.bitXorAssign(HE(t,My(6))),t.addAssign(i),i.subAssign(n),i.bitXorAssign(HE(n,My(8))),n.addAssign(t),t.subAssign(i),t.bitXorAssign(HE(i,My(16))),i.addAssign(n),n.subAssign(t),n.bitXorAssign(HE(t,My(19))),t.addAssign(i),i.subAssign(n),i.bitXorAssign(HE(n,My(4))),n.addAssign(t)})),WE=wy((e=>{let[t,n,i]=e;const r=Ty(i).toVar(),s=Ty(n).toVar(),a=Ty(t).toVar();return r.bitXorAssign(s),r.subAssign(HE(s,My(14))),a.bitXorAssign(r),a.subAssign(HE(r,My(11))),s.bitXorAssign(a),s.subAssign(HE(a,My(25))),r.bitXorAssign(s),r.subAssign(HE(s,My(16))),a.bitXorAssign(r),a.subAssign(HE(r,My(4))),s.bitXorAssign(a),s.subAssign(HE(a,My(14))),r.bitXorAssign(s),r.subAssign(HE(s,My(24))),r})),YE=wy((e=>{let[t]=e;const n=Ty(t).toVar();return Ny(n).div(Ny(Ty(My(4294967295))))})),qE=wy((e=>{let[t]=e;const n=Ny(t).toVar();return n.mul(n.mul(n.mul(n.mul(n.mul(6).sub(15)).add(10))))})),XE=wy((e=>{let[t]=e;const n=My(t).toVar(),i=Ty(Ty(1)).toVar(),r=Ty(Ty(My(3735928559)).add(i.shiftLeft(Ty(2)).add(Ty(13)))).toVar();return WE(r.add(Ty(n)),r,r)})),KE=wy((e=>{let[t,n]=e;const i=My(n).toVar(),r=My(t).toVar(),s=Ty(Ty(2)).toVar(),a=Ty().toVar(),o=Ty().toVar(),l=Ty().toVar();return a.assign(o.assign(l.assign(Ty(My(3735928559)).add(s.shiftLeft(Ty(2)).add(Ty(13)))))),a.addAssign(Ty(r)),o.addAssign(Ty(i)),WE(a,o,l)})),JE=wy((e=>{let[t,n,i]=e;const r=My(i).toVar(),s=My(n).toVar(),a=My(t).toVar(),o=Ty(Ty(3)).toVar(),l=Ty().toVar(),c=Ty().toVar(),u=Ty().toVar();return l.assign(c.assign(u.assign(Ty(My(3735928559)).add(o.shiftLeft(Ty(2)).add(Ty(13)))))),l.addAssign(Ty(a)),c.addAssign(Ty(s)),u.addAssign(Ty(r)),WE(l,c,u)})),$E=wy((e=>{let[t,n,i,r]=e;const s=My(r).toVar(),a=My(i).toVar(),o=My(n).toVar(),l=My(t).toVar(),c=Ty(Ty(4)).toVar(),u=Ty().toVar(),h=Ty().toVar(),d=Ty().toVar();return u.assign(h.assign(d.assign(Ty(My(3735928559)).add(c.shiftLeft(Ty(2)).add(Ty(13)))))),u.addAssign(Ty(l)),h.addAssign(Ty(o)),d.addAssign(Ty(a)),GE(u,h,d),u.addAssign(Ty(s)),WE(u,h,d)})),QE=wy((e=>{let[t,n,i,r,s]=e;const a=My(s).toVar(),o=My(r).toVar(),l=My(i).toVar(),c=My(n).toVar(),u=My(t).toVar(),h=Ty(Ty(5)).toVar(),d=Ty().toVar(),p=Ty().toVar(),f=Ty().toVar();return d.assign(p.assign(f.assign(Ty(My(3735928559)).add(h.shiftLeft(Ty(2)).add(Ty(13)))))),d.addAssign(Ty(u)),p.addAssign(Ty(c)),f.addAssign(Ty(l)),GE(d,p,f),d.addAssign(Ty(o)),p.addAssign(Ty(a)),WE(d,p,f)})),ZE=aM([XE,KE,JE,$E,QE]),eC=wy((e=>{let[t,n]=e;const i=My(n).toVar(),r=My(t).toVar(),s=Ty(ZE(r,i)).toVar(),a=ky().toVar();return a.x.assign(s.bitAnd(My(255))),a.y.assign(s.shiftRight(My(8)).bitAnd(My(255))),a.z.assign(s.shiftRight(My(16)).bitAnd(My(255))),a})),tC=wy((e=>{let[t,n,i]=e;const r=My(i).toVar(),s=My(n).toVar(),a=My(t).toVar(),o=Ty(ZE(a,s,r)).toVar(),l=ky().toVar();return l.x.assign(o.bitAnd(My(255))),l.y.assign(o.shiftRight(My(8)).bitAnd(My(255))),l.z.assign(o.shiftRight(My(16)).bitAnd(My(255))),l})),nC=aM([eC,tC]),iC=wy((e=>{let[t]=e;const n=Ey(t).toVar(),i=My().toVar(),r=My().toVar(),s=Ny(NE(n.x,i)).toVar(),a=Ny(NE(n.y,r)).toVar(),o=Ny(qE(s)).toVar(),l=Ny(qE(a)).toVar(),c=Ny(AE(DE(ZE(i,r),s,a),DE(ZE(i.add(My(1)),r),s.sub(1),a),DE(ZE(i,r.add(My(1))),s,a.sub(1)),DE(ZE(i.add(My(1)),r.add(My(1))),s.sub(1),a.sub(1)),o,l)).toVar();return VE(c)})),rC=wy((e=>{let[t]=e;const n=Py(t).toVar(),i=My().toVar(),r=My().toVar(),s=My().toVar(),a=Ny(NE(n.x,i)).toVar(),o=Ny(NE(n.y,r)).toVar(),l=Ny(NE(n.z,s)).toVar(),c=Ny(qE(a)).toVar(),u=Ny(qE(o)).toVar(),h=Ny(qE(l)).toVar(),d=Ny(IE(DE(ZE(i,r,s),a,o,l),DE(ZE(i.add(My(1)),r,s),a.sub(1),o,l),DE(ZE(i,r.add(My(1)),s),a,o.sub(1),l),DE(ZE(i.add(My(1)),r.add(My(1)),s),a.sub(1),o.sub(1),l),DE(ZE(i,r,s.add(My(1))),a,o,l.sub(1)),DE(ZE(i.add(My(1)),r,s.add(My(1))),a.sub(1),o,l.sub(1)),DE(ZE(i,r.add(My(1)),s.add(My(1))),a,o.sub(1),l.sub(1)),DE(ZE(i.add(My(1)),r.add(My(1)),s.add(My(1))),a.sub(1),o.sub(1),l.sub(1)),c,u,h)).toVar();return jE(d)})),sC=aM([iC,rC]),aC=wy((e=>{let[t]=e;const n=Ey(t).toVar(),i=My().toVar(),r=My().toVar(),s=Ny(NE(n.x,i)).toVar(),a=Ny(NE(n.y,r)).toVar(),o=Ny(qE(s)).toVar(),l=Ny(qE(a)).toVar(),c=Py(AE(OE(nC(i,r),s,a),OE(nC(i.add(My(1)),r),s.sub(1),a),OE(nC(i,r.add(My(1))),s,a.sub(1)),OE(nC(i.add(My(1)),r.add(My(1))),s.sub(1),a.sub(1)),o,l)).toVar();return VE(c)})),oC=wy((e=>{let[t]=e;const n=Py(t).toVar(),i=My().toVar(),r=My().toVar(),s=My().toVar(),a=Ny(NE(n.x,i)).toVar(),o=Ny(NE(n.y,r)).toVar(),l=Ny(NE(n.z,s)).toVar(),c=Ny(qE(a)).toVar(),u=Ny(qE(o)).toVar(),h=Ny(qE(l)).toVar(),d=Py(IE(OE(nC(i,r,s),a,o,l),OE(nC(i.add(My(1)),r,s),a.sub(1),o,l),OE(nC(i,r.add(My(1)),s),a,o.sub(1),l),OE(nC(i.add(My(1)),r.add(My(1)),s),a.sub(1),o.sub(1),l),OE(nC(i,r,s.add(My(1))),a,o,l.sub(1)),OE(nC(i.add(My(1)),r,s.add(My(1))),a.sub(1),o,l.sub(1)),OE(nC(i,r.add(My(1)),s.add(My(1))),a,o.sub(1),l.sub(1)),OE(nC(i.add(My(1)),r.add(My(1)),s.add(My(1))),a.sub(1),o.sub(1),l.sub(1)),c,u,h)).toVar();return jE(d)})),lC=aM([aC,oC]),cC=wy((e=>{let[t]=e;const n=Ny(t).toVar(),i=My(SE(n)).toVar();return YE(ZE(i))})),uC=wy((e=>{let[t]=e;const n=Ey(t).toVar(),i=My(SE(n.x)).toVar(),r=My(SE(n.y)).toVar();return YE(ZE(i,r))})),hC=wy((e=>{let[t]=e;const n=Py(t).toVar(),i=My(SE(n.x)).toVar(),r=My(SE(n.y)).toVar(),s=My(SE(n.z)).toVar();return YE(ZE(i,r,s))})),dC=wy((e=>{let[t]=e;const n=Oy(t).toVar(),i=My(SE(n.x)).toVar(),r=My(SE(n.y)).toVar(),s=My(SE(n.z)).toVar(),a=My(SE(n.w)).toVar();return YE(ZE(i,r,s,a))})),pC=(aM([cC,uC,hC,dC]),wy((e=>{let[t]=e;const n=Ny(t).toVar(),i=My(SE(n)).toVar();return Py(YE(ZE(i,My(0))),YE(ZE(i,My(1))),YE(ZE(i,My(2))))}))),fC=wy((e=>{let[t]=e;const n=Ey(t).toVar(),i=My(SE(n.x)).toVar(),r=My(SE(n.y)).toVar();return Py(YE(ZE(i,r,My(0))),YE(ZE(i,r,My(1))),YE(ZE(i,r,My(2))))})),mC=wy((e=>{let[t]=e;const n=Py(t).toVar(),i=My(SE(n.x)).toVar(),r=My(SE(n.y)).toVar(),s=My(SE(n.z)).toVar();return Py(YE(ZE(i,r,s,My(0))),YE(ZE(i,r,s,My(1))),YE(ZE(i,r,s,My(2))))})),gC=wy((e=>{let[t]=e;const n=Oy(t).toVar(),i=My(SE(n.x)).toVar(),r=My(SE(n.y)).toVar(),s=My(SE(n.z)).toVar(),a=My(SE(n.w)).toVar();return Py(YE(ZE(i,r,s,a,My(0))),YE(ZE(i,r,s,a,My(1))),YE(ZE(i,r,s,a,My(2))))})),vC=aM([pC,fC,mC,gC]),yC=wy((e=>{let[t,n,i,r]=e;const s=Ny(r).toVar(),a=Ny(i).toVar(),o=My(n).toVar(),l=Py(t).toVar(),c=Ny(0).toVar(),u=Ny(1).toVar();return gS({start:My(0),end:o},(e=>{let{i:t}=e;c.addAssign(u.mul(sC(l))),u.mulAssign(s),l.mulAssign(a)})),c})),_C=wy((e=>{let[t,n,i,r]=e;const s=Ny(r).toVar(),a=Ny(i).toVar(),o=My(n).toVar(),l=Py(t).toVar(),c=Py(0).toVar(),u=Ny(1).toVar();return gS({start:My(0),end:o},(e=>{let{i:t}=e;c.addAssign(u.mul(lC(l))),u.mulAssign(s),l.mulAssign(a)})),c})),wC=wy((e=>{let[t,n,i,r]=e;const s=Ny(r).toVar(),a=Ny(i).toVar(),o=My(n).toVar(),l=Py(t).toVar();return Ey(yC(l,o,a,s),yC(l.add(Py(My(19),My(193),My(17))),o,a,s))})),xC=wy((e=>{let[t,n,i,r]=e;const s=Ny(r).toVar(),a=Ny(i).toVar(),o=My(n).toVar(),l=Py(t).toVar(),c=Py(_C(l,o,a,s)).toVar(),u=Ny(yC(l.add(Py(My(19),My(193),My(17))),o,a,s)).toVar();return Oy(c,u)})),bC=wy((e=>{let[t,n,i,r,s,a,o]=e;const l=My(o).toVar(),c=Ny(a).toVar(),u=My(s).toVar(),h=My(r).toVar(),d=My(i).toVar(),p=My(n).toVar(),f=Ey(t).toVar(),m=Py(vC(Ey(p.add(h),d.add(u)))).toVar(),g=Ey(m.x,m.y).toVar();g.subAssign(.5),g.mulAssign(c),g.addAssign(.5);const v=Ey(Ey(Ny(p),Ny(d)).add(g)).toVar(),y=Ey(v.sub(f)).toVar();return by(l.equal(My(2)),(()=>Ww(y.x).add(Ww(y.y)))),by(l.equal(My(3)),(()=>rx(Ww(y.x),Ww(y.y)))),ux(y,y)})),SC=wy((e=>{let[t,n,i,r,s,a,o,l,c]=e;const u=My(c).toVar(),h=Ny(l).toVar(),d=My(o).toVar(),p=My(a).toVar(),f=My(s).toVar(),m=My(r).toVar(),g=My(i).toVar(),v=My(n).toVar(),y=Py(t).toVar(),_=Py(vC(Py(v.add(f),g.add(p),m.add(d)))).toVar();_.subAssign(.5),_.mulAssign(h),_.addAssign(.5);const w=Py(Py(Ny(v),Ny(g),Ny(m)).add(_)).toVar(),x=Py(w.sub(y)).toVar();return by(u.equal(My(2)),(()=>Ww(x.x).add(Ww(x.y).add(Ww(x.z))))),by(u.equal(My(3)),(()=>rx(rx(Ww(x.x),Ww(x.y)),Ww(x.z)))),ux(x,x)})),NC=aM([bC,SC]),MC=wy((e=>{let[t,n,i]=e;const r=My(i).toVar(),s=Ny(n).toVar(),a=Ey(t).toVar(),o=My().toVar(),l=My().toVar(),c=Ey(NE(a.x,o),NE(a.y,l)).toVar(),u=Ny(1e6).toVar();return gS({start:-1,end:My(1),name:"x",condition:"<="},(e=>{let{x:t}=e;gS({start:-1,end:My(1),name:"y",condition:"<="},(e=>{let{y:n}=e;const i=Ny(NC(c,t,n,o,l,s,r)).toVar();u.assign(ix(u,i))}))})),by(r.equal(My(0)),(()=>{u.assign(Dw(u))})),u})),TC=wy((e=>{let[t,n,i]=e;const r=My(i).toVar(),s=Ny(n).toVar(),a=Ey(t).toVar(),o=My().toVar(),l=My().toVar(),c=Ey(NE(a.x,o),NE(a.y,l)).toVar(),u=Ey(1e6,1e6).toVar();return gS({start:-1,end:My(1),name:"x",condition:"<="},(e=>{let{x:t}=e;gS({start:-1,end:My(1),name:"y",condition:"<="},(e=>{let{y:n}=e;const i=Ny(NC(c,t,n,o,l,s,r)).toVar();by(i.lessThan(u.x),(()=>{u.y.assign(u.x),u.x.assign(i)})).elseif(i.lessThan(u.y),(()=>{u.y.assign(i)}))}))})),by(r.equal(My(0)),(()=>{u.assign(Dw(u))})),u})),AC=wy((e=>{let[t,n,i]=e;const r=My(i).toVar(),s=Ny(n).toVar(),a=Ey(t).toVar(),o=My().toVar(),l=My().toVar(),c=Ey(NE(a.x,o),NE(a.y,l)).toVar(),u=Py(1e6,1e6,1e6).toVar();return gS({start:-1,end:My(1),name:"x",condition:"<="},(e=>{let{x:t}=e;gS({start:-1,end:My(1),name:"y",condition:"<="},(e=>{let{y:n}=e;const i=Ny(NC(c,t,n,o,l,s,r)).toVar();by(i.lessThan(u.x),(()=>{u.z.assign(u.y),u.y.assign(u.x),u.x.assign(i)})).elseif(i.lessThan(u.y),(()=>{u.z.assign(u.y),u.y.assign(i)})).elseif(i.lessThan(u.z),(()=>{u.z.assign(i)}))}))})),by(r.equal(My(0)),(()=>{u.assign(Dw(u))})),u})),EC=wy((e=>{let[t,n,i]=e;const r=My(i).toVar(),s=Ny(n).toVar(),a=Py(t).toVar(),o=My().toVar(),l=My().toVar(),c=My().toVar(),u=Py(NE(a.x,o),NE(a.y,l),NE(a.z,c)).toVar(),h=Ny(1e6).toVar();return gS({start:-1,end:My(1),name:"x",condition:"<="},(e=>{let{x:t}=e;gS({start:-1,end:My(1),name:"y",condition:"<="},(e=>{let{y:n}=e;gS({start:-1,end:My(1),name:"z",condition:"<="},(e=>{let{z:i}=e;const a=Ny(NC(u,t,n,i,o,l,c,s,r)).toVar();h.assign(ix(h,a))}))}))})),by(r.equal(My(0)),(()=>{h.assign(Dw(h))})),h})),CC=(aM([MC,EC]),wy((e=>{let[t,n,i]=e;const r=My(i).toVar(),s=Ny(n).toVar(),a=Py(t).toVar(),o=My().toVar(),l=My().toVar(),c=My().toVar(),u=Py(NE(a.x,o),NE(a.y,l),NE(a.z,c)).toVar(),h=Ey(1e6,1e6).toVar();return gS({start:-1,end:My(1),name:"x",condition:"<="},(e=>{let{x:t}=e;gS({start:-1,end:My(1),name:"y",condition:"<="},(e=>{let{y:n}=e;gS({start:-1,end:My(1),name:"z",condition:"<="},(e=>{let{z:i}=e;const a=Ny(NC(u,t,n,i,o,l,c,s,r)).toVar();by(a.lessThan(h.x),(()=>{h.y.assign(h.x),h.x.assign(a)})).elseif(a.lessThan(h.y),(()=>{h.y.assign(a)}))}))}))})),by(r.equal(My(0)),(()=>{h.assign(Dw(h))})),h}))),IC=(aM([TC,CC]),wy((e=>{let[t,n,i]=e;const r=My(i).toVar(),s=Ny(n).toVar(),a=Py(t).toVar(),o=My().toVar(),l=My().toVar(),c=My().toVar(),u=Py(NE(a.x,o),NE(a.y,l),NE(a.z,c)).toVar(),h=Py(1e6,1e6,1e6).toVar();return gS({start:-1,end:My(1),name:"x",condition:"<="},(e=>{let{x:t}=e;gS({start:-1,end:My(1),name:"y",condition:"<="},(e=>{let{y:n}=e;gS({start:-1,end:My(1),name:"z",condition:"<="},(e=>{let{z:i}=e;const a=Ny(NC(u,t,n,i,o,l,c,s,r)).toVar();by(a.lessThan(h.x),(()=>{h.z.assign(h.y),h.y.assign(h.x),h.x.assign(a)})).elseif(a.lessThan(h.y),(()=>{h.z.assign(h.y),h.y.assign(a)})).elseif(a.lessThan(h.z),(()=>{h.z.assign(a)}))}))}))})),by(r.equal(My(0)),(()=>{h.assign(Dw(h))})),h})));aM([AC,IC]);xE.setLayout({name:"mx_select",type:"float",inputs:[{name:"b",type:"bool"},{name:"t",type:"float"},{name:"f",type:"float"}]}),bE.setLayout({name:"mx_negate_if",type:"float",inputs:[{name:"val",type:"float"},{name:"b",type:"bool"}]}),SE.setLayout({name:"mx_floor",type:"int",inputs:[{name:"x",type:"float"}]}),ME.setLayout({name:"mx_bilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"}]}),TE.setLayout({name:"mx_bilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"}]}),EE.setLayout({name:"mx_trilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"v4",type:"float"},{name:"v5",type:"float"},{name:"v6",type:"float"},{name:"v7",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]}),CE.setLayout({name:"mx_trilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"v4",type:"vec3"},{name:"v5",type:"vec3"},{name:"v6",type:"vec3"},{name:"v7",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]}),RE.setLayout({name:"mx_gradient_float_0",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"}]}),PE.setLayout({name:"mx_gradient_float_1",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),kE.setLayout({name:"mx_gradient_vec3_0",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"}]}),LE.setLayout({name:"mx_gradient_vec3_1",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),BE.setLayout({name:"mx_gradient_scale2d_0",type:"float",inputs:[{name:"v",type:"float"}]}),UE.setLayout({name:"mx_gradient_scale3d_0",type:"float",inputs:[{name:"v",type:"float"}]}),zE.setLayout({name:"mx_gradient_scale2d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]}),FE.setLayout({name:"mx_gradient_scale3d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]}),HE.setLayout({name:"mx_rotl32",type:"uint",inputs:[{name:"x",type:"uint"},{name:"k",type:"int"}]}),WE.setLayout({name:"mx_bjfinal",type:"uint",inputs:[{name:"a",type:"uint"},{name:"b",type:"uint"},{name:"c",type:"uint"}]}),YE.setLayout({name:"mx_bits_to_01",type:"float",inputs:[{name:"bits",type:"uint"}]}),qE.setLayout({name:"mx_fade",type:"float",inputs:[{name:"t",type:"float"}]}),XE.setLayout({name:"mx_hash_int_0",type:"uint",inputs:[{name:"x",type:"int"}]}),KE.setLayout({name:"mx_hash_int_1",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),JE.setLayout({name:"mx_hash_int_2",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]}),$E.setLayout({name:"mx_hash_int_3",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"}]}),QE.setLayout({name:"mx_hash_int_4",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"},{name:"yy",type:"int"}]}),eC.setLayout({name:"mx_hash_vec3_0",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),tC.setLayout({name:"mx_hash_vec3_1",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]}),iC.setLayout({name:"mx_perlin_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"}]}),rC.setLayout({name:"mx_perlin_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"}]}),aC.setLayout({name:"mx_perlin_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),oC.setLayout({name:"mx_perlin_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),cC.setLayout({name:"mx_cell_noise_float_0",type:"float",inputs:[{name:"p",type:"float"}]}),uC.setLayout({name:"mx_cell_noise_float_1",type:"float",inputs:[{name:"p",type:"vec2"}]}),hC.setLayout({name:"mx_cell_noise_float_2",type:"float",inputs:[{name:"p",type:"vec3"}]}),dC.setLayout({name:"mx_cell_noise_float_3",type:"float",inputs:[{name:"p",type:"vec4"}]}),pC.setLayout({name:"mx_cell_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"float"}]}),fC.setLayout({name:"mx_cell_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),mC.setLayout({name:"mx_cell_noise_vec3_2",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),gC.setLayout({name:"mx_cell_noise_vec3_3",type:"vec3",inputs:[{name:"p",type:"vec4"}]}),yC.setLayout({name:"mx_fractal_noise_float",type:"float",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),_C.setLayout({name:"mx_fractal_noise_vec3",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),wC.setLayout({name:"mx_fractal_noise_vec2",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),xC.setLayout({name:"mx_fractal_noise_vec4",type:"vec4",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),bC.setLayout({name:"mx_worley_distance_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),SC.setLayout({name:"mx_worley_distance_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"zoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),MC.setLayout({name:"mx_worley_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),TC.setLayout({name:"mx_worley_noise_vec2_0",type:"vec2",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),AC.setLayout({name:"mx_worley_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),EC.setLayout({name:"mx_worley_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),CC.setLayout({name:"mx_worley_noise_vec2_1",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),IC.setLayout({name:"mx_worley_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]});const RC=wy((e=>{let[t]=e;const n=Py(t).toVar(),i=Ny(n.x).toVar(),r=Ny(n.y).toVar(),s=Ny(n.z).toVar();by(r.lessThan(1e-4),(()=>Py(s,s,s))).else((()=>{i.assign(nw(6,i.sub(Lw(i))));const e=My(ex(i)).toVar(),t=Ny(i.sub(Ny(e))).toVar(),n=Ny(s.mul(tw(1,r))).toVar(),a=Ny(s.mul(tw(1,r.mul(t)))).toVar(),o=Ny(s.mul(tw(1,r.mul(tw(1,t))))).toVar();return by(e.equal(My(0)),(()=>Py(s,o,n))).elseif(e.equal(My(1)),(()=>Py(a,s,n))).elseif(e.equal(My(2)),(()=>Py(n,s,o))).elseif(e.equal(My(3)),(()=>Py(n,a,s))).elseif(e.equal(My(4)),(()=>Py(o,n,s))),Py(s,n,a)}))})),PC=wy((e=>{let[t]=e;const n=Py(t).toVar(),i=Ny(n.x).toVar(),r=Ny(n.y).toVar(),s=Ny(n.z).toVar(),a=Ny(ix(i,ix(r,s))).toVar(),o=Ny(rx(i,rx(r,s))).toVar(),l=Ny(o.sub(a)).toVar(),c=Ny().toVar(),u=Ny().toVar(),h=Ny().toVar();return h.assign(o),by(o.greaterThan(0),(()=>{u.assign(l.div(o))})).else((()=>{u.assign(0)})),by(u.lessThanEqual(0),(()=>{c.assign(0)})).else((()=>{by(i.greaterThanEqual(o),(()=>{c.assign(r.sub(s).div(l))})).elseif(r.greaterThanEqual(o),(()=>{c.assign(ew(2,s.sub(i).div(l)))})).else((()=>{c.assign(ew(4,i.sub(r).div(l)))})),c.mulAssign(1/6),by(c.lessThan(0),(()=>{c.addAssign(1)}))})),Py(c,u,h)}));RC.setLayout({name:"mx_hsvtorgb",type:"vec3",inputs:[{name:"hsv",type:"vec3"}]}),PC.setLayout({name:"mx_rgbtohsv",type:"vec3",inputs:[{name:"c",type:"vec3"}]});const DC=wy((e=>{let[t]=e;const n=Py(t).toVar(),i=Ly(lw(n,Py(.04045))).toVar(),r=Py(n.div(12.92)).toVar(),s=Py(dx(rx(n.add(Py(.055)),Py(0)).div(1.055),Py(2.4))).toVar();return vx(r,s,i)}));DC.setLayout({name:"mx_srgb_texture_to_lin_rec709",type:"vec3",inputs:[{name:"color",type:"vec3"}]});const kC=e=>{const[n,i]=(0,t.useState)(!1);(0,t.useEffect)((()=>{"1"===e.permiso?i(!0):i(!1)}),[e.permiso]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"nameA",children:e.titulo}),(0,r.jsxs)("label",{className:"switch",children:[(0,r.jsx)("input",{type:"checkbox",checked:n,onChange:()=>{i(!n),(()=>{const t=n?"0":"1";e.actualizarPermiso(e.indice,t)})()}}),(0,r.jsx)("span",{className:"slider"})]})]})},LC=e=>{const[n,i]=(0,t.useState)(!1),[s,a]=(0,t.useState)([]),[o,l]=(0,t.useState)([]),[c,u]=(0,t.useState)(""),[h,d]=(0,t.useState)(""),[p,f]=(0,t.useState)(""),[m,g]=(0,t.useState)(""),[v,y]=(0,t.useState)(""),[_,w]=(0,t.useState)(0),[x,b]=(0,t.useState)(0),[S,N]=(0,t.useState)(0),[M,T]=(0,t.useState)(0),[A,E]=(0,t.useState)(0),[C,I]=(0,t.useState)(0),[R,P]=(0,t.useState)(0),[D,k]=(0,t.useState)(0);(0,t.useEffect)((()=>{i(e.visible),a(e.user),console.log(s),s&&(l(e.permisos),u(s.userName),f(s.firstName),g(s.referredBy),y(s.validity),w(s.rank),b(s.walletDiv),N(s.walletCom),T(s.bonoRefDirect),E(s.bonoFastTrack),I(s.bonoIngresoRes),P(s.bonoRangoRes),d(s.lastName),k(s.bonoIgualacion))}),[e.visible]);const L=(e,t)=>{const n=[...o];n[e]=t,l(n),console.log(o[0])};return(0,r.jsxs)("section",{className:n?"editUser":"none",children:[(0,r.jsx)("div",{className:"overlay"}),(0,r.jsxs)("div",{className:"content",children:[(0,r.jsxs)("div",{className:"s1",children:[(0,r.jsx)("p",{className:"nameA",children:"Editar usuario"}),(0,r.jsx)("button",{className:"buttonC",onClick:()=>{i(!1),e.setVisible(!1)},children:"Cerrar"})]}),(0,r.jsx)("div",{className:"item s2",children:(0,r.jsx)(Qh,{value:c,setValue:u,titulo:"Nombre de usuario"})}),(0,r.jsx)("div",{className:"item s3",children:(0,r.jsx)(Qh,{value:p,setValue:f,titulo:"Nombre"})}),(0,r.jsx)("div",{className:"item s4",children:(0,r.jsx)(Qh,{value:h,setValue:d,titulo:"Apellidos"})}),(0,r.jsx)("div",{className:"item s5",children:(0,r.jsx)(Qh,{value:m,setValue:g,titulo:"Patrocinador"})}),(0,r.jsx)("div",{className:"item s6",children:(0,r.jsx)(Qh,{value:_,setValue:w,titulo:"Rango"})}),(0,r.jsx)("div",{className:"item s7",children:(0,r.jsx)(Qh,{value:x,setValue:b,titulo:"Wallet de dividendos"})}),(0,r.jsx)("div",{className:"item s8",children:(0,r.jsx)(Qh,{value:S,setValue:N,titulo:"Wallet de comiciones"})}),(0,r.jsx)("div",{className:"item s9",children:(0,r.jsx)(Qh,{value:v,setValue:y,titulo:"Vigencia de pago"})}),(0,r.jsx)("div",{className:"item s10",children:(0,r.jsx)(Qh,{value:M,setValue:T,titulo:"Bono de referencia directa"})}),(0,r.jsx)("div",{className:"item s11",children:(0,r.jsx)(Qh,{value:A,setValue:E,titulo:"Bono FastTrack"})}),(0,r.jsx)("div",{className:"item s12",children:(0,r.jsx)(Qh,{value:D,setValue:k,titulo:"Bono de igualaci\xf3n"})}),(0,r.jsx)("div",{className:"item s13",children:(0,r.jsx)(Qh,{value:R,setValue:I,titulo:"Bono de rango residual"})}),(0,r.jsx)("div",{className:"item s14",children:(0,r.jsx)(Qh,{value:C,setValue:I,titulo:"Bono de ingreso residual"})}),(0,r.jsx)("div",{className:"item s15",children:(0,r.jsx)(kC,{visible:n,permiso:o[0],indice:0,actualizarPermiso:L,titulo:"Recibir dividendos"})}),(0,r.jsx)("div",{className:"item s16",children:(0,r.jsx)(kC,{visible:n,permiso:o[1],indice:1,actualizarPermiso:L,titulo:"Recibir bono referencia directa"})}),(0,r.jsx)("div",{className:"item s17",children:(0,r.jsx)(kC,{visible:n,permiso:o[2],indice:2,actualizarPermiso:L,titulo:"Recibir bono Fast track"})}),(0,r.jsx)("div",{className:"item s18",children:(0,r.jsx)(kC,{visible:n,permiso:o[3],indice:3,actualizarPermiso:L,titulo:"Recibir bono de igualaci\xf3n"})}),(0,r.jsx)("div",{className:"item s19",children:(0,r.jsx)(kC,{visible:n,permiso:o[4],indice:4,actualizarPermiso:L,titulo:"Recibir bono residual"})}),(0,r.jsx)("div",{className:"item s20",children:(0,r.jsx)(kC,{visible:n,permiso:o[5],indice:5,actualizarPermiso:L,titulo:"Recibir bono rango residual"})}),(0,r.jsx)("div",{className:"item s21",children:(0,r.jsx)(kC,{visible:n,permiso:o[6],indice:6,actualizarPermiso:L,titulo:"primera transacci\xf3n"})}),(0,r.jsx)("div",{className:"item s22",children:(0,r.jsx)(kC,{visible:n,permiso:o[7],indice:7,actualizarPermiso:L,titulo:"Cobrar mensualidad"})}),(0,r.jsx)("div",{className:"item s23",children:(0,r.jsx)(kC,{visible:n,permiso:o[8],indice:8,actualizarPermiso:L,titulo:"Bono de 10% mensual"})}),(0,r.jsx)("div",{className:"s24",children:(0,r.jsx)("button",{className:"buttonC",onClick:async()=>{const e=ju(qr),t=Su(e,"users/"),n=await Au(t);if(n.exists()){const t=n.val(),i=Object.values(t).find((e=>e.firebaseKey===s.firebaseKey));if(i){i.userPermisos=o.join(""),i.userName=c,i.firstName=p,i.lastName=h,i.rank=_,i.referredBy=m,i.validity=v,i.walletDiv=x,i.walletCom=S,i.bonoRefDirect=M,i.bonoFastTrack=A,i.bonoIngresoRes=C,i.bonoRangoRes=R,i.bonoIgualacion=D;try{await Tu(Su(e,"users/".concat(i.firebaseKey)),i)}catch(gs){}}}},children:"save"})})]})]})},OC=e=>{const[n,i]=(0,t.useState)([]),[s,a]=(0,t.useState)(""),[o,l]=(0,t.useState)(!1),[c,u]=(0,t.useState)([]),[h,d]=(0,t.useState)([]),p=async()=>{const e=Su(ju(qr),"users"),t=await Au(e);if(t.exists()){const e=Object.values(t.val());if(e){const t=Object.values(e);i(t)}else i([])}else alert("error")};return(0,t.useEffect)((()=>{p()}),[]),(0,r.jsxs)("section",{className:"tabla U",children:[(0,r.jsx)(LC,{user:c,visible:o,setVisible:l,permisos:h}),(0,r.jsxs)("div",{className:"encabezado",children:[(0,r.jsx)("h2",{children:"Usuarios"}),(0,r.jsxs)("div",{className:"buscador",children:[(0,r.jsx)("input",{type:"text",placeholder:"Buscar por E-mail...",onChange:e=>a(e.target.value)}),(0,r.jsx)("button",{onClick:()=>(async e=>{const t=Su(ju(qr),"users"),n=await Au(t);if(n.exists()){const t=Object.values(n.val()).filter((t=>!(!t.email||!t.membership)&&t.email.includes(e)&&0!==t.request));(void 0).setUserModels(t)}else alert("error")})(s),children:(0,r.jsx)("i",{class:"bi bi-search"})})]}),(0,r.jsx)("button",{onClick:()=>p(),className:"refresh",children:(0,r.jsx)("i",{class:"bi bi-arrow-counterclockwise"})})]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("span",{className:"column-header",children:"Nombre de usuario"}),(0,r.jsx)("span",{className:"column-header",children:"E-mail"}),(0,r.jsx)("span",{className:"column-header",children:"Editar"})]}),(0,r.jsx)("div",{className:"datos",children:(0,r.jsx)("ul",{children:n.map(((e,t)=>(0,r.jsxs)("li",{children:[(0,r.jsx)("span",{children:e.userName}),(0,r.jsx)("span",{children:e.email}),(0,r.jsx)("div",{className:"editar",children:(0,r.jsx)("button",{class:"edit-button",onClick:()=>(e=>{l(!0),u(e);const t=e.userPermisos.split("");d(t)})(e),children:(0,r.jsx)("svg",{class:"edit-svgIcon",viewBox:"0 0 512 512",children:(0,r.jsx)("path",{d:"M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"})})})})]},t)))})})]})},BC=()=>{const[e,n]=(0,t.useState)([]),[i,s]=(0,t.useState)(""),o=new $h(n),l=(0,a.useHistory)();(0,t.useEffect)((()=>{new $h(n).fetchData()}),[]);const c=e=>{1==e?l.push("/admin"):2==e?l.push("/admin/gestionar-ususarios"):3==e&&l.push("/admin")};return(0,r.jsxs)("div",{className:"mainAdmin",children:[(0,r.jsxs)("header",{children:[(0,r.jsx)("div",{className:"logo",children:(0,r.jsx)("img",{alt:"logo"})}),(0,r.jsx)("div",{className:"cs",children:(0,r.jsx)(Kr,{})})]}),(0,r.jsxs)("div",{className:"ops",children:[(0,r.jsxs)("button",{onClick:()=>c(1),children:["Gestionar",(0,r.jsx)("br",{}),"admnistradores"]}),(0,r.jsxs)("button",{onClick:()=>c(2),children:["Gestionar",(0,r.jsx)("br",{}),"usuarios"]}),(0,r.jsxs)("button",{onClick:()=>c(3),children:["Aprobar",(0,r.jsx)("br",{}),"pagos"]})]}),(0,r.jsx)("div",{className:"linkC",children:(0,r.jsx)(eh,{username:"Administrador"})}),(0,r.jsx)("div",{className:"contenido",children:(0,r.jsxs)(a.Switch,{children:[(0,r.jsx)(a.Route,{path:"/admin/gestionar-ususarios",component:function(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(OC,{})})}}),(0,r.jsx)(a.Route,{path:"/admin",component:function(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"tabla",children:[(0,r.jsxs)("div",{className:"encabezado",children:[(0,r.jsx)("h2",{children:"Pagos pendiente"}),(0,r.jsxs)("div",{className:"buscador",children:[(0,r.jsx)("input",{type:"text",placeholder:"Buscar por E-mail...",onChange:e=>s(e.target.value)}),(0,r.jsx)("button",{onClick:()=>o.findData(i),children:(0,r.jsx)("i",{class:"bi bi-search"})})]}),(0,r.jsx)("button",{onClick:()=>o.fetchData(),className:"refresh",children:(0,r.jsx)("i",{class:"bi bi-arrow-counterclockwise"})})]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("span",{className:"column-header",children:"Nombre de usuario"}),(0,r.jsx)("span",{className:"column-header",children:"E-mail"}),(0,r.jsx)("span",{className:"column-header",children:"Cantidad"}),(0,r.jsx)("span",{className:"column-header",children:"Vigencia"}),(0,r.jsx)("span",{className:"column-header",children:"Aprobar"})]}),(0,r.jsx)("div",{className:"datos",children:(0,r.jsx)("ul",{children:e.map(((e,t)=>(0,r.jsxs)("li",{children:[(0,r.jsx)("span",{children:e.userName}),(0,r.jsx)("span",{children:e.email}),(0,r.jsx)("span",{children:e.request}),(0,r.jsx)("span",{children:e.validity}),(0,r.jsxs)("div",{className:"aprobar",children:[(0,r.jsx)("button",{onClick:()=>o.aprobar(e.firebaseKey),className:"check",children:(0,r.jsx)("i",{class:"bi bi-check-circle-fill"})}),(0,r.jsx)("button",{onClick:()=>o.denegar(e.firebaseKey),className:"trash",children:(0,r.jsx)("i",{class:"bi bi-x-circle-fill"})})]})]},t)))})})]})})}})]})})]})},UC=Gr(qr),zC=()=>{const[e,n]=(0,t.useState)(""),[i,s]=(0,t.useState)(null),[o,l]=(0,t.useState)(!1),c=(0,a.useHistory)();return(0,r.jsx)("section",{className:"Fp",children:(0,r.jsxs)("form",{class:"form",children:[(0,r.jsx)("img",{src:Yh,alt:"logo"}),(0,r.jsx)("p",{class:"login",children:"Reset your password"}),(0,r.jsx)("p",{children:"You will be sent an email to change your password."}),(0,r.jsxs)("div",{class:"inputContainer",children:[(0,r.jsx)("input",{type:"button",value:"next",class:"submit",onClick:async()=>{try{await async function(e,t,n){const i=Fn(e),r={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};n&&Ni(i,r,n),await Xn(i,r,"getOobCode",ni)}(UC,e),l(!0),s(null),c.push("/")}catch(i){s(i.message),l(!1)}}}),(0,r.jsx)("input",{placeholder:"enter your email",type:"text",class:"fInput email",onChange:e=>n(e.target.value)})]})]})})};const VC=function(){return(0,r.jsx)(wh,{children:(0,r.jsx)("div",{className:"App",children:(0,r.jsxs)(a.Switch,{children:[(0,r.jsx)(a.Route,{path:"/Admin",component:BC}),(0,r.jsx)(a.Route,{path:"/Register/:r?",component:Kh}),(0,r.jsx)(a.Route,{path:"/Dashboard",component:function(){return(0,r.jsx)(fh,{})}}),(0,r.jsx)(a.Route,{path:"/recovery_password",component:zC}),(0,r.jsx)(a.Route,{path:"/",component:Ph})]})})})};e.createRoot(document.getElementById("root")).render((0,r.jsx)(VC,{}))})()})();
//# sourceMappingURL=main.6b1a81fc.js.map